---
title: "Codenames"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Reading the Data

```{r}
c = read.csv("e1e2_COMBINED.csv", header = TRUE, sep = ",")

```

# Total Scores

```{r}
library(tidyverse)
c$score = ifelse(c$Attempts == 1, 3, 
                 ifelse(c$Attempts == 2, 2, 
                        ifelse(c$Attempts == 3,1,0)))

c_score = group_by(c, Experiment, Subject) %>%
  summarize_at(vars(score), sum)

## how many words guessed at first attempt

firstattempt = group_by(c, Experiment, Subject) %>%
  summarise_at(vars(Player2.ACC), mean)
firstattempt_e1 = firstattempt %>% filter(Experiment == "E1")
firstattempt_e2 = firstattempt %>% filter(Experiment == "E2")
mean(firstattempt$Player2.ACC)
sd(firstattempt$Player2.ACC)

secondattempt = group_by(c, Subject) %>% filter(Player2.ACC == 0) %>%
    summarise_at(vars(Player2SecondAnswer.ACC), mean)
mean(secondattempt$Player2SecondAnswer.ACC)
sd(secondattempt$Player2SecondAnswer.ACC)

thirdattempt = group_by(c, Subject) %>% 
  filter(Player2.ACC == 0 & Player2SecondAnswer.ACC == 0) %>%
    summarise_at(vars(Player2ThirdAnswer.ACC), mean)
mean(thirdattempt$Player2ThirdAnswer.ACC)
sd(thirdattempt$Player2ThirdAnswer.ACC)

## how many % words were corectly guessed in first/second/third attempt

c$wordpair = paste(c$Word1, "-", c$Word2)
words_firstattempt = group_by(c, Experiment, wordpair) %>%
    summarise_at(vars(Player2.ACC), sum)

words_secondattempt = group_by(c, wordpair) %>% filter(Player2.ACC == 0) %>%
    summarise_at(vars(Player2SecondAnswer.ACC), sum)

words_thirdattempt = group_by(c, wordpair) %>% 
  filter(Player2.ACC == 0 & Player2SecondAnswer.ACC == 0) %>%
    summarise_at(vars(Player2ThirdAnswer.ACC), sum)

words_total_attempts = left_join(words_firstattempt, words_secondattempt,
                                  by = "wordpair")

words_total_attempts = left_join(words_total_attempts, words_thirdattempt)

words_total_attempts$percentafter1 = ifelse(words_total_attempts$Experiment == "E1",
  words_total_attempts$Player2.ACC/31, words_total_attempts$Player2.ACC/44)

words_total_attempts$percentafter2 = ifelse(words_total_attempts$Experiment == "E1",
                                          (words_total_attempts$Player2.ACC + 
                                       words_total_attempts$Player2SecondAnswer.ACC) /31,
                                       (words_total_attempts$Player2.ACC + 
                                       words_total_attempts$Player2SecondAnswer.ACC) /44)



words_total_attempts$percentafter3 = ifelse(words_total_attempts$Experiment == "E1",
                                            (words_total_attempts$Player2.ACC + 
                                       words_total_attempts$Player2SecondAnswer.ACC +
                                      words_total_attempts$Player2ThirdAnswer.ACC  ) /31,
                                       (words_total_attempts$Player2.ACC + 
                                       words_total_attempts$Player2SecondAnswer.ACC +
                                      words_total_attempts$Player2ThirdAnswer.ACC  ) /44)

words_total_attempts_over50 = words_total_attempts %>% 
  filter(percentafter2 > 0.50)

## also total success?

subject_acc = group_by(c, Experiment, Subject) %>%
  summarise_at(vars(Player2.ACC, Player2SecondAnswer.ACC, Player2ThirdAnswer.ACC), sum)
subject_acc$total = subject_acc$Player2.ACC + subject_acc$Player2SecondAnswer.ACC +
  subject_acc$Player2ThirdAnswer.ACC
subject_acc$acc = subject_acc$total/30
subject_acc_e1 = subject_acc %>% filter(Experiment == "E1")
subject_acc_e2 = subject_acc %>% filter(Experiment == "E2")
mean(subject_acc$acc)
sd(subject_acc$acc)
```


# Difficulty and Time

## Attempts

### Level attempts

```{r}
c$Levelfac = ordered(as.factor(as.character(c$Level)), 
                            levels = c("Easy", "Medium", "Hard"))

board_attempts = Rmisc::summarySE(c,
                            measurevar = "Attempts",
                            groupvars = "Running.Trial.")

level_attempts = Rmisc::summarySE(c,
                            measurevar = "Attempts",
                            groupvars = c("Levelfac"))

level_attempts$Distance = ifelse(level_attempts$Levelfac == "Easy", "Close",
                                 ifelse(level_attempts$Levelfac == "Hard", "Distant", 
                                        "Medium"))

level_attempts$Distance = ordered(as.factor(as.character(level_attempts$Distance)), 
                            levels = c("Close", "Medium", "Distant"))

library(ggplot2)
library(ggthemes)

level_attempts %>% 
  ggplot(aes(x = Distance, y = Attempts)) + 
   geom_bar(stat = "identity", position = "dodge", width = 0.7, 
            fill = "darkslategray", color= "black")+
 geom_errorbar(aes(ymin=Attempts - se, ymax=Attempts + se), 
             width=.2, color = "gray26", 
             position = position_dodge(0.7))+
 theme_few()+
 scale_fill_solarized()+
  #facet_wrap(~Experiment)+
       xlab("Word Pair Distance") + ylab("Mean Number of Attempts To Guess") + 
  ggtitle("Experiment 1: Number of Attempts by Distance between Words")  +
   theme(axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))

level_attempts_sub = group_by(c, Subject, Levelfac ) %>% 
  summarise_at(vars(Attempts), mean)

level_attempts_aov = aov(data = level_attempts_sub, 
                         Attempts ~ Levelfac +
                           Error(Subject/Levelfac))
summary(level_attempts_aov)

options(contrasts = c('contr.sum', 'contr.poly'))
library(lsmeans)
library(multcomp)
level_lsm = lsmeans::lsmeans(level_attempts_aov, c( "Levelfac"))
prime_effect = cld(level_lsm, alpha = 0.05, 
                adjust = "tukey", details = TRUE, by = "Levelfac")
library(knitr)
kable(subset(prime_effect$comparisons,prime_effect$comparisons$p.value < 0.1 ))

 level_attempts_sub_wide = spread(level_attempts_sub, Levelfac, Attempts)
 
 t.test(level_attempts_sub_wide$Easy, level_attempts_sub_wide$Medium, paired = TRUE)
 t.test(level_attempts_sub_wide$Hard, level_attempts_sub_wide$Medium, paired = TRUE)
 t.test(level_attempts_sub_wide$Easy, level_attempts_sub_wide$Hard, paired = TRUE)
```

## Player 1 Level RT

```{r}
library(ggplot2)
library(ggthemes)

## first attempt
p1_level_rt = Rmisc::summarySE(c,
                            measurevar = "Player1.RT",
                            groupvars = c( "Levelfac"))

p1_level_rt %>% 
  ggplot(aes(x = Levelfac, y = Player1.RT)) + 
   geom_bar(stat = "identity", position = "dodge", width = 0.7, color= "black")+
 geom_errorbar(aes(ymin=Player1.RT - se, ymax=Player1.RT + se), 
             width=.2, color = "gray26", 
             position = position_dodge(0.7))+
 theme_few()+
 scale_fill_solarized()+
  #facet_wrap(~Experiment)+
       xlab("Word Pair Difficulty") + ylab("RT to Generate Clue") + 
  ggtitle("Player 1 RT to Generate First Clue")  +
   theme(axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))

p1_level_rt_sub = group_by(c, Subject, Levelfac ) %>% 
  summarise_at(vars(Player1.RT), mean)

# p1_level_rt_aov = aov(data = p1_level_rt_sub, 
#                     Player1.RT ~ Experiment*Levelfac +
#                       Error(Subject/Levelfac))
# summary(p1_level_rt_aov)
# 
# options(contrasts = c('contr.sum', 'contr.poly'))
# library(lsmeans)
# library(multcomp)
# level_lsm = lsmeans::lsmeans(p1_level_rt_aov, c("Experiment", "Levelfac"))
# prime_effect = cld(level_lsm, alpha = 0.05, 
#                 adjust = "tukey", details = TRUE, by = "Levelfac")
# library(knitr)
# kable(subset(prime_effect$comparisons,prime_effect$comparisons$p.value < 0.1 ))

p1_level_rt_sub_wide = spread(p1_level_rt_sub, Levelfac, Player1.RT)
mean(p1_level_rt_sub_wide$Easy)
sd(p1_level_rt_sub_wide$Easy)

mean(p1_level_rt_sub_wide$Medium)
sd(p1_level_rt_sub_wide$Medium)

mean(p1_level_rt_sub_wide$Hard)
sd(p1_level_rt_sub_wide$Hard)

t.test(p1_level_rt_sub_wide$Easy, p1_level_rt_sub_wide$Medium, paired = TRUE)
t.test(p1_level_rt_sub_wide$Hard, p1_level_rt_sub_wide$Medium, paired = TRUE)
t.test(p1_level_rt_sub_wide$Easy, p1_level_rt_sub_wide$Hard, paired = TRUE)

p1_level_rt_sub_board = group_by(c, Subject, Running.Trial.) %>%
  summarise_at(vars(Player1.RT), mean)

p1_level_rt_sub_board$Subject = as.factor(p1_level_rt_sub_board$Subject)

a1_p1_aov = aov(data = p1_level_rt_sub_board,Player1.RT ~ Running.Trial. +
                  Error(Subject/(Running.Trial. )))

summary(a1_p1_aov)

## second attempt

p1_level_rt_sub_a2 = group_by(c, Subject, Levelfac) %>% 
  filter(Player2.ACC == 0) %>%
  summarise_at(vars(Player1SecondClue.RT), mean)

# p1_level_rt_sub_a3_count = group_by(p1_level_rt_sub_a2, Subject) %>% 
#   summarise(n = n())
# 
# missing_sub = p1_level_rt_sub_a3_count[which(p1_level_rt_sub_a3_count$n != 3),1]
# 
# p1_level_rt_sub_a2 = p1_level_rt_sub_a2 %>%
#   filter(!Subject %in% missing_sub$Subject)

# p1_level_rt_aov_a2 = aov(data = p1_level_rt_sub_a2, 
#                     Player1SecondClue.RT ~ Experiment*Levelfac +
#                       Error(Subject/Levelfac))
# summary(p1_level_rt_aov_a2)
# 
# options(contrasts = c('contr.sum', 'contr.poly'))
# library(lsmeans)
# library(multcomp)
# level_lsm = lsmeans::lsmeans(p1_level_rt_aov_a2, c("Experiment", "Levelfac"))
# prime_effect = cld(level_lsm, alpha = 0.05, 
#                 adjust = "tukey", details = TRUE, by = "Levelfac")
# library(knitr)
# kable(subset(prime_effect$comparisons,prime_effect$comparisons$p.value < 0.1 ))

p1_level_rt_sub_wide_a2 = spread(p1_level_rt_sub_a2, Levelfac, Player1SecondClue.RT)

t.test(p1_level_rt_sub_wide_a2$Easy, p1_level_rt_sub_wide_a2$Medium, paired = TRUE)
t.test(p1_level_rt_sub_wide_a2$Hard, p1_level_rt_sub_wide_a2$Medium, paired = TRUE)
t.test(p1_level_rt_sub_wide_a2$Easy, p1_level_rt_sub_wide_a2$Hard, paired = TRUE)

mean(p1_level_rt_sub_wide_a2$Easy, na.rm = TRUE)
sd(p1_level_rt_sub_wide_a2$Easy, na.rm = TRUE)

mean(p1_level_rt_sub_wide_a2$Medium, na.rm = TRUE)
sd(p1_level_rt_sub_wide_a2$Medium, na.rm = TRUE)

mean(p1_level_rt_sub_wide_a2$Hard, na.rm = TRUE)
sd(p1_level_rt_sub_wide_a2$Hard, na.rm = TRUE)

## third attempt

p1_level_rt_sub_a3 = group_by(c, Subject, Levelfac) %>% 
  filter(Player2.ACC == 0 & Player2SecondAnswer.ACC == 0) %>%
  summarise_at(vars(Player1ThirdClue.RT), mean)

p1_level_rt_sub_wide_a3 = spread(p1_level_rt_sub_a3, Levelfac, Player1ThirdClue.RT)

t.test(p1_level_rt_sub_wide_a3$Easy, p1_level_rt_sub_wide_a3$Medium, paired = TRUE)
t.test(p1_level_rt_sub_wide_a3$Hard, p1_level_rt_sub_wide_a3$Medium, paired = TRUE)
t.test(p1_level_rt_sub_wide_a3$Easy, p1_level_rt_sub_wide_a3$Hard, paired = TRUE)

mean(p1_level_rt_sub_wide_a3$Easy, na.rm = TRUE)
sd(p1_level_rt_sub_wide_a3$Easy, na.rm = TRUE)

mean(p1_level_rt_sub_wide_a3$Medium, na.rm = TRUE)
sd(p1_level_rt_sub_wide_a3$Medium, na.rm = TRUE)

mean(p1_level_rt_sub_wide_a3$Hard, na.rm = TRUE)
sd(p1_level_rt_sub_wide_a3$Hard, na.rm = TRUE)

```

## Player 2 Level RT
```{r}
p2_level_rt = Rmisc::summarySE(c,
                            measurevar = "Player2.RT",
                            groupvars = c( "Levelfac"))

p2_level_rt %>% 
  ggplot(aes(x = Levelfac, y = Player2.RT)) + 
   geom_bar(stat = "identity", position = "dodge", width = 0.7, color= "black")+
 geom_errorbar(aes(ymin=Player2.RT - se, ymax=Player2.RT + se), 
             width=.2, color = "gray26", 
             position = position_dodge(0.7))+
 theme_few()+
 scale_fill_solarized()+
 # facet_wrap(~Experiment)+
    xlab("Word Pair Difficulty") + ylab("RT to Guess Words") + 
  ggtitle("Player 2 RT to Guess First Word Pair")  +
   theme(axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))

p2_level_rt_sub = group_by(c, Subject, Levelfac ) %>% 
  summarise_at(vars(Player2.RT), mean)

# p2_level_rt_aov = aov(data = p2_level_rt_sub,
#                      Player2.RT ~ Experiment*Levelfac +
#                        Error(Subject/Levelfac))
# 
# summary(p2_level_rt_aov)

p2_level_rt_sub_wide = spread(p2_level_rt_sub, Levelfac, Player2.RT)

mean(p2_level_rt_sub_wide$Easy)
sd(p2_level_rt_sub_wide$Easy)

mean(p2_level_rt_sub_wide$Medium)
sd(p2_level_rt_sub_wide$Medium)

mean(p2_level_rt_sub_wide$Hard)
sd(p2_level_rt_sub_wide$Hard)

t.test(p2_level_rt_sub_wide$Easy, p2_level_rt_sub_wide$Medium, paired = TRUE)
t.test(p2_level_rt_sub_wide$Hard, p2_level_rt_sub_wide$Medium, paired = TRUE)
t.test(p2_level_rt_sub_wide$Easy, p2_level_rt_sub_wide$Hard, paired = TRUE)

## second attempt
p2_level_rt_sub_a2 = group_by(c, Subject, Levelfac ) %>% 
    filter(Player2.ACC == 0) %>%
  summarise_at(vars(Player2SecondAnswer.RT), mean)

p2_level_rt_sub_wide_a2 = spread(p2_level_rt_sub_a2, Levelfac, Player2SecondAnswer.RT)

t.test(p2_level_rt_sub_wide_a2$Easy, p2_level_rt_sub_wide_a2$Medium, paired = TRUE)
t.test(p2_level_rt_sub_wide_a2$Hard, p2_level_rt_sub_wide_a2$Medium, paired = TRUE)
t.test(p2_level_rt_sub_wide_a2$Easy, p2_level_rt_sub_wide_a2$Hard, paired = TRUE)

mean(p2_level_rt_sub_wide_a2$Easy, na.rm = TRUE)
sd(p2_level_rt_sub_wide_a2$Easy, na.rm = TRUE)

mean(p2_level_rt_sub_wide_a2$Medium, na.rm = TRUE)
sd(p2_level_rt_sub_wide_a2$Medium, na.rm = TRUE)

mean(p2_level_rt_sub_wide_a2$Hard, na.rm = TRUE)
sd(p2_level_rt_sub_wide_a2$Hard, na.rm = TRUE)


## third attempt
p2_level_rt_sub_a3 = group_by(c, Subject, Levelfac ) %>% 
  filter(Player2.ACC == 0 & Player2SecondAnswer.ACC == 0) %>%
  summarise_at(vars(Player2SecondAnswer.RT), mean)

p2_level_rt_sub_wide_a3 = spread(p2_level_rt_sub_a3, Levelfac, Player2SecondAnswer.RT)

t.test(p2_level_rt_sub_wide_a3$Easy, p2_level_rt_sub_wide_a3$Medium, paired = TRUE)
t.test(p2_level_rt_sub_wide_a3$Hard, p2_level_rt_sub_wide_a3$Medium, paired = TRUE)
t.test(p2_level_rt_sub_wide_a3$Easy, p2_level_rt_sub_wide_a3$Hard, paired = TRUE)

mean(p2_level_rt_sub_wide_a3$Easy, na.rm = TRUE)
sd(p2_level_rt_sub_wide_a3$Easy, na.rm = TRUE)

mean(p2_level_rt_sub_wide_a3$Medium, na.rm = TRUE)
sd(p2_level_rt_sub_wide_a3$Medium, na.rm = TRUE)

mean(p2_level_rt_sub_wide_a3$Hard, na.rm = TRUE)
sd(p2_level_rt_sub_wide_a3$Hard, na.rm = TRUE)
   
   
```

# Difficulty and Accuracy

## First Attempt

```{r}
p2_level_acc = Rmisc::summarySE(c,
                            measurevar = "Player2.ACC",
                            groupvars = c("Experiment", "Levelfac"))

p2_level_acc %>% 
  ggplot(aes(x = Levelfac, y = Player2.ACC)) + 
   geom_bar(stat = "identity", position = "dodge", width = 0.7, color= "black")+
 geom_errorbar(aes(ymin=Player2.ACC - se, ymax=Player2.ACC + se), 
             width=.2, color = "gray26", 
             position = position_dodge(0.7))+
 theme_few()+
 scale_fill_solarized()+
  facet_wrap(~Experiment)+
    xlab("Word Pair Difficulty") + ylab("Accuracy") + 
  ggtitle("Player 2 First Attempt Accuracy")  +
   theme(axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))

p2_level_acc_sub = group_by(c, Subject, Levelfac) %>%
  summarize_at(vars(Player2.ACC), mean)

# p2_level_acc_aov = aov(data = p2_level_acc_sub,
#                      Player2.ACC ~ Experiment*Levelfac +
#                        Error(Subject/Levelfac))
# 
# summary(p2_level_acc_aov)

p2_level_acc_sub_wide = spread(p2_level_acc_sub, Levelfac, Player2.ACC)
mean(p2_level_acc_sub_wide$Easy)
sd(p2_level_acc_sub_wide$Easy)

mean(p2_level_acc_sub_wide$Medium)
sd(p2_level_acc_sub_wide$Medium)

mean(p2_level_acc_sub_wide$Hard)
sd(p2_level_acc_sub_wide$Hard)

t.test(p2_level_acc_sub_wide$Easy, p2_level_acc_sub_wide$Medium, paired = TRUE)
t.test(p2_level_acc_sub_wide$Hard, p2_level_acc_sub_wide$Medium, paired = TRUE)
t.test(p2_level_acc_sub_wide$Easy, p2_level_acc_sub_wide$Hard, paired = TRUE)


```

## Second Attempt

```{r}
c_second_attempt = c %>% filter(c$Player2.ACC == 0)
p2_level_acc = Rmisc::summarySE(c_second_attempt,
                            measurevar = "Player2SecondAnswer.ACC",
                            groupvars = c("Experiment", "Levelfac"))

p2_level_acc %>% 
  ggplot(aes(x = Levelfac, y = Player2SecondAnswer.ACC)) + 
   geom_bar(stat = "identity", position = "dodge", width = 0.7, color= "black")+
 geom_errorbar(aes(ymin=Player2SecondAnswer.ACC - se, ymax=Player2SecondAnswer.ACC + se), 
             width=.2, color = "gray26", 
             position = position_dodge(0.7))+
 theme_few()+
 scale_fill_solarized()+
  facet_wrap(~Experiment)+
    xlab("Word Pair Difficulty") + ylab("Accuracy") + 
  ggtitle("Player 2 Second Attempt Accuracy")  +
   theme(axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))

p2_level_acc_sub_a2 = group_by(c_second_attempt, Subject, Levelfac) %>%
  summarize_at(vars(Player2SecondAnswer.ACC), mean)

# p2_level_acc_sub_a2_count = group_by(p2_level_acc_sub_a2, Subject) %>%
#   summarise(n = n())
# 
# missing_sub = p2_level_acc_sub_a2_count[which(p2_level_acc_sub_a2_count$n != 3),1]
# 
# p2_level_acc_sub_a2 = p2_level_acc_sub_a2 %>% filter(!Subject %in% missing_sub$Subject)
# 
# p2_level_acc_a2_aov = aov(data = p2_level_acc_sub_a2,
#                      Player2SecondAnswer.ACC ~ Experiment*Levelfac +
#                        Error(Subject/Levelfac))
# 
# summary(p2_level_acc_a2_aov)

p2_level_acc_sub_wide_a2 = spread(p2_level_acc_sub_a2, Levelfac, Player2SecondAnswer.ACC)
mean(p2_level_acc_sub_wide_a2$Easy, na.rm = TRUE)
sd(p2_level_acc_sub_wide_a2$Easy, na.rm = TRUE)

mean(p2_level_acc_sub_wide_a2$Medium, na.rm = TRUE)
sd(p2_level_acc_sub_wide_a2$Medium, na.rm = TRUE)

mean(p2_level_acc_sub_wide_a2$Hard, na.rm = TRUE)
sd(p2_level_acc_sub_wide_a2$Hard, na.rm = TRUE)

t.test(p2_level_acc_sub_wide_a2$Easy, p2_level_acc_sub_wide_a2$Medium, paired = TRUE)
t.test(p2_level_acc_sub_wide_a2$Hard, p2_level_acc_sub_wide_a2$Medium, paired = TRUE)
t.test(p2_level_acc_sub_wide_a2$Easy, p2_level_acc_sub_wide_a2$Hard, paired = TRUE)


```

## Third Attempt

```{r}
c_third_attempt = c %>% filter(c$Player2.ACC == 0 &
                                 Player2SecondAnswer.ACC == 0)
p2_level_acc_3 = Rmisc::summarySE(c_third_attempt,
                            measurevar = "Player2ThirdAnswer.ACC",
                            groupvars = c("Experiment", "Levelfac"))

p2_level_acc_3 %>% 
  ggplot(aes(x = Levelfac, y = Player2ThirdAnswer.ACC)) + 
   geom_bar(stat = "identity", position = "dodge", width = 0.7, color= "black")+
 geom_errorbar(aes(ymin=Player2ThirdAnswer.ACC - se, ymax=Player2ThirdAnswer.ACC + se), 
             width=.2, color = "gray26", 
             position = position_dodge(0.7))+
 theme_few()+
 scale_fill_solarized()+
  facet_wrap(~Experiment)+
    xlab("Word Pair Difficulty") + ylab("Accuracy") + 
  ggtitle("Player 2 Third Attempt Accuracy")  +
   theme(axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))

p2_level_acc_sub_a3 = group_by(c_third_attempt, Subject, Levelfac) %>%
  summarize_at(vars(Player2ThirdAnswer.ACC), mean)

# p2_level_acc_sub_a3_count = group_by(p2_level_acc_sub_a3, Subject) %>%
#   summarise(n = n())
# 
# missing_sub = p2_level_acc_sub_a3_count[which(p2_level_acc_sub_a3_count$n != 3),1]
# 
# p2_level_acc_sub_a3 = p2_level_acc_sub_a3 %>% filter(!Subject %in% missing_sub$Subject)
# 
# p2_level_acc_a3_aov = aov(data = p2_level_acc_sub_a2,
#                      Player2SecondAnswer.ACC ~ Experiment*Levelfac +
#                        Error(Subject/Levelfac))
# 
# summary(p2_level_acc_a3_aov)


p2_level_acc_sub_wide_a3 = spread(p2_level_acc_sub_a3, Levelfac, Player2ThirdAnswer.ACC)
mean(p2_level_acc_sub_wide_a3$Easy, na.rm = TRUE)
sd(p2_level_acc_sub_wide_a3$Easy, na.rm = TRUE)

mean(p2_level_acc_sub_wide_a3$Medium, na.rm = TRUE)
sd(p2_level_acc_sub_wide_a3$Medium, na.rm = TRUE)

mean(p2_level_acc_sub_wide_a3$Hard, na.rm = TRUE)
sd(p2_level_acc_sub_wide_a3$Hard, na.rm = TRUE)

t.test(p2_level_acc_sub_wide_a3$Easy, p2_level_acc_sub_wide_a3$Medium, paired = TRUE)
t.test(p2_level_acc_sub_wide_a3$Hard, p2_level_acc_sub_wide_a3$Medium, paired = TRUE)
t.test(p2_level_acc_sub_wide_a3$Easy, p2_level_acc_sub_wide_a3$Hard, paired = TRUE)

```


# Clue Prediction Score

```{r}
c = read.csv("e1e2_COMBINED.csv", header = TRUE, sep = ",")

nelsonwords = read.csv("5018words.csv", header = TRUE, sep = ",")
nelsonwords$Word = toupper(nelsonwords$Word)
nelsonwords$Word = as.factor(nelsonwords$Word)

c_valid = c %>% filter(c$Clue1 %in% nelsonwords$Word)

library(tidyverse)
c_clue_predict = group_by(c_valid, Subject) %>%
  summarise_at(vars(P1_ACN, P1_Undirected, P1_DirectedW1W2, 
                    word2vec_score, fastText_score,  glove_score), mean)

c_clue_predict_long = gather(c_clue_predict, Rep, Accuracy,
                             P1_ACN, P1_Undirected, P1_DirectedW1W2, 
                    word2vec_score, fastText_score,  glove_score)

## lme
c_clue_predict_long$Rep = as.factor(c_clue_predict_long$Rep)
contrasts(c_clue_predict_long$Rep) = contr.treatment(6, base = 6)

clue_lme = lmerTest::lmer(data = c_clue_predict_long, Accuracy ~ Rep +
                  (1|Subject))
summary(clue_lme)
car::Anova(clue_lme)

c_clue_predict_long$Rep = ordered(as.factor(as.character(c_clue_predict_long$Rep)), 
                             levels = c("P1_ACN","P1_Undirected",
                                        "P1_DirectedW1W2",  
                                         "word2vec_score", "fastText_score",
                                        "glove_score"))

c_clue_predict_long = c_clue_predict_long %>% 
  mutate(Model = factor(Rep, 
    levels = unique(Rep),
                    labels = c("ACN","Undirected SDN", "Directed SDN",
                                         "word2vec",
                                        "fastText", "GloVe")))
                             
c_clue_rmisc = Rmisc::summarySE(c_clue_predict_long,
                           measurevar = "Accuracy",
                           groupvars = c( "Model"))
library(ggplot2)
library(ggthemes)
c_clue_rmisc %>% filter(Model %in% c("Undirected SDN", "Directed SDN",
                                         "word2vec", "GloVe")) %>%
  ggplot(aes(x = Model, y = Accuracy, 
             group = Model, fill = Model)) + 
   geom_bar(stat = "identity", position = "dodge", width = 0.7, color= "black")+
 geom_errorbar(aes(ymin=Accuracy - se, ymax=Accuracy + se), 
             width=.1, color = "gray26", 
             position = position_dodge(0.7))+
 theme_few()+
  #facet_wrap(~Experiment)+
 scale_fill_solarized()+
  ylim(0,0.70)+
 # scale_y_continuous(breaks = seq(0,1,0.1))+
       xlab("Semantic Model") + ylab("Average Prediction Score") + 
  ggtitle("Model Accuracy in Predicting Clue Master's First Clues")  +
   theme(axis.ticks.x = element_blank(),
     axis.text.x = element_blank(),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))
```

# Clue Relationship
```{r}
c = read.csv("e1e2_COMBINED.csv", header = TRUE, sep = ",")

nelsonwords = read.csv("5018words.csv", header = TRUE, sep = ",")
nelsonwords$Word = toupper(nelsonwords$Word)
nelsonwords$Word = as.factor(nelsonwords$Word)

c_valid = c %>% filter(c$Clue1 %in% nelsonwords$Word)
c_valid$wordpair = paste(c_valid$Word1, "-", c_valid$Word2)

c_valid_e1 = c_valid %>% filter(Experiment == "E1")
c_valid_e2 = c_valid %>% filter(Experiment == "E2")

## how many total clues are of diff types?

c_cluetype_count_wp = group_by(c_valid, wordpair, Undirected, ClueType ) %>%
  summarize(n = n()) %>% arrange(wordpair)

c_cluetype_count_total = group_by(c_valid, wordpair ) %>%
  summarize(n = n()) %>% arrange(wordpair)
colnames(c_cluetype_count_total) = c("wordpair", "ntotal")

c_cluetype_count_wp = left_join(c_cluetype_count_wp, c_cluetype_count_total)

c_cluetype_count_wp$prop = c_cluetype_count_wp$n/c_cluetype_count_wp$ntotal

c_cluetype_count_wp_rmisc = Rmisc::summarySE(c_cluetype_count_wp,
                                             measurevar = "prop",
                                             groupvars = c("ClueType"))

## if i want to know relative proportion of different clues in E1 vs. E2
c_cluetype_count_exp = group_by(c, ClueType ) %>%
  summarize(n = n())
c_cluetype_count_total = group_by(c_valid ) %>%
  summarize(total = n())

c_cluetype_count_exp$prop = c_cluetype_count_exp$n/c_cluetype_count_total$total

c_cluetype_count_exp %>% 
  ggplot(aes(x = ClueType, y = prop)) + 
   geom_bar(stat = "identity", position = "dodge", width = 0.7, color= "black")+
 theme_few()+
 scale_fill_solarized()+
       xlab("Semantic Model") + ylab("Average Prediction Score") + 
  ggtitle("Proportion of Clues in E1 and E2")  +
   theme(
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))

## what are the scores?

library(tidyverse)
c_clue_predict_type = group_by(c_valid, wordpair, ClueType) %>%
  summarise_at(vars(P1_ACN, P1_Undirected, P1_DirectedW1W2, 
                    word2vec_score, fastText_score,  glove_score), mean)



c_clue_predict_type_long = gather(c_clue_predict_type, Rep, Accuracy,
                             P1_ACN, P1_Undirected, P1_DirectedW1W2, 
                    word2vec_score, fastText_score,  glove_score)

c_clue_predict_type_long$Rep = ordered(as.factor(as.character(c_clue_predict_type_long$Rep)), 
                             levels = c("P1_ACN","P1_Undirected",
                                        "P1_DirectedW1W2",  
                                         "word2vec_score", "fastText_score",
                                        "glove_score"))

c_clue_predict_type_long = c_clue_predict_type_long %>% 
  mutate(Model = factor(Rep, 
    levels = unique(Rep),
                    labels = c("ACN","Undirected SDN", "Directed SDN",
                                         "word2vec",
                                        "fastText", "GloVe")))
                             
c_clue_rmisc_type = Rmisc::summarySE(c_clue_predict_type_long,
                           measurevar = "Accuracy",
                           groupvars = c( "ClueType", "Model"))
library(ggplot2)
library(ggthemes)
c_clue_rmisc_type %>% filter(Model %in% c("Undirected SDN", "Directed SDN",
                                         "word2vec", "GloVe")
                             &
                               ClueType %in% c("Attributive", "Coordinate", "Hierarchical",
                                               "Locative")) %>%
  ggplot(aes(x = ClueType, y = Accuracy, 
             group = Model, fill = Model)) + 
   geom_bar(stat = "identity", position = "dodge", width = 0.7, color= "black")+
 geom_errorbar(aes(ymin=Accuracy - se, ymax=Accuracy + se),
             width=.1, color = "gray26",
             position = position_dodge(0.7))+
 theme_few()+
 scale_fill_solarized()+
       xlab("Semantic Relationship") + ylab("Average Prediction Score") + 
  ggtitle("Model Accuracy in Predicting Clue Master's 
  First Clues Across Different Semantic Relationships")  +
   theme(axis.text.x = element_text(face = "bold", size = rel(1.2)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))


## FOR LME
c_valid_main = c_valid %>% filter(ClueType %in% c("Attributive", "Coordinate", 
                                                  "Hierarchical",
                                               "Locative"))

c_valid_main$ClueType = factor(c_valid_main$ClueType)

c_clue_predict_type_main = group_by(c_valid_main, wordpair, ClueType) %>%
  summarise_at(vars( P1_Undirected, P1_DirectedW1W2, 
                    word2vec_score,  glove_score), mean)

c_clue_predict_type_long_main = gather(c_clue_predict_type_main,Rep, Accuracy,
                              P1_Undirected, P1_DirectedW1W2, 
                    word2vec_score,  glove_score)

c_clue_predict_type_long_main$Rep = factor(c_clue_predict_type_long_main$Rep)

c_clue_predict_type_long_main$wordpair = as.factor(c_clue_predict_type_long_main$wordpair)


contrasts(c_clue_predict_type_long_main$ClueType) = contr.treatment(4, base = 3)
contrasts(c_clue_predict_type_long_main$Rep) = contr.treatment(4, base = 1)

rel_aov = lmerTest::lmer(data = c_clue_predict_type_long_main,
                        Accuracy ~ ClueType*Rep + (1|wordpair),
                          control=lmerControl(optimizer="bobyqa",
          optCtrl=list(maxfun=100000)))
summary(rel_aov)
car::Anova(rel_aov)
```

# Guesser Prediction Score (Main-Moderate)

```{r}
#c_valid is now those clues that are within the 5018 range
#c_valid = new_c_z %>% filter(! is.na(Word1Clue1_Undirected))

## proportion of correct predictions 
c_valid_noneasy = c_valid %>% filter(!Level == "Easy")
mean_pred_score = group_by(c_valid, Experiment, Subject) %>%
  summarise_at(vars(P2_USDN_1.5,
                    P2_DSDN12_1.5,
                    #P2_ACN_1.5,
                    # P2Prediction_w2vwiki,
                    # P2Prediction_glove, 
                    # P2Prediction_fasttext,
                    word2vec_num_1.5,
                    #fastText_num_1.5,
                    glove_num_1.5), sum)

mean_pred_score_items = group_by(c_valid, Experiment, Level, wordpair) %>%
  summarise_at(vars(P2_USDN_1.5,
                    P2_DSDN12_1.5,
                    #P2_ACN_1.5,
                    # P2Prediction_w2vwiki,
                    # P2Prediction_glove, 
                    # P2Prediction_fasttext,
                    word2vec_num_1.5,
                    #fastText_num_1.5,
                    glove_num_1.5), sum)

p2_acc_long_mod =mean_pred_score %>% ## change this to non-item for actual
 gather(Rep, PredictionScore, 
        #P2_ACN_1.5,
                    P2_USDN_1.5,
                    P2_DSDN12_1.5,
        #             P2Prediction_w2vwiki,
        #             P2Prediction_fasttext,
        # P2Prediction_glove,
        word2vec_num_1.5,
              #      fastText_num_1.5,
                    glove_num_1.5
)

## histogram per word pair
# c_valid %>% filter(Level == "Easy") %>%
# ggplot(aes(x = glove_num_1.5))+
# geom_histogram(binwidth = 0.5, color = "gray24", fill = "darkgoldenrod")+
#  theme_few()+
#   facet_wrap(~wordpair)+
#  #scale_color_solarized()+
#        xlab("") + 
#   ylab("Frequency") + 
#   ggtitle("DISTANT PAIRS: Histogram for Prediction Scores")  +
#   theme(axis.text.y = element_text(face = "bold", size = rel(1.2)),
#          axis.text.x = element_text(face = "bold", size = rel(1.2)),
#           axis.title = element_text(face = "bold", size = rel(1)),
#           legend.title = element_text(face = "bold", size = rel(1)),
#          plot.title = element_text(hjust = .5),
#          strip.text.x = element_text(face = "bold", size = rel(1.4)))
# 30 word pairs total, times 2 = 60

p2_acc_long_mod$prop = p2_acc_long_mod$PredictionScore/60

p2_acc_long_mod$Rep = ordered(as.factor(as.character(p2_acc_long_mod$Rep)), 
                             levels = c(#"P2_ACN_1.5", 
                                        "P2_USDN_1.5",
                                        "P2_DSDN12_1.5",
                                        # "P2Prediction_w2vwiki",
                                        # "P2Prediction_fasttext",
                                        # "P2Prediction_glove",
                                        "word2vec_num_1.5",
                    #"fastText_num_1.5",
                    "glove_num_1.5"))

p2_acc_long_mod = p2_acc_long_mod %>% 
  mutate(Model = factor(Rep, 
    levels = unique(Rep),
                    labels = c(#"ACN",
                               "Undirected SDN", "Directed SDN",
                                        #  "word2vec_unadjusted",
                                        # "fastText_unadjusted", "GloVe_unadjusted",
                               "word2vec",
                                       # "fastText", 
                               "GloVe")))

## LME

## only want to examine differences across some models

## remove unadjusted scores

# p2_acc_long_mod = p2_acc_long_mod %>% filter(!Model %in%
#                                                          c( "word2vec_unadjusted",
#                                         "fastText_unadjusted", "GloVe_unadjusted")  )
# 
contrasts(p2_acc_long_mod$Model) = contr.treatment(4, base = 3)

p2_acc_long_lme_mod = lmerTest::lmer(data = p2_acc_long_mod, 
                                 prop ~ Model + (1|Subject))
summary(p2_acc_long_lme_mod)
car::Anova(p2_acc_long_lme_mod)

p2_acc_rmisc_moderate = Rmisc::summarySE(p2_acc_long_mod,
                                measurevar = "prop",
                                groupvars = c( "Model"))

p2_acc_rmisc_moderate = p2_acc_rmisc_moderate %>% filter(!Model %in%
                                                         c( "word2vec_unadjusted",
                                        "fastText_unadjusted", "GloVe_unadjusted")  )

p2_acc_rmisc_moderate %>% 
  ggplot(aes(x = Model, y = prop, 
             group = Model, fill = Model)) + 
   geom_bar(stat = "identity", position = "dodge", width = 0.7, color= "black")+
 geom_errorbar(aes(ymin=prop - se, ymax=prop + se), 
             width=.1, color = "gray26", 
             position = position_dodge(0.7))+
 theme_few()+
 scale_fill_solarized()+
  ylim(0, 0.70)+
 # facet_wrap(~Experiment) +
       xlab("Semantic Model") + ylab("Average Guesser Prediction Score") + 
  ggtitle("Model Accuracy in Predicting Guesser Responses")  +
   theme(axis.ticks.x = element_blank(),
     axis.text.x = element_blank(),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))
```



# Player 1 z-RT

```{r}
c_firsttrim = c_valid %>% filter(Player1.RT > 250 &  
                                             Player1.RT < 120000 )

((nrow(c_valid)-nrow(c_firsttrim))/nrow(c_valid))*100

## aggregate per subject all IVs and DVs
meanRT = group_by(c_firsttrim, Subject) %>%
  summarise_at(vars(Player1.RT), mean)
colnames(meanRT) = c("Subject", "MeanRTTarget")

sdRT = group_by(c_firsttrim, Subject) %>%
  summarise_at(vars(Player1.RT), sd)
colnames(sdRT) = c("Subject", "sdRTTarget")

RT_agg = merge(meanRT, sdRT, by = "Subject")

## merge aggregate info with long data
c_z = merge(c_firsttrim, RT_agg, by = "Subject", all.x = T)

## person and grand-mean centered scores using original and aggregate
library(dplyr)
c_z = c_z %>% mutate(zP1 = (Player1.RT - MeanRTTarget)/sdRTTarget)
                 
## checking: subject level means should be zero

sub_pic = group_by(c_z, Subject) %>%
  summarise_at(vars(zP1), mean)

c_z_trimmed = subset(c_z, c_z$zP1 < 3 &
                               c_z$zP1 > -3)

((nrow(c_valid) - nrow(c_z_trimmed))/nrow(c_valid))*100

## aggregate per subject all IVs and DVs
meanRT_trim = group_by(c_z_trimmed, Subject) %>%
  summarise_at(vars(Player1.RT), mean)
colnames(meanRT_trim) = c("Subject", "MeanRT_trim")

sdRT_trim = group_by(c_z_trimmed, Subject) %>%
  summarise_at(vars(Player1.RT), sd)
colnames(sdRT_trim) = c("Subject", "sdRT_trim")

RT_agg_trim = merge(meanRT_trim, sdRT_trim, by = "Subject")

## merge aggregate info with long data
new_c_z = merge(c_z_trimmed, 
                        RT_agg_trim, by = "Subject", all.x = T)

## person and grand-mean centered scores using original and aggregate
library(dplyr)
new_c_z = new_c_z %>% 
  mutate(zP1_final = (Player1.RT - MeanRT_trim)/sdRT_trim)
                 
## checking: subject level means should be zero

sub_pic = group_by(new_c_z, Subject) %>%
  summarise_at(vars(zP1_final), mean)
```


## Scaling Distances

```{r}
## to predict player 1 RT, we want to see whether distance between W1 and W2 predicted RT

new_c_z$w1w2_w2vwikiz = as.numeric(scale(2-new_c_z$word2vecwikiW1W2, center = TRUE,
                                   scale = TRUE))

new_c_z$w1w2_glovez = as.numeric(scale(2-new_c_z$gloveW1W2, center = TRUE,
                                   scale = TRUE))

new_c_z$w1w2_fastTextz = as.numeric(scale(2-new_c_z$fastTextW1W2, center = TRUE,
                                   scale = TRUE))

new_c_z$w1w2_Kenettz = as.numeric(scale(new_c_z$ACN, center = TRUE,
                                   scale = TRUE))
new_c_z$w1w2_Undirectedz = as.numeric(scale(new_c_z$Undirected, center = TRUE,
                                   scale = TRUE))
new_c_z$w1w2_Directed12z = as.numeric(scale(new_c_z$DirectedW1W2, center = TRUE,
                                   scale = TRUE))

new_c_z$w1w2_Directed21z = as.numeric(scale(new_c_z$DirectedW2W1, center = TRUE,
                                   scale = TRUE))

## these below are average distance of Clue1 from Word1 and Word2 (will be used for Player 2)

new_c_z$ClueAvg_w2vwiki = ((2-new_c_z$word2vecwikiW1C1) + (2-new_c_z$word2vecwikiW2C1))/2

new_c_z$ClueAvg_glove = ((2-new_c_z$gloveW1C1) + (2-new_c_z$gloveW2C1))/2

new_c_z$ClueAvg_fastText = ((2-new_c_z$fastTextW1C1) + (2-new_c_z$fastTextW2C1))/2

## will be standardizing these so that they can be compared on same scale

new_c_z$ClueAvg_Undirectedz = as.numeric(scale(new_c_z$ClueAvg_Undirected, center = TRUE,
                                   scale = TRUE))
new_c_z$ClueAvg_Directed12z = as.numeric(scale(new_c_z$ClueAvg_Directed12, center = TRUE,
                                   scale = TRUE))

new_c_z$ClueAvg_Directed21z = as.numeric(scale(new_c_z$ClueAvg_Directed21, center = TRUE,
                                   scale = TRUE))

new_c_z$ClueAvg_Kenettz = as.numeric(scale(new_c_z$ClueAvg_Kenett, center = TRUE,
                                   scale = TRUE))

new_c_z$ClueAvg_w2vwikiz = as.numeric(scale(new_c_z$ClueAvg_w2vwiki, center = TRUE,
                                   scale = TRUE))

new_c_z$ClueAvg_fastTextz = as.numeric(scale(new_c_z$ClueAvg_fastText, center = TRUE,
                                   scale = TRUE))

new_c_z$ClueAvg_glovez = as.numeric(scale(new_c_z$ClueAvg_glove, center = TRUE,
                                   scale = TRUE))


```


## Clue zRT LME
```{r}
library(lme4)
new_c_z$wordpair = paste(new_c_z$Word1, "-", new_c_z$Word2)
new_c_z_complete = new_c_z %>% filter(!is.na(w1w2_Directed21z) & !is.na(w1w2_conc) & 
                                        !is.na(w1w2_freq) & !is.na(w1w2_length))
## here we also add covariates: mean w1w2 length, conc, and freq 
p1_clue_directed = lmerTest::lmer(data = new_c_z_complete,
                        zP1_final ~ w1w2_length + w1w2_conc + w1w2_freq +
                      w1w2_Directed21z + (1|wordpair),
                          control=lmerControl(optimizer="bobyqa",
          optCtrl=list(maxfun=100000)))
summary(p1_clue_directed)
car::Anova(p1_clue_directed)
CIdirected = as.data.frame(confint(p1_clue_directed))

p1_clue_undirected = lmerTest::lmer(data = new_c_z_complete,
                        zP1_final ~ w1w2_length + w1w2_conc + w1w2_freq +
                      w1w2_Undirectedz + (1|wordpair),
                          control=lmerControl(optimizer="bobyqa",
          optCtrl=list(maxfun=100000)))

summary(p1_clue_undirected)
CIundirected = as.data.frame(confint(p1_clue_undirected))

p1_clue_acn = lmerTest::lmer(data = new_c_z_complete,
                        zP1_final ~ w1w2_length + w1w2_conc + w1w2_freq +
                      w1w2_Kenettz +  (1|wordpair),
                          control=lmerControl(optimizer="bobyqa",
          optCtrl=list(maxfun=100000)))
summary(p1_clue_acn)
CIacn = as.data.frame(confint(p1_clue_acn))

p1_clue_word2vec = lmerTest::lmer(data = new_c_z_complete,
                        zP1_final ~ w1w2_length + w1w2_conc + w1w2_freq +
                      w1w2_w2vwikiz  +  (1|wordpair),
                          control=lmerControl(optimizer="bobyqa",
          optCtrl=list(maxfun=100000)))
summary(p1_clue_word2vec)
CIword2vec = as.data.frame(confint(p1_clue_word2vec))

p1_clue_fastText = lmerTest::lmer(data = new_c_z_complete,
                        zP1_final ~ w1w2_length + w1w2_conc + w1w2_freq +
                      w1w2_fastTextz  +  (1|wordpair) ,
                          control=lmerControl(optimizer="bobyqa",
          optCtrl=list(maxfun=100000)))
summary(p1_clue_fastText)

CIfastText = as.data.frame(confint(p1_clue_fastText))

p1_clue_glove = lmerTest::lmer(data = new_c_z_complete,
                        zP1_final ~ w1w2_length + w1w2_conc + w1w2_freq +
                      w1w2_glovez  +  (1|wordpair),
                          control=lmerControl(optimizer="bobyqa",
          optCtrl=list(maxfun=100000)))
summary(p1_clue_glove)

CIglove = as.data.frame(confint(p1_clue_glove))

BIC(p1_clue_glove, p1_clue_word2vec, p1_clue_undirected, p1_clue_directed)

## bayes factor analyses

library(BayesFactor)
directedbf <- lmBF(zP1_final ~ w1w2_length + w1w2_conc + w1w2_freq +
                      w1w2_Directed21z, whichRandom = "wordpair",
            data = new_c_z_complete)

undirectedbf <- lmBF(zP1_final ~ w1w2_length + w1w2_conc + w1w2_freq +
                      w1w2_Undirectedz, whichRandom = "wordpair",
            data = new_c_z_complete)

word2vecbf <- lmBF(zP1_final ~ w1w2_length + w1w2_conc + w1w2_freq +
                      w1w2_w2vwikiz, whichRandom = "wordpair",
            data = new_c_z_complete)

glovebf <- lmBF(zP1_final ~ w1w2_length + w1w2_conc + w1w2_freq +
                      w1w2_glovez, whichRandom = "wordpair",
            data = new_c_z_complete)

undirectedbf/word2vecbf
glovebf/word2vecbf
word2vecbf/directedbf
glovebf/directedbf

## BRMS 
library(brms)
brms_undirected <- brm(zP1_final ~ w1w2_length + w1w2_conc + w1w2_freq +
                      w1w2_glovez + ( 1 | wordpair),
           data = new_c_z_complete, family = gaussian)
summary(brms_undirected)

brms_word2vec <- brm(zP1_final ~ w1w2_length + w1w2_conc + w1w2_freq +
                      w1w2_w2vwikiz + ( 1 | wordpair),
           data = new_c_z_complete, family = gaussian)
summary(brms_word2vec)

brms::bayes_factor(brms_undirected, brms_word2vec)
```
##### Plot Individual
```{r}

predict_data_individual = matrix(NA, nrow = 6, ncol = 4)
colnames(predict_data_individual) = c("Model" , "beta", "lower", "upper")
predict_data_individual = as.data.frame(predict_data_individual)
predict_data_individual$beta = c(fixef(p1_clue_undirected)[5],
                                 fixef(p1_clue_directed)[5],
                                 fixef(p1_clue_acn)[5],
                                 fixef(p1_clue_word2vec)[5],
                                 fixef(p1_clue_fastText)[5],
                                 fixef(p1_clue_glove)[5])
predict_data_individual$lower = c(CIundirected[7, 1], CIdirected[7, 1],
                                  CIacn[7, 1],CIword2vec[7, 1], CIfastText[7,1], 
                                  CIglove[7,1])
predict_data_individual$upper = c(CIundirected[7, 2], CIdirected[7, 2],
                                  CIacn[7, 2],CIword2vec[7, 2], 
                                  CIfastText[7, 2], CIglove[7, 2])
predict_data_individual$Model = c("Undirected SDN", "Directed SDN", 
                       "ACN", "word2vec", "fastText", "GloVe")

predict_data_individual$Model = ordered(as.factor(predict_data_individual$Model),
                    levels = c("ACN", "Undirected SDN", "Directed SDN",
                               "word2vec", "fastText", "GloVe"))

predict_data_individual %>% filter(Model %in% c("Undirected SDN", "Directed SDN",
                               "word2vec", "GloVe")) %>%
  ggplot(aes(x = Model , y = beta, 
             group = Model, fill =  Model)) + 
geom_bar(stat = "identity", position = "dodge", width = 0.7, color= "black")+
 geom_errorbar(aes(ymin=lower, ymax=upper), 
             width=.2, color = "gray26", 
             position = position_dodge(0.7))+ theme_few()+
 scale_fill_solarized()+
 # facet_wrap(~subject)+
    xlab("Semantic Model") + ylab("beta weight") + 
  ggtitle("Betas Predicting Clue Master's z-RTs to generate Clue 1")  +
   theme(axis.text.x = element_blank(),
         axis.ticks.x = element_blank(),
     axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_blank())
```
# Guesser Acc LME
```{r}
## also including covariates here. clue and w1w2 len, conc, and freq

new_c_z_complete = new_c_z %>% filter(!is.na(ClueAvg_Directed21z) & !is.na(w1w2_conc) & 
                                        !is.na(w1w2_freq) & !is.na(w1w2_length) &
                                        !is.na(clue_length) & !is.na(clue_conc) &
                                      !is.na(clue_freq))

p2_clue_directed = glmer(data = new_c_z_complete, 
                        Player2.ACC ~  ClueAvg_Directed21z +
                          w1w2_length + w1w2_conc + w1w2_freq +
                          clue_length + clue_conc + clue_freq +
                            (1|wordpair),
                          family = "binomial",
                          control=glmerControl(optimizer="bobyqa",
          optCtrl=list(maxfun=100000)))
summary(p2_clue_directed)
CI_p2_directed = as.data.frame(confint(p2_clue_directed, method = "Wald"))

p2_clue_undirected = glmer(data = new_c_z_complete, 
                        Player2.ACC ~  ClueAvg_Undirectedz +
                           w1w2_length + w1w2_conc + w1w2_freq +
                          clue_length + clue_conc + clue_freq +
                           (1|wordpair),
                          family = "binomial",
                          control=glmerControl(optimizer="bobyqa",
          optCtrl=list(maxfun=100000)))
summary(p2_clue_undirected)
CI_p2_undirected = as.data.frame(confint(p2_clue_undirected, method = "Wald"))

p2_clue_acn = glmer(data = new_c_z_complete, 
                        Player2.ACC ~  ClueAvg_Kenettz +
                       w1w2_length + w1w2_conc + w1w2_freq +
                          clue_length + clue_conc + clue_freq +
                           (1|wordpair),
                          family = "binomial",
                          control=glmerControl(optimizer="bobyqa",
          optCtrl=list(maxfun=100000)))
summary(p2_clue_acn)
CI_p2_acn = as.data.frame(confint(p2_clue_acn, method = "Wald"))

p2_clue_word2vec = glmer(data = new_c_z_complete, 
                        Player2.ACC ~  ClueAvg_w2vwikiz +
                           w1w2_length + w1w2_conc + w1w2_freq +
                          clue_length + clue_conc + clue_freq +
                           (1|wordpair),
                          family = "binomial",
                          control=glmerControl(optimizer="bobyqa",
          optCtrl=list(maxfun=100000)))
summary(p2_clue_word2vec)
CI_p2_word2vec = as.data.frame(confint(p2_clue_word2vec, method = "Wald"))

p2_clue_fastText = glmer(data = new_c_z_complete, 
                        Player2.ACC ~  
                        ClueAvg_fastTextz +
                           w1w2_length + w1w2_conc + w1w2_freq +
                          clue_length + clue_conc + clue_freq +
                            (1|wordpair),
                          family = "binomial",
                          control=glmerControl(optimizer="bobyqa",
          optCtrl=list(maxfun=100000)))
summary(p2_clue_fastText)
CI_p2_fastText = as.data.frame(confint(p2_clue_fastText, method = "Wald"))

p2_clue_glove = glmer(data = new_c_z_complete, 
                        Player2.ACC ~   ClueAvg_glovez +
                         w1w2_length + w1w2_conc + w1w2_freq +
                          clue_length + clue_conc + clue_freq +
                          (1|wordpair),
                          family = "binomial",
                          control=glmerControl(optimizer="bobyqa",
          optCtrl=list(maxfun=100000)))
summary(p2_clue_glove)
CI_p2_glove = as.data.frame(confint(p2_clue_glove, method = "Wald"))

BIC(p2_clue_glove, p2_clue_word2vec, p2_clue_directed, p2_clue_undirected)
```
#### Plot individual
```{r}
p2_predict_data_individual = matrix(NA, nrow = 6, ncol = 4)
colnames(p2_predict_data_individual) = c("Model" , "beta", "lower", "upper")
p2_predict_data_individual = as.data.frame(p2_predict_data_individual)
p2_predict_data_individual$beta = c(fixef(p2_clue_acn)[2],
                                    fixef(p2_clue_undirected)[2],
                                 fixef(p2_clue_directed)[2],
                                 fixef(p2_clue_word2vec)[2],
                                 fixef(p2_clue_fastText)[2],
                                 fixef(p2_clue_glove)[2])
p2_predict_data_individual$lower = c(CI_p2_acn[3, 1],
                                     CI_p2_undirected[3, 1], CI_p2_directed[3, 1],
                                  CI_p2_word2vec[3, 1],
                                  CI_p2_fastText[3, 1], CI_p2_glove[3, 1])
p2_predict_data_individual$upper = c(CI_p2_acn[3, 2],
                                     CI_p2_undirected[3, 2], CI_p2_directed[3, 2],
                                  CI_p2_word2vec[3, 2],
                                  CI_p2_fastText[3, 2], CI_p2_glove[3, 2])
p2_predict_data_individual$Model = c("ACN", "Undirected SDN", "Directed SDN", 
                       "word2vec", "fastText", "GloVe")

p2_predict_data_individual$Model = ordered(as.factor(p2_predict_data_individual$Model),
                                           levels = c("ACN", "Undirected SDN", 
                            "Directed SDN", "word2vec", "fastText", "GloVe"))


p2_predict_data_individual %>% filter(Model %in% c("Undirected SDN", 
                            "Directed SDN", "word2vec", "GloVe"))%>%
  ggplot(aes(x = Model , y = beta,
             group = Model, fill = Model)) + 
geom_bar(stat = "identity", position = "dodge", width = 0.7, color= "black")+
 geom_errorbar(aes(ymin=lower, ymax=upper), 
             width=.2, color = "gray26", 
             position = position_dodge(0.7))+ theme_few()+
 scale_fill_solarized()+
 # facet_wrap(~subject)+
    xlab("Semantic Model") + ylab("beta weight") + 
  ggtitle("Betas Predicting Guesser's Accuracy for First Attempt")  +
   theme(axis.ticks.x = element_blank(),
         axis.text.x = element_blank(),
     axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))
```

# Guesser zRT

```{r}
c_firsttrim_p2 = c_valid %>% filter(Player2.RT > 250 &  
                                             Player2.RT < 120000)
## aggregate per subject all IVs and DVs
meanRT = group_by(c_firsttrim_p2, Subject) %>%
  summarise_at(vars(Player2.RT), mean)
colnames(meanRT) = c("Subject", "MeanRTTarget")

sdRT = group_by(c_firsttrim_p2, Subject) %>%
  summarise_at(vars(Player2.RT), sd)
colnames(sdRT) = c("Subject", "sdRTTarget")

RT_agg = merge(meanRT, sdRT, by = "Subject")

## merge aggregate info with long data
c_z = merge(c_firsttrim_p2, RT_agg, by = "Subject", all.x = T)

## person and grand-mean centered scores using original and aggregate
library(dplyr)
c_z = c_z %>% mutate(zP2 = (Player2.RT - MeanRTTarget)/sdRTTarget)
                 
## checking: subject level means should be zero

sub_pic = group_by(c_z, Subject) %>%
  summarise_at(vars(zP2), mean)

c_z_trimmed = subset(c_z, c_z$zP2 < 3 &
                               c_z$zP2 > -3)

((nrow(c_valid)-nrow(c_z_trimmed))/nrow(c_valid))*100

## aggregate per subject all IVs and DVs
meanRT_trim = group_by(c_z_trimmed, Subject) %>%
  summarise_at(vars(Player2.RT), mean)
colnames(meanRT_trim) = c("Subject", "MeanRT_trim")

sdRT_trim = group_by(c_z_trimmed, Subject) %>%
  summarise_at(vars(Player2.RT), sd)
colnames(sdRT_trim) = c("Subject", "sdRT_trim")

RT_agg_trim = merge(meanRT_trim, sdRT_trim, by = "Subject")

## merge aggregate info with long data
new_c_z_p2 = merge(c_z_trimmed, 
                        RT_agg_trim, by = "Subject", all.x = T)

## person and grand-mean centered scores using original and aggregate
library(dplyr)
new_c_z_p2 = new_c_z_p2 %>% 
  mutate(zP2_final = (Player2.RT - MeanRT_trim)/sdRT_trim)
                 
## checking: subject level means should be zero

sub_pic = group_by(new_c_z_p2, Subject) %>%
  summarise_at(vars(zP2_final), mean)
```

##### Scaling Distances

```{r}
## these below are average distance of Clue1 from Word1 and Word2 (will be used for Player 2)

new_c_z_p2$ClueAvg_w2vwiki = ((2-new_c_z_p2$word2vecwikiW1C1) + (2-new_c_z_p2$word2vecwikiW2C1))/2

new_c_z_p2$ClueAvg_glove = ((2-new_c_z_p2$gloveW1C1) + (2-new_c_z_p2$gloveW2C1))/2

new_c_z_p2$ClueAvg_fastText = ((2-new_c_z_p2$fastTextW1C1) + (2-new_c_z_p2$fastTextW2C1))/2

## will be standardizing these so that they can be compared on same scale

new_c_z_p2$ClueAvg_Undirectedz = as.numeric(scale(new_c_z_p2$ClueAvg_Undirected, center = TRUE,
                                   scale = TRUE))
new_c_z_p2$ClueAvg_Directed12z = as.numeric(scale(new_c_z_p2$ClueAvg_Directed12, center = TRUE,
                                   scale = TRUE))

new_c_z_p2$ClueAvg_Directed21z = as.numeric(scale(new_c_z_p2$ClueAvg_Directed21, center = TRUE,
                                   scale = TRUE))

new_c_z_p2$ClueAvg_Kenettz = as.numeric(scale(new_c_z_p2$ClueAvg_Kenett, center = TRUE,
                                   scale = TRUE))

new_c_z_p2$ClueAvg_w2vwikiz = as.numeric(scale(new_c_z_p2$ClueAvg_w2vwiki, center = TRUE,
                                   scale = TRUE))

new_c_z_p2$ClueAvg_fastTextz = as.numeric(scale(new_c_z_p2$ClueAvg_fastText, center = TRUE,
                                   scale = TRUE))

new_c_z_p2$ClueAvg_glovez = as.numeric(scale(new_c_z_p2$ClueAvg_glove, center = TRUE,
                                   scale = TRUE))

```

##### Individual Model

```{r}
new_c_z_p2$wordpair = paste(new_c_z_p2$Word1, "-", new_c_z_p2$Word2)

new_c_z_p2_complete = new_c_z_p2 %>% filter(!is.na(ClueAvg_Directed21z) &
                                              !is.na(w1w2_length) & !is.na(w1w2_conc) &
                                              !is.na(w1w2_freq) & !is.na(clue_length) &
                                              !is.na(clue_conc) & !is.na(clue_freq))

p2_clue_lm_zRT_acn = lmerTest::lmer(data = new_c_z_p2_complete, 
                        zP2_final ~ ClueAvg_Kenettz +
                          w1w2_length + w1w2_conc + w1w2_freq +
                          clue_length + clue_conc + clue_freq +
                           (1|wordpair),
                          control=lmerControl(optimizer="bobyqa",
          optCtrl=list(maxfun=100000)))
summary(p2_clue_lm_zRT_acn)
car::Anova(p2_clue_lm_zRT_acn)
CIp2RT_acn = as.data.frame(confint(p2_clue_lm_zRT_acn))

p2_clue_lm_zRT_undirected = lmerTest::lmer(data = new_c_z_p2_complete, 
                        zP2_final ~ ClueAvg_Undirectedz+ 
                          w1w2_length + w1w2_conc + w1w2_freq +
                          clue_length + clue_conc + clue_freq +
                            (1|wordpair),
                          control=lmerControl(optimizer="bobyqa",
          optCtrl=list(maxfun=100000)))
summary(p2_clue_lm_zRT_undirected)
car::Anova(p2_clue_lm_zRT_undirected)
CIp2RT_undirected = as.data.frame(confint(p2_clue_lm_zRT_undirected))

p2_clue_lm_zRT_directed = lmerTest::lmer(data = new_c_z_p2_complete, 
                        zP2_final ~ ClueAvg_Directed21z+ 
                          w1w2_length + w1w2_conc + w1w2_freq +
                          clue_length + clue_conc + clue_freq +
                           (1|wordpair),
                          control=lmerControl(optimizer="bobyqa",
          optCtrl=list(maxfun=100000)))
summary(p2_clue_lm_zRT_directed)
car::Anova(p2_clue_lm_zRT_directed)
CIp2RT_directed = as.data.frame(confint(p2_clue_lm_zRT_directed))

p2_clue_lm_zRT_word2vec = lmerTest::lmer(data = new_c_z_p2_complete, 
                        zP2_final ~ ClueAvg_w2vwikiz +
                          w1w2_length + w1w2_conc + w1w2_freq +
                          clue_length + clue_conc + clue_freq +
                            (1|wordpair),
                          control=lmerControl(optimizer="bobyqa",
          optCtrl=list(maxfun=100000)))
summary(p2_clue_lm_zRT_word2vec)
car::Anova(p2_clue_lm_zRT_word2vec)
CIp2RT_word2vec = as.data.frame(confint(p2_clue_lm_zRT_word2vec))

p2_clue_lm_zRT_fastText = lmerTest::lmer(data = new_c_z_p2_complete, 
                        zP2_final ~ ClueAvg_fastTextz +
                          w1w2_length + w1w2_conc + w1w2_freq +
                          clue_length + clue_conc + clue_freq +
                            (1|wordpair),
                          control=lmerControl(optimizer="bobyqa",
          optCtrl=list(maxfun=100000)))
summary(p2_clue_lm_zRT_fastText)
car::Anova(p2_clue_lm_zRT_fastText)
CIp2RT_fastText = as.data.frame(confint(p2_clue_lm_zRT_fastText))

p2_clue_lm_zRT_glove = lmerTest::lmer(data = new_c_z_p2_complete, 
                        zP2_final ~ ClueAvg_glovez +
                          w1w2_length + w1w2_conc + w1w2_freq +
                          clue_length + clue_conc + clue_freq +
                            (1|wordpair),
                          control=lmerControl(optimizer="bobyqa",
          optCtrl=list(maxfun=100000)))
summary(p2_clue_lm_zRT_glove)
car::Anova(p2_clue_lm_zRT_glove)
CIp2RT_glove = as.data.frame(confint(p2_clue_lm_zRT_glove))

BIC(p2_clue_lm_zRT_glove, p2_clue_lm_zRT_directed, p2_clue_lm_zRT_word2vec, 
    p2_clue_lm_zRT_undirected)

library(BayesFactor)
directedbf <- lmBF(zP2_final ~ ClueAvg_Directed21z+ 
                          w1w2_length + w1w2_conc + w1w2_freq +
                          clue_length + clue_conc + clue_freq, whichRandom = "wordpair",
            data = new_c_z_p2_complete)

undirectedbf <- lmBF(zP2_final ~ ClueAvg_Undirectedz+ 
                          w1w2_length + w1w2_conc + w1w2_freq +
                          clue_length + clue_conc + clue_freq, whichRandom = "wordpair",
            data = new_c_z_p2_complete)

word2vecbf <- lmBF(zP2_final ~ ClueAvg_w2vwikiz +
                          w1w2_length + w1w2_conc + w1w2_freq +
                          clue_length + clue_conc + clue_freq, whichRandom = "wordpair",
            data = new_c_z_p2_complete)

glovebf <- lmBF(zP2_final ~ ClueAvg_glovez +
                          w1w2_length + w1w2_conc + w1w2_freq +
                          clue_length + clue_conc + clue_freq, whichRandom = "wordpair",
            data = new_c_z_p2_complete)

undirectedbf/directedbf
directedbf/glovebf
glovebf/word2vecbf
word2vecbf/glovebf


```
##### Plot P2 RT individual
```{r}
p2RT_predict_data_individual = matrix(NA, nrow = 6, ncol = 4)
colnames(p2RT_predict_data_individual) = c("Model" , "beta", "lower", "upper")
p2RT_predict_data_individual = as.data.frame(p2RT_predict_data_individual)
p2RT_predict_data_individual$beta = c(fixef(p2_clue_lm_zRT_acn)[2],
                                    fixef(p2_clue_lm_zRT_undirected)[2],
                                 fixef(p2_clue_lm_zRT_directed)[2],
                                 fixef(p2_clue_lm_zRT_word2vec)[2],
                                 fixef(p2_clue_lm_zRT_fastText)[2],
                                 fixef(p2_clue_lm_zRT_glove)[2])
p2RT_predict_data_individual$lower = c(CIp2RT_acn[4, 1],
                                     CIp2RT_undirected[4, 1], CIp2RT_directed[4, 1],
                                  CIp2RT_word2vec[4, 1],
                                  CIp2RT_fastText[4, 1], CIp2RT_glove[4, 1])
p2RT_predict_data_individual$upper = c(CIp2RT_acn[4, 2],
                                     CIp2RT_undirected[4, 2], CIp2RT_directed[4, 2],
                                  CIp2RT_word2vec[4, 2],
                                  CIp2RT_fastText[4, 2], CIp2RT_glove[4, 2])
p2RT_predict_data_individual$Model = c("ACN", "Undirected SDN", "Directed SDN", 
                       "word2vec", "fastText", "GloVe")

p2RT_predict_data_individual$Model = ordered(as.factor(p2RT_predict_data_individual$Model),
                                           levels = c("ACN", "Undirected SDN", 
                            "Directed SDN", "word2vec", "fastText", "GloVe"))


p2RT_predict_data_individual %>% filter(Model %in% c("Undirected SDN", 
                            "Directed SDN", "word2vec", "GloVe"))%>%
  ggplot(aes(x = Model , y = beta,
             group = Model, fill = Model)) + 
geom_bar(stat = "identity", position = "dodge", width = 0.7, color= "black")+
 geom_errorbar(aes(ymin=lower, ymax=upper), 
             width=.2, color = "gray26", 
             position = position_dodge(0.7))+ theme_few()+
 scale_fill_solarized()+
 # facet_wrap(~subject)+
    xlab("Semantic Model") + ylab("beta weight") + 
  ggtitle("Betas Predicting Guesser's z-RTs for First Attempt")  +
   theme(axis.ticks.x = element_blank(),
         axis.text.x = element_blank(),
     axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))
```

# Clue1-W1/W2 Distances

```{r}
clues = read.csv("e1e2_COMBINED.csv", header = TRUE, sep = ",")

## overall,do we know if clue1 is close to w1 or w2?
clues$wordpair = paste(clues$Word1, "-", clues$Word2)
clue_averages = group_by(clues, Experiment, wordpair, Clue1) %>%
  summarize_at(vars(Word1Clue1_Undirected, Word2Clue1_Undirected,
                    Word1Clue1_Directed12, Word2Clue1_Directed12,
                    Word1Clue1_Directed21, Word2Clue1_Directed21,
                    Word1Clue1_Kenett,     Word2Clue1_Kenett,  
                    word2vecwikiW1C1,     word2vecwikiW2C1,
                    fastTextW1C1, fastTextW2C1,
                    gloveW1C1, gloveW2C1), mean)

t.test(clue_averages$Word1Clue1_Undirected, clue_averages$Word2Clue1_Undirected, 
       paired = TRUE)

t.test(clue_averages$Word1Clue1_Directed12, clue_averages$Word2Clue1_Directed12, 
       paired = TRUE)

t.test(clue_averages$Word1Clue1_Directed21, clue_averages$Word2Clue1_Directed21, 
       paired = TRUE)

t.test(clue_averages$Word1Clue1_Kenett, clue_averages$Word2Clue1_Kenett, 
       paired = TRUE)

t.test(clue_averages$word2vecwikiW1C1, clue_averages$word2vecwikiW2C1, 
       paired = TRUE)

t.test(clue_averages$fastTextW1C1, clue_averages$fastTextW2C1, 
       paired = TRUE)

t.test(clue_averages$gloveW1C1, clue_averages$gloveW2C1, 
       paired = TRUE)


```


# Clue 2 Analysis

```{r}
## does player2's second attempt accuracy depend upon any of these distances, after controlling for clue1 distances

clues = read.csv("e1e2_COMBINED.csv", header = TRUE, sep = ",")

#clue2_data = clues %>% filter(Player2.ACC == 0)
clue2_data = clues %>% filter(clues$Clue2 != "")
## also include only clues that are within 5018 words
clue2_data = clues %>% filter(clues$Clue2 %in% nelsonwords$Word)

# create partcorrect variables
clue2_data$A1PartCorrect = ifelse( (clue2_data$P2A1W1 == 1 & clue2_data$P2A1W2 == 0), 
                                 "Word1Correct", ifelse((clue2_data$P2A1W1 == 0 & clue2_data$P2A1W2 == 1), "Word2Correct", "NoCorrect"))

clue2_data$A2PartCorrect = ifelse( (clue2_data$P2A2W1 == 1 & clue2_data$P2A2W2 == 0), 
                                 "Word1Correct", ifelse((clue2_data$P2A2W1 == 0 & clue2_data$P2A2W2 == 1), "Word2Correct", "NoCorrect"))

#clue2_data = clue2_data %>% filter(!is.na(U_c1c2) & !is.na(D1_c1c2) & !is.na(D2_c1c2))
clue2_data$wordpair = paste(clue2_data$Word1, "-", clue2_data$Word2)
```

#### Scaling Distances

```{r}
## scaling (1) Clue2-Word1

clue2_data$Word1Clue2_Kenettz = as.numeric(scale(clue2_data$Word1Clue2_Kenett, 
                                                 center = TRUE, scale = TRUE))

clue2_data$Word1Clue2_Undirectedz = as.numeric(scale(clue2_data$Word1Clue2_Undirected, 
                                                 center = TRUE, scale = TRUE))

clue2_data$Word1Clue2_Directed12z = as.numeric(scale(clue2_data$Word1Clue2_Directed12, 
                                                 center = TRUE, scale = TRUE))

clue2_data$Word1Clue2_Directed21z = as.numeric(scale(clue2_data$Word1Clue2_Directed21, 
                                                 center = TRUE, scale = TRUE))
clue2_data$Word1Clue2_w2vwikiz = as.numeric(scale(2-clue2_data$word2vecwikiW1C2, 
                                                 center = TRUE, scale = TRUE))
clue2_data$Word1Clue2_fastTextz = as.numeric(scale(2-clue2_data$fastTextW1C2, 
                                                 center = TRUE, scale = TRUE))
clue2_data$Word1Clue2_glovez = as.numeric(scale(2-clue2_data$gloveW1C2, 
                                                 center = TRUE, scale = TRUE))

## scaling (2) Clue2-Word2

clue2_data$Word2Clue2_Kenettz = as.numeric(scale(clue2_data$Word2Clue2_Kenett, 
                                                 center = TRUE, scale = TRUE))

clue2_data$Word2Clue2_Undirectedz = as.numeric(scale(clue2_data$Word2Clue2_Undirected, 
                                                 center = TRUE, scale = TRUE))

clue2_data$Word2Clue2_Directed12z = as.numeric(scale(clue2_data$Word2Clue2_Directed12, 
                                                 center = TRUE, scale = TRUE))

clue2_data$Word2Clue2_Directed21z = as.numeric(scale(clue2_data$Word2Clue2_Directed21, 
                                                 center = TRUE, scale = TRUE))
clue2_data$Word2Clue2_w2vwikiz = as.numeric(scale(2-clue2_data$word2vecwikiW2C2, 
                                                 center = TRUE, scale = TRUE))
clue2_data$Word2Clue2_fastTextz = as.numeric(scale(2-clue2_data$fastTextW2C2, 
                                                 center = TRUE, scale = TRUE))
clue2_data$Word2Clue2_glovez = as.numeric(scale(2-clue2_data$gloveW2C2, 
                                                 center = TRUE, scale = TRUE))


## scaling (3) Clue1-Clue2
clue2_data$Clue1Clue2_Kenettz = as.numeric(scale(clue2_data$K_c1c2, 
                                                 center = TRUE, scale = TRUE))

clue2_data$Clue1Clue2_Undirectedz = as.numeric(scale(clue2_data$U_c1c2, 
                                                 center = TRUE, scale = TRUE))
clue2_data$Clue1Clue2_Directed12z = as.numeric(scale(clue2_data$D1_c1c2, 
                                                 center = TRUE, scale = TRUE))
clue2_data$Clue1Clue2_Directed21z = as.numeric(scale(clue2_data$D2_c1c2, 
                                                 center = TRUE, scale = TRUE))
clue2_data$Clue1Clue2_w2vwikiz = as.numeric(scale(2-clue2_data$word2vecC1C2, 
                                                 center = TRUE, scale = TRUE))
clue2_data$Clue1Clue2_fastTextz = as.numeric(scale(2-clue2_data$fastTextC1C2, 
                                                 center = TRUE, scale = TRUE))
clue2_data$Clue1Clue2_glovez = as.numeric(scale(2-clue2_data$gloveC1C2, 
                                                 center = TRUE, scale = TRUE))

## scaling (4) covariate
clue2_data$ClueAvg_w2vwiki = ((2-clue2_data$word2vecwikiW1C1) + (2-clue2_data$word2vecwikiW2C1))/2

clue2_data$ClueAvg_glove = ((2-clue2_data$gloveW1C1) + (2-clue2_data$gloveW2C1))/2

clue2_data$ClueAvg_fastText = ((2-clue2_data$fastTextW1C1) + (2-clue2_data$fastTextW2C1))/2

## will be standardizing these so that they can be compared on same scale

clue2_data$ClueAvg_Undirectedz = as.numeric(scale(clue2_data$ClueAvg_Undirected, center = TRUE,
                                   scale = TRUE))
clue2_data$ClueAvg_Directed12z = as.numeric(scale(clue2_data$ClueAvg_Directed12, center = TRUE,
                                   scale = TRUE))

clue2_data$ClueAvg_Directed21z = as.numeric(scale(clue2_data$ClueAvg_Directed21, center = TRUE,
                                   scale = TRUE))

clue2_data$ClueAvg_Kenettz = as.numeric(scale(clue2_data$ClueAvg_Kenett, center = TRUE,
                                   scale = TRUE))

clue2_data$ClueAvg_w2vwikiz = as.numeric(scale(clue2_data$ClueAvg_w2vwiki, center = TRUE,
                                   scale = TRUE))

clue2_data$ClueAvg_fastTextz = as.numeric(scale(clue2_data$ClueAvg_fastText, center = TRUE,
                                   scale = TRUE))

clue2_data$ClueAvg_glovez = as.numeric(scale(clue2_data$ClueAvg_glove, center = TRUE,
                                   scale = TRUE))

```

## Segmenting by First Attempt
```{r}
clue2_data_partcorrect_w1 = clue2_data %>% filter(A1PartCorrect == "Word1Correct")
clue2_data_partcorrect_w2 = clue2_data %>% filter(A1PartCorrect == "Word2Correct")
clue2_data_nocorrect = clue2_data %>% filter(A1PartCorrect == "NoCorrect")

clue2_data_partcorrect_w1_complete = clue2_data_partcorrect_w1 %>%
  filter(!is.na(ClueAvg_Undirectedz) & !is.na(Clue1Clue2_Undirectedz) &
         !is.na(Word2Clue2_Undirectedz) & !is.na(Word1Clue2_Undirectedz) & 
           !is.na(ClueAvg_Directed21z) & !is.na(Word1Clue2_Directed21z) &
           !is.na(Clue1Clue2_Directed21z) & !is.na(Word2Clue2_Directed21z))

clue2_data_partcorrect_w2_complete = clue2_data_partcorrect_w2 %>%
  filter(!is.na(ClueAvg_Undirectedz) & !is.na(Clue1Clue2_Undirectedz) &
         !is.na(Word2Clue2_Undirectedz) & !is.na(Word1Clue2_Undirectedz) & 
           !is.na(ClueAvg_Directed21z) & !is.na(Word1Clue2_Directed21z) &
           !is.na(Clue1Clue2_Directed21z) & !is.na(Word2Clue2_Directed21z))

clue2_data_nocorrect_complete = clue2_data_nocorrect %>%
  filter(!is.na(ClueAvg_Undirectedz) & !is.na(Clue1Clue2_Undirectedz) &
         !is.na(Word2Clue2_Undirectedz) & !is.na(Word1Clue2_Undirectedz) & 
           !is.na(ClueAvg_Directed21z) & !is.na(Word1Clue2_Directed21z) &
           !is.na(Clue1Clue2_Directed21z) & !is.na(Word2Clue2_Directed21z))
```

## LMEs

### Undirected

###### w1 correct

```{r}
## predictors are
# (1) Clue2-Word1
# (2) Clue2-Word2
# (3) Clue1-Clue2
# (4) covariate: avg dist of Clue1 to Word1 & Word2: ClueAvg_Model
# (5) covariate: w1w2 ELP and clue1 clue 2 ELP?

## when w1 is correct, clue is closer to w2 and also far from clue1
p2_clue2_acc_model_undirected_w1 = glmer(data = clue2_data_partcorrect_w1_complete, 
                           Player2SecondAnswer.ACC ~ ClueAvg_Undirectedz + 
                             Clue1Clue2_Undirectedz +
                             Word1Clue2_Undirectedz +
                             Word2Clue2_Undirectedz + 
                             (1|Subject) + (1|wordpair),
                          family = "binomial",
                          control=glmerControl(optimizer="bobyqa",
          optCtrl=list(maxfun=100000)))
summary(p2_clue2_acc_model_undirected_w1)
car::Anova(p2_clue2_acc_model_undirected_w1)

predicted_data = expand.grid(ClueAvg_Undirectedz = seq(-2,2,0.5),
                             Clue1Clue2_Undirectedz = seq(-2,2,0.5),
                             Word1Clue2_Undirectedz = seq(-2,2,0.5),
                             Word2Clue2_Undirectedz = seq(-2,2,0.5))

predicted_data$prediction = predict(p2_clue2_acc_model_undirected_w1,
                                    re.form = NA, newdata = predicted_data)


predicted_data$prob =exp(predicted_data$prediction)/(1+exp(predicted_data$prediction))


predicted_data_uc1c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Clue1Clue2_Undirectedz")
colnames(predicted_data_uc1c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_uc1c2$Dtype = "Clue1-Clue2 Distance"

predicted_data_w1c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Word1Clue2_Undirectedz")
colnames(predicted_data_w1c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_w1c2$Dtype = "Word1-Clue2 Distance"


predicted_data_w2c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Word2Clue2_Undirectedz")

colnames(predicted_data_w2c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_w2c2$Dtype = "Word2-Clue2 Distance"



predicted_data_c1avg = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "ClueAvg_Undirectedz")

colnames(predicted_data_c1avg) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_c1avg$Dtype = "Clue1 Average Distance"

final_data = rbind(predicted_data_c1avg, predicted_data_uc1c2,
                   predicted_data_w1c2, predicted_data_w2c2)



final_data %>% 
  ggplot(aes(x = Distance, y = prob, 
             group = Dtype, color = Dtype)) +  
   geom_line(size = 1)+
 theme_few()+
 scale_fill_solarized()+
       xlab("Steps in Undirected Network") + 
  ylab("Accuracy in Second Attempt") + 
  ggtitle("when w1 is correct")  +
   theme(axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))

partmodels = final_data

```

###### w2 correct
```{r}
## when w2 is correct, clue is closer to w1 

p2_clue2_acc_model_undirected_w2 = glmer(data = clue2_data_partcorrect_w2_complete, 
                           Player2SecondAnswer.ACC ~ ClueAvg_Undirectedz + 
                             Clue1Clue2_Undirectedz + 
                             Word1Clue2_Undirectedz +
                             Word2Clue2_Undirectedz + 
                             (1|Subject) + (1|wordpair),
                          family = "binomial",
                          control=glmerControl(optimizer="bobyqa",
          optCtrl=list(maxfun=100000)))
summary(p2_clue2_acc_model_undirected_w2)
car::Anova(p2_clue2_acc_model_undirected_w2)

predicted_data = expand.grid(ClueAvg_Undirectedz = seq(-2,2,0.5),
                             Clue1Clue2_Undirectedz = seq(-2,2,0.5),
                             Word1Clue2_Undirectedz = seq(-2,2,0.5),
                             Word2Clue2_Undirectedz = seq(-2,2,0.5))

predicted_data$prediction = predict(p2_clue2_acc_model_undirected_w2,
                                    re.form = NA, newdata = predicted_data)


predicted_data$prob =exp(predicted_data$prediction)/(1+exp(predicted_data$prediction))

predicted_data_uc1c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Clue1Clue2_Undirectedz")
colnames(predicted_data_uc1c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_uc1c2$Dtype = "Clue1-Clue2 Distance"

predicted_data_w1c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Word1Clue2_Undirectedz")
colnames(predicted_data_w1c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_w1c2$Dtype = "Word1-Clue2 Distance"


predicted_data_w2c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Word2Clue2_Undirectedz")

colnames(predicted_data_w2c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_w2c2$Dtype = "Word2-Clue2 Distance"



predicted_data_c1avg = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "ClueAvg_Undirectedz")

colnames(predicted_data_c1avg) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_c1avg$Dtype = "Clue1 Average Distance"

final_data = rbind(predicted_data_c1avg, predicted_data_uc1c2,
                   predicted_data_w1c2, predicted_data_w2c2)

final_data %>% 
  ggplot(aes(x = Distance, y = prob, 
             group = Dtype, color = Dtype)) +  
   geom_line(size = 1)+
 theme_few()+
 scale_fill_solarized()+
       xlab("Steps in Undirected Network") + 
  ylab("Accuracy in Second Attempt") + 
  ggtitle("when w2 is correct")  +
   theme(axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))

partmodels = rbind(partmodels, final_data)
```

###### no correct
```{r}
## when neither is correct, no clear patterns: small dataset

p2_clue2_acc_model_undirected_nocorrect = glmer(data = clue2_data_nocorrect_complete, 
                           Player2SecondAnswer.ACC ~ ClueAvg_Undirectedz + 
                             Clue1Clue2_Undirectedz +
                             Word1Clue2_Undirectedz +
                             Word2Clue2_Undirectedz + 
                             (1|Subject) + (1|wordpair),
                          family = "binomial",
                          control=glmerControl(optimizer="bobyqa",
          optCtrl=list(maxfun=100000)))
summary(p2_clue2_acc_model_undirected_nocorrect)
car::Anova(p2_clue2_acc_model_undirected_nocorrect)

predicted_data = expand.grid(ClueAvg_Undirectedz = seq(-2,2,0.5),
                             Clue1Clue2_Undirectedz = seq(-2,2,0.5),
                             Word1Clue2_Undirectedz = seq(-2,2,0.5),
                             Word2Clue2_Undirectedz = seq(-2,2,0.5))

predicted_data$prediction = predict(p2_clue2_acc_model_undirected_nocorrect,
                                    re.form = NA, newdata = predicted_data)


predicted_data$prob =exp(predicted_data$prediction)/(1+exp(predicted_data$prediction))

predicted_data_uc1c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Clue1Clue2_Undirectedz")
colnames(predicted_data_uc1c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_uc1c2$Dtype = "Clue1-Clue2 Distance"

predicted_data_w1c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Word1Clue2_Undirectedz")
colnames(predicted_data_w1c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_w1c2$Dtype = "Word1-Clue2 Distance"


predicted_data_w2c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Word2Clue2_Undirectedz")

colnames(predicted_data_w2c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_w2c2$Dtype = "Word2-Clue2 Distance"



predicted_data_c1avg = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "ClueAvg_Undirectedz")

colnames(predicted_data_c1avg) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_c1avg$Dtype = "Clue1 Average Distance"

final_data = rbind(predicted_data_c1avg, predicted_data_uc1c2,
                   predicted_data_w1c2, predicted_data_w2c2)


final_data %>% 
  ggplot(aes(x = Distance, y = prob, 
             group = Dtype, color = Dtype)) +  
   geom_line(size = 1)+
 theme_few()+
 scale_fill_solarized()+
       xlab("Steps in Undirected Network") + 
  ylab("Accuracy in Second Attempt") + 
  ggtitle("no correct")  +
   theme(axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))
partmodels = rbind(partmodels, final_data)


```

### Directed 21

###### w1 correct

```{r}
## when w1 is correct, clue is closer to w2 
library(optimx)
p2_clue2_acc_model_directed21_w1 = glmer(data = clue2_data_partcorrect_w1_complete, 
                           Player2SecondAnswer.ACC ~ ClueAvg_Directed21z + 
                             Clue1Clue2_Directed21z+ 
                             Word1Clue2_Directed21z +
                             Word2Clue2_Directed21z + 
                             (1|Subject) + (1|wordpair),
                          family = "binomial",
                          control = glmerControl(optimizer = "optimx", calc.derivs = FALSE,
     optCtrl = list(method = "nlminb", starttests = FALSE, kkt = FALSE)))
summary(p2_clue2_acc_model_directed21_w1)
car::Anova(p2_clue2_acc_model_directed21_w1)

predicted_data = expand.grid(ClueAvg_Directed21z = seq(-2,2,0.5),
                             Clue1Clue2_Directed21z = seq(-2,2,0.5),
                             Word1Clue2_Directed21z = seq(-2,2,0.5),
                             Word2Clue2_Directed21z = seq(-2,2,0.5))

predicted_data$prediction = predict(p2_clue2_acc_model_directed21_w1,
                                    re.form = NA, newdata = predicted_data)


predicted_data$prob =exp(predicted_data$prediction)/(1+exp(predicted_data$prediction))

predicted_data_uc1c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Clue1Clue2_Directed21z")
colnames(predicted_data_uc1c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_uc1c2$Dtype = "Clue1-Clue2 Distance"

predicted_data_w1c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Word1Clue2_Directed21z")
colnames(predicted_data_w1c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_w1c2$Dtype = "Word1-Clue2 Distance"

predicted_data_w2c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Word2Clue2_Directed21z")
colnames(predicted_data_w2c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_w2c2$Dtype = "Word2-Clue2 Distance"

predicted_data_c1avg = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "ClueAvg_Directed21z")

colnames(predicted_data_c1avg) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_c1avg$Dtype = "Clue1 Average Distance"

final_data = rbind( predicted_data_uc1c2,
                   predicted_data_w1c2,
                   predicted_data_w2c2,
                   predicted_data_c1avg)

final_data %>% 
  ggplot(aes(x = Distance, y = prob, 
             group = Dtype, color = Dtype)) +  
   geom_line(size = 1)+
 theme_few()+
 scale_fill_solarized()+
       xlab("Steps in directed21 Network") + 
  ylab("Accuracy in Second Attempt") + 
  ggtitle("w1 correct")  +
   theme(axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))
partmodels = rbind(partmodels, final_data)

```
###### w2 correct

```{r}
## when w2 is correct, clue is closer to w1 

p2_clue2_acc_model_directed21_w2 = glmer(data = clue2_data_partcorrect_w2_complete, 
                           Player2SecondAnswer.ACC ~ ClueAvg_Directed21z + 
                             Clue1Clue2_Directed21z + 
                             Word1Clue2_Directed21z +
                             Word2Clue2_Directed21z + 
                             (1|Subject) + (1|wordpair),
                          family = "binomial",
                          control = glmerControl(optimizer = "optimx", calc.derivs = FALSE,
     optCtrl = list(method = "nlminb", starttests = FALSE, kkt = FALSE)))
summary(p2_clue2_acc_model_directed21_w2)
car::Anova(p2_clue2_acc_model_directed21_w2)

predicted_data = expand.grid(ClueAvg_Directed21z = seq(-2,2,0.5),
                             Clue1Clue2_Directed21z = seq(-2,2,0.5),
                             Word1Clue2_Directed21z = seq(-2,2,0.5),
                             Word2Clue2_Directed21z = seq(-2,2,0.5))

predicted_data$prediction = predict(p2_clue2_acc_model_directed21_w2,
                                    re.form = NA, newdata = predicted_data)


predicted_data$prob =exp(predicted_data$prediction)/(1+exp(predicted_data$prediction))

predicted_data_uc1c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Clue1Clue2_Directed21z")
colnames(predicted_data_uc1c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_uc1c2$Dtype = "Clue1-Clue2 Distance"

predicted_data_w1c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Word1Clue2_Directed21z")
colnames(predicted_data_w1c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_w1c2$Dtype = "Word1-Clue2 Distance"

predicted_data_w2c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Word2Clue2_Directed21z")
colnames(predicted_data_w2c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_w2c2$Dtype = "Word2-Clue2 Distance"

predicted_data_c1avg = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "ClueAvg_Directed21z")

colnames(predicted_data_c1avg) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_c1avg$Dtype = "Clue1 Average Distance"

final_data = rbind( predicted_data_uc1c2,
                   predicted_data_w1c2,
                   predicted_data_w2c2,
                   predicted_data_c1avg)

final_data %>% 
  ggplot(aes(x = Distance, y = prob, 
             group = Dtype, color = Dtype)) +  
   geom_line(size = 1)+
 theme_few()+
 scale_fill_solarized()+
       xlab("Steps in directed21 Network") + 
  ylab("Accuracy in Second Attempt") + 
  ggtitle("w1 correct")  +
   theme(axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))
partmodels = rbind(partmodels, final_data)

```
###### no correct

```{r}
## when neither is correct, no clear patterns: small dataset

p2_clue2_acc_model_directed21_nocorrect = glmer(data = clue2_data_nocorrect_complete, 
                           Player2SecondAnswer.ACC ~ ClueAvg_Directed21z + 
                             Clue1Clue2_Directed21z + 
                             Word1Clue2_Directed21z +
                             Word2Clue2_Directed21z + 
                             (1|Subject) + (1|wordpair),
                          family = "binomial",
                          control = glmerControl(optimizer = "optimx", calc.derivs = FALSE,
     optCtrl = list(method = "nlminb", starttests = FALSE, kkt = FALSE)))

car::Anova(p2_clue2_acc_model_directed21_nocorrect)

predicted_data = expand.grid(ClueAvg_Directed21z = seq(-2,2,0.5),
                             Clue1Clue2_Directed21z = seq(-2,2,0.5),
                             Word1Clue2_Directed21z = seq(-2,2,0.5),
                             Word2Clue2_Directed21z = seq(-2,2,0.5))

predicted_data$prediction = predict(p2_clue2_acc_model_directed21_nocorrect,
                                    re.form = NA, newdata = predicted_data)


predicted_data$prob =exp(predicted_data$prediction)/(1+exp(predicted_data$prediction))

predicted_data_uc1c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Clue1Clue2_Directed21z")
colnames(predicted_data_uc1c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_uc1c2$Dtype = "Clue1-Clue2 Distance"

predicted_data_w1c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Word1Clue2_Directed21z")
colnames(predicted_data_w1c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_w1c2$Dtype = "Word1-Clue2 Distance"

predicted_data_w2c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Word2Clue2_Directed21z")
colnames(predicted_data_w2c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_w2c2$Dtype = "Word2-Clue2 Distance"

predicted_data_c1avg = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "ClueAvg_Directed21z")

colnames(predicted_data_c1avg) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_c1avg$Dtype = "Clue1 Average Distance"

final_data = rbind( predicted_data_uc1c2,
                   predicted_data_w1c2,
                   predicted_data_w2c2,
                   predicted_data_c1avg)

final_data %>% 
  ggplot(aes(x = Distance, y = prob, 
             group = Dtype, color = Dtype)) +  
   geom_line(size = 1)+
 theme_few()+
 scale_fill_solarized()+
       xlab("Steps in directed21 Network") + 
  ylab("Accuracy in Second Attempt") + 
  ggtitle("w1 correct")  +
   theme(axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))
partmodels = rbind(partmodels, final_data)

```

### Directed 12

###### w1 correct


```{r}
## when w1 is correct, clue is closer to w2 
library(optimx)
p2_clue2_acc_model_directed12_w1 = glmer(data = clue2_data_partcorrect_w1_complete, 
                           Player2SecondAnswer.ACC ~ ClueAvg_Directed12z + 
                             Clue1Clue2_Directed12z + 
                             Word1Clue2_Directed12z +
                             Word2Clue2_Directed12z + 
                             (1|Subject) + (1|wordpair),
                          family = "binomial",
                          control = glmerControl(optimizer = "optimx", calc.derivs = FALSE,
     optCtrl = list(method = "nlminb", starttests = FALSE, kkt = FALSE)))
summary(p2_clue2_acc_model_directed12_w1)
car::Anova(p2_clue2_acc_model_directed12_w1)

predicted_data = expand.grid(ClueAvg_Directed12z = seq(-2,2,0.5),
                             Clue1Clue2_Directed12z = seq(-2,2,0.5),
                             Word1Clue2_Directed12z = seq(-2,2,0.5),
                             Word2Clue2_Directed12z = seq(-2,2,0.5))

predicted_data$prediction = predict(p2_clue2_acc_model_directed12_w1,
                                    re.form = NA, newdata = predicted_data)


predicted_data$prob =exp(predicted_data$prediction)/(1+exp(predicted_data$prediction))

predicted_data_uc1c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Clue1Clue2_Directed12z")
colnames(predicted_data_uc1c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_uc1c2$Dtype = "Clue1-Clue2 Distance"

predicted_data_w1c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Word1Clue2_Directed12z")
colnames(predicted_data_w1c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_w1c2$Dtype = "Word1-Clue2 Distance"

predicted_data_w2c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Word2Clue2_Directed12z")
colnames(predicted_data_w2c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_w2c2$Dtype = "Word2-Clue2 Distance"

predicted_data_c1avg = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "ClueAvg_Directed12z")

colnames(predicted_data_c1avg) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_c1avg$Dtype = "Clue1 Average Distance"

final_data = rbind( predicted_data_uc1c2,
                   predicted_data_w1c2,
                   predicted_data_w2c2,
                   predicted_data_c1avg)

final_data %>% 
  ggplot(aes(x = Distance, y = prob, 
             group = Dtype, color = Dtype)) +  
   geom_line(size = 1)+
 theme_few()+
 scale_fill_solarized()+
       xlab("Steps in directed12 Network") + 
  ylab("Accuracy in Second Attempt") + 
  ggtitle("w1 correct")  +
   theme(axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))
partmodels = rbind(partmodels, final_data)

```
###### w2 correct

```{r}

## when w2 is correct, clue is closer to w1 

p2_clue2_acc_model_directed12_w2 = glmer(data = clue2_data_partcorrect_w2_complete, 
                           Player2SecondAnswer.ACC ~ ClueAvg_Directed12z + 
                             Clue1Clue2_Directed12z+ 
                             Word1Clue2_Directed12z +
                             Word2Clue2_Directed12z + 
                             (1|Subject) + (1|wordpair),
                          family = "binomial",
                          control = glmerControl(optimizer = "optimx", calc.derivs = FALSE,
     optCtrl = list(method = "nlminb", starttests = FALSE, kkt = FALSE)))
summary(p2_clue2_acc_model_directed12_w2)
car::Anova(p2_clue2_acc_model_directed12_w2)

predicted_data = expand.grid(ClueAvg_Directed12z = seq(-2,2,0.5),
                             Clue1Clue2_Directed12z = seq(-2,2,0.5),
                             Word1Clue2_Directed12z = seq(-2,2,0.5),
                             Word2Clue2_Directed12z = seq(-2,2,0.5))

predicted_data$prediction = predict(p2_clue2_acc_model_directed12_w2,
                                    re.form = NA, newdata = predicted_data)


predicted_data$prob =exp(predicted_data$prediction)/(1+exp(predicted_data$prediction))

predicted_data_uc1c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Clue1Clue2_Directed12z")
colnames(predicted_data_uc1c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_uc1c2$Dtype = "Clue1-Clue2 Distance"

predicted_data_w1c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Word1Clue2_Directed12z")
colnames(predicted_data_w1c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_w1c2$Dtype = "Word1-Clue2 Distance"

predicted_data_w2c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Word2Clue2_Directed12z")
colnames(predicted_data_w2c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_w2c2$Dtype = "Word2-Clue2 Distance"

predicted_data_c1avg = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "ClueAvg_Directed12z")

colnames(predicted_data_c1avg) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_c1avg$Dtype = "Clue1 Average Distance"

final_data = rbind( predicted_data_uc1c2,
                   predicted_data_w1c2,
                   predicted_data_w2c2,
                   predicted_data_c1avg)

final_data %>% 
  ggplot(aes(x = Distance, y = prob, 
             group = Dtype, color = Dtype)) +  
   geom_line(size = 1)+
 theme_few()+
 scale_fill_solarized()+
       xlab("Steps in directed12 Network") + 
  ylab("Accuracy in Second Attempt") + 
  ggtitle("w1 correct")  +
   theme(axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))
partmodels = rbind(partmodels, final_data)

```
###### no correct

```{r}
## when neither is correct, no clear patterns: small dataset

p2_clue2_acc_model_directed12_nocorrect = glmer(data = clue2_data_nocorrect_complete, 
                           Player2SecondAnswer.ACC ~ ClueAvg_Directed12z + 
                             Clue1Clue2_Directed12z+ 
                             Word1Clue2_Directed12z +
                             Word2Clue2_Directed12z + 
                             (1|Subject) + (1|wordpair),
                          family = "binomial",
                          control = glmerControl(optimizer = "optimx", calc.derivs = FALSE,
     optCtrl = list(method = "nlminb", starttests = FALSE, kkt = FALSE)))
summary(p2_clue2_acc_model_directed12_nocorrect)
car::Anova(p2_clue2_acc_model_directed12_nocorrect)

predicted_data = expand.grid(ClueAvg_Directed12z = seq(-2,2,0.5),
                             Clue1Clue2_Directed12z = seq(-2,2,0.5),
                             Word1Clue2_Directed12z = seq(-2,2,0.5),
                             Word2Clue2_Directed12z = seq(-2,2,0.5))

predicted_data$prediction = predict(p2_clue2_acc_model_directed12_nocorrect,
                                    re.form = NA, newdata = predicted_data)


predicted_data$prob =exp(predicted_data$prediction)/(1+exp(predicted_data$prediction))

predicted_data_uc1c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Clue1Clue2_Directed12z")
colnames(predicted_data_uc1c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_uc1c2$Dtype = "Clue1-Clue2 Distance"

predicted_data_w1c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Word1Clue2_Directed12z")
colnames(predicted_data_w1c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_w1c2$Dtype = "Word1-Clue2 Distance"

predicted_data_w2c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Word2Clue2_Directed12z")
colnames(predicted_data_w2c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_w2c2$Dtype = "Word2-Clue2 Distance"

predicted_data_c1avg = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "ClueAvg_Directed12z")

colnames(predicted_data_c1avg) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_c1avg$Dtype = "Clue1 Average Distance"

final_data = rbind( predicted_data_uc1c2,
                   predicted_data_w1c2,
                   predicted_data_w2c2,
                   predicted_data_c1avg)

final_data %>% 
  ggplot(aes(x = Distance, y = prob, 
             group = Dtype, color = Dtype)) +  
   geom_line(size = 1)+
 theme_few()+
 scale_fill_solarized()+
       xlab("Steps in directed12 Network") + 
  ylab("Accuracy in Second Attempt") + 
  ggtitle("w1 correct")  +
   theme(axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))
partmodels = rbind(partmodels, final_data)

```

### ACN

###### w1 correct


```{r}
## when w1 is correct, clue is closer to w2 
library(optimx)
p2_clue2_acc_model_acn_w1 = glmer(data = clue2_data_partcorrect_w1_complete, 
                           Player2SecondAnswer.ACC ~ ClueAvg_Kenettz + 
                             Clue1Clue2_Kenettz + 
                             Word1Clue2_Kenettz +
                             Word2Clue2_Kenettz + 
                             (1|Subject) + (1|wordpair),
                          family = "binomial",
                          control=glmerControl(optimizer="bobyqa",
          optCtrl=list(maxfun=100000)))
car::Anova(p2_clue2_acc_model_acn_w1)
summary(p2_clue2_acc_model_acn_w1)
predicted_data = expand.grid(ClueAvg_Kenettz = seq(-2,2,0.5),
                             Clue1Clue2_Kenettz = seq(-2,2,0.5),
                             Word1Clue2_Kenettz = seq(-2,2,0.5),
                             Word2Clue2_Kenettz = seq(-2,2,0.5))

predicted_data$prediction = predict(p2_clue2_acc_model_acn_w1,
                                    re.form = NA, newdata = predicted_data)


predicted_data$prob =exp(predicted_data$prediction)/(1+exp(predicted_data$prediction))

predicted_data_uc1c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Clue1Clue2_Kenettz")
colnames(predicted_data_uc1c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_uc1c2$Dtype = "Clue1-Clue2 Distance"

predicted_data_w1c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Word1Clue2_Kenettz")
colnames(predicted_data_w1c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_w1c2$Dtype = "Word1-Clue2 Distance"

predicted_data_w2c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Word2Clue2_Kenettz")
colnames(predicted_data_w2c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_w2c2$Dtype = "Word2-Clue2 Distance"

predicted_data_c1avg = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "ClueAvg_Kenettz")

colnames(predicted_data_c1avg) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_c1avg$Dtype = "Clue1 Average Distance"

final_data = rbind( predicted_data_uc1c2,
                   predicted_data_w1c2,
                   predicted_data_w2c2,
                   predicted_data_c1avg)

final_data %>% 
  ggplot(aes(x = Distance, y = prob, 
             group = Dtype, color = Dtype)) +  
   geom_line(size = 1)+
 theme_few()+
 scale_fill_solarized()+
       xlab("Steps in Kenett Network") + 
  ylab("Accuracy in Second Attempt") + 
  ggtitle("Player 2 Second Attempt Accuracy")  +
   theme(axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))

partmodels = rbind(partmodels, final_data)


```
###### w2 correct

```{r}
## when w2 is correct, clue is closer to w1 

p2_clue2_acc_model_kenett_w2 = glmer(data = clue2_data_partcorrect_w2_complete, 
                           Player2SecondAnswer.ACC ~ ClueAvg_Kenettz + 
                             Clue1Clue2_Kenettz + Word1Clue2_Kenettz +
                             Word2Clue2_Kenettz + 
                             (1|Subject) + (1|wordpair),
                          family = "binomial",
                          control=glmerControl(optimizer="bobyqa",
          optCtrl=list(maxfun=100000)))
car::Anova(p2_clue2_acc_model_kenett_w2)
summary(p2_clue2_acc_model_kenett_w2)
predicted_data = expand.grid(ClueAvg_Kenettz = seq(-2,2,0.5),
                             Clue1Clue2_Kenettz = seq(-2,2,0.5),
                             Word1Clue2_Kenettz = seq(-2,2,0.5),
                             Word2Clue2_Kenettz = seq(-2,2,0.5))

predicted_data$prediction = predict(p2_clue2_acc_model_kenett_w2,
                                    re.form = NA, newdata = predicted_data)


predicted_data$prob =exp(predicted_data$prediction)/(1+exp(predicted_data$prediction))

predicted_data_uc1c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Clue1Clue2_Kenettz")
colnames(predicted_data_uc1c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_uc1c2$Dtype = "Clue1-Clue2 Distance"

predicted_data_w1c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Word1Clue2_Kenettz")
colnames(predicted_data_w1c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_w1c2$Dtype = "Word1-Clue2 Distance"

predicted_data_w2c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Word2Clue2_Kenettz")
colnames(predicted_data_w2c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_w2c2$Dtype = "Word2-Clue2 Distance"

predicted_data_c1avg = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "ClueAvg_Kenettz")

colnames(predicted_data_c1avg) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_c1avg$Dtype = "Clue1 Average Distance"

final_data = rbind( predicted_data_uc1c2,
                   predicted_data_w1c2,
                   predicted_data_w2c2,
                   predicted_data_c1avg)

final_data %>% 
  ggplot(aes(x = Distance, y = prob, 
             group = Dtype, color = Dtype)) +  
   geom_line(size = 1)+
 theme_few()+
 scale_fill_solarized()+
       xlab("Steps in Kenett Network") + 
  ylab("Accuracy in Second Attempt") + 
  ggtitle("Player 2 Second Attempt Accuracy")  +
   theme(axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))
partmodels = rbind(partmodels, final_data)

```
###### no correct

```{r}
## when neither is correct, no clear patterns: small dataset

p2_clue2_acc_model_kenett_nocorrect = glmer(data = clue2_data_nocorrect_complete, 
                           Player2SecondAnswer.ACC ~ ClueAvg_Kenettz + 
                             Clue1Clue2_Kenettz + Word1Clue2_Kenettz +
                             Word2Clue2_Kenettz + 
                             (1|Subject) + (1|wordpair),
                          family = "binomial",
                          control=glmerControl(optimizer="bobyqa",
          optCtrl=list(maxfun=100000)))
car::Anova(p2_clue2_acc_model_kenett_nocorrect)

predicted_data = expand.grid(ClueAvg_Kenettz = seq(-2,2,0.5),
                             Clue1Clue2_Kenettz = seq(-2,2,0.5),
                             Word1Clue2_Kenettz = seq(-2,2,0.5),
                             Word2Clue2_Kenettz = seq(-2,2,0.5))

predicted_data$prediction = predict(p2_clue2_acc_model_kenett_nocorrect,
                                    re.form = NA, newdata = predicted_data)


predicted_data$prob =exp(predicted_data$prediction)/(1+exp(predicted_data$prediction))

predicted_data_uc1c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Clue1Clue2_Kenettz")
colnames(predicted_data_uc1c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_uc1c2$Dtype = "Clue1-Clue2 Distance"

predicted_data_w1c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Word1Clue2_Kenettz")
colnames(predicted_data_w1c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_w1c2$Dtype = "Word1-Clue2 Distance"

predicted_data_w2c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Word2Clue2_Kenettz")
colnames(predicted_data_w2c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_w2c2$Dtype = "Word2-Clue2 Distance"

predicted_data_c1avg = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "ClueAvg_Kenettz")

colnames(predicted_data_c1avg) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_c1avg$Dtype = "Clue1 Average Distance"

final_data = rbind( predicted_data_uc1c2,
                   predicted_data_w1c2,
                   predicted_data_w2c2,
                   predicted_data_c1avg)

final_data %>% 
  ggplot(aes(x = Distance, y = prob, 
             group = Dtype, color = Dtype)) +  
   geom_line(size = 1)+
 theme_few()+
 scale_fill_solarized()+
       xlab("Steps in Kenett Network") + 
  ylab("Accuracy in Second Attempt") + 
  ggtitle("Player 2 Second Attempt Accuracy")  +
   theme(axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))

partmodels = rbind(partmodels, final_data)

```

### word2vec

###### w1 correct

```{r}
## when w1 is correct, clue is closer to w2 
library(optimx)

p2_clue2_acc_model_word2vec_w1 = glmer(data = clue2_data_partcorrect_w1_complete, 
                           Player2SecondAnswer.ACC ~ ClueAvg_w2vwikiz + 
                             Clue1Clue2_w2vwikiz+ 
                             Word1Clue2_w2vwikiz +
                             Word2Clue2_w2vwikiz + 
                             (1|Subject) + (1|wordpair),
                          family = "binomial",
                          control=glmerControl(optimizer="bobyqa",
          optCtrl=list(maxfun=100000)))
summary(p2_clue2_acc_model_word2vec_w1)
car::Anova(p2_clue2_acc_model_word2vec_w1)

predicted_data = expand.grid(ClueAvg_w2vwikiz = seq(-2,2,0.5),
                             Clue1Clue2_w2vwikiz = seq(-2,2,0.5),
                             Word1Clue2_w2vwikiz = seq(-2,2,0.5),
                             Word2Clue2_w2vwikiz = seq(-2,2,0.5))

predicted_data$prediction = predict(p2_clue2_acc_model_word2vec_w1,
                                    re.form = NA, newdata = predicted_data)


predicted_data$prob =exp(predicted_data$prediction)/(1+exp(predicted_data$prediction))

predicted_data_uc1c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Clue1Clue2_w2vwikiz")
colnames(predicted_data_uc1c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_uc1c2$Dtype = "Clue1-Clue2 Distance"

predicted_data_w1c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Word1Clue2_w2vwikiz")
colnames(predicted_data_w1c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_w1c2$Dtype = "Word1-Clue2 Distance"

predicted_data_w2c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Word2Clue2_w2vwikiz")
colnames(predicted_data_w2c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_w2c2$Dtype = "Word2-Clue2 Distance"


predicted_data_c1avg = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "ClueAvg_w2vwikiz")

colnames(predicted_data_c1avg) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_c1avg$Dtype = "Clue1 Average Distance"

final_data = rbind(predicted_data_uc1c2,
                   predicted_data_w1c2,
                   predicted_data_w2c2,
                   predicted_data_c1avg)

final_data %>% 
  ggplot(aes(x = Distance, y = prob, 
             group = Dtype, color = Dtype)) +  
   geom_line(size = 1)+
 theme_few()+
 scale_fill_solarized()+
       xlab("Steps in Undirected Network") + 
  ylab("Accuracy in Second Attempt") + 
  ggtitle("Player 2 Second Attempt Accuracy")  +
   theme(axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))

partmodels = rbind(partmodels, final_data)

```
###### w2 correct

```{r}
## when w2 is correct, clue is closer to w1 


p2_clue2_acc_model_word2vec_w2 = glmer(data = clue2_data_partcorrect_w2_complete, 
                           Player2SecondAnswer.ACC ~ ClueAvg_w2vwikiz + 
                             Clue1Clue2_w2vwikiz + 
                             Word1Clue2_w2vwikiz +
                             Word2Clue2_w2vwikiz + 
                             (1|Subject) + (1|wordpair),
                          family = "binomial",
                          control=glmerControl(optimizer="bobyqa",
          optCtrl=list(maxfun=100000)))
summary(p2_clue2_acc_model_word2vec_w2)
car::Anova(p2_clue2_acc_model_word2vec_w2)

predicted_data = expand.grid(ClueAvg_w2vwikiz = seq(-2,2,0.5),
                             Clue1Clue2_w2vwikiz = seq(-2,2,0.5),
                             Word1Clue2_w2vwikiz = seq(-2,2,0.5),
                             Word2Clue2_w2vwikiz = seq(-2,2,0.5))

predicted_data$prediction = predict(p2_clue2_acc_model_word2vec_w2,
                                    re.form = NA, newdata = predicted_data)


predicted_data$prob =exp(predicted_data$prediction)/(1+exp(predicted_data$prediction))

predicted_data_uc1c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Clue1Clue2_w2vwikiz")
colnames(predicted_data_uc1c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_uc1c2$Dtype = "Clue1-Clue2 Distance"

predicted_data_w1c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Word1Clue2_w2vwikiz")
colnames(predicted_data_w1c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_w1c2$Dtype = "Word1-Clue2 Distance"

predicted_data_w2c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Word2Clue2_w2vwikiz")
colnames(predicted_data_w2c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_w2c2$Dtype = "Word2-Clue2 Distance"


predicted_data_c1avg = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "ClueAvg_w2vwikiz")

colnames(predicted_data_c1avg) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_c1avg$Dtype = "Clue1 Average Distance"

final_data = rbind(predicted_data_uc1c2,
                   predicted_data_w1c2,
                   predicted_data_w2c2,
                   predicted_data_c1avg)

final_data %>% 
  ggplot(aes(x = Distance, y = prob, 
             group = Dtype, color = Dtype)) +  
   geom_line(size = 1)+
 theme_few()+
 scale_fill_solarized()+
       xlab("Steps in Undirected Network") + 
  ylab("Accuracy in Second Attempt") + 
  ggtitle("Player 2 Second Attempt Accuracy")  +
   theme(axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))
partmodels = rbind(partmodels, final_data)

```
###### no correct

```{r}
## when neither is correct, no clear patterns: small dataset

p2_clue2_acc_model_word2vec_nocorrect = glmer(data = clue2_data_nocorrect_complete, 
                              Player2SecondAnswer.ACC ~ ClueAvg_w2vwikiz + 
                             Clue1Clue2_w2vwikiz + Word1Clue2_w2vwikiz +
                             Word2Clue2_w2vwikiz + 
                             (1|Subject) + (1|wordpair),
                          family = "binomial",
                          control=glmerControl(optimizer="bobyqa",
          optCtrl=list(maxfun=100000)))
summary(p2_clue2_acc_model_word2vec_nocorrect)
car::Anova(p2_clue2_acc_model_word2vec_nocorrect)

predicted_data = expand.grid(ClueAvg_w2vwikiz = seq(-2,2,0.5),
                             Clue1Clue2_w2vwikiz = seq(-2,2,0.5),
                             Word1Clue2_w2vwikiz = seq(-2,2,0.5),
                             Word2Clue2_w2vwikiz = seq(-2,2,0.5))

predicted_data$prediction = predict(p2_clue2_acc_model_word2vec_nocorrect,
                                    re.form = NA, newdata = predicted_data)


predicted_data$prob =exp(predicted_data$prediction)/(1+exp(predicted_data$prediction))

predicted_data_uc1c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Clue1Clue2_w2vwikiz")
colnames(predicted_data_uc1c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_uc1c2$Dtype = "Clue1-Clue2 Distance"

predicted_data_w1c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Word1Clue2_w2vwikiz")
colnames(predicted_data_w1c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_w1c2$Dtype = "Word1-Clue2 Distance"

predicted_data_w2c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Word2Clue2_w2vwikiz")
colnames(predicted_data_w2c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_w2c2$Dtype = "Word2-Clue2 Distance"


predicted_data_c1avg = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "ClueAvg_w2vwikiz")

colnames(predicted_data_c1avg) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_c1avg$Dtype = "Clue1 Average Distance"

final_data = rbind(predicted_data_uc1c2,
                   predicted_data_w1c2,
                   predicted_data_w2c2,
                   predicted_data_c1avg)

final_data %>% 
  ggplot(aes(x = Distance, y = prob, 
             group = Dtype, color = Dtype)) +  
   geom_line(size = 1)+
 theme_few()+
 scale_fill_solarized()+
       xlab("Steps in Undirected Network") + 
  ylab("Accuracy in Second Attempt") + 
  ggtitle("Player 2 Second Attempt Accuracy")  +
   theme(axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))

partmodels = rbind(partmodels, final_data)

```

#### fastText

###### w1 correct

```{r}
## when w1 is correct, clue is closer to w2 
library(optimx)

p2_clue2_acc_model_fastText_w1 = glmer(data = clue2_data_partcorrect_w1_complete, 
                           Player2SecondAnswer.ACC ~ ClueAvg_fastTextz + 
                             Clue1Clue2_fastTextz + Word1Clue2_fastTextz +
                             Word2Clue2_fastTextz + 
                             (1|Subject) + (1|wordpair),
                          family = "binomial",
                          control=glmerControl(optimizer="bobyqa",
          optCtrl=list(maxfun=100000)))
summary(p2_clue2_acc_model_fastText_w1)
car::Anova(p2_clue2_acc_model_fastText_w1)

predicted_data = expand.grid(ClueAvg_fastTextz = seq(-2,2,0.5),
                             Clue1Clue2_fastTextz = seq(-2,2,0.5),
                             Word1Clue2_fastTextz = seq(-2,2,0.5),
                             Word2Clue2_fastTextz = seq(-2,2,0.5))

predicted_data$prediction = predict(p2_clue2_acc_model_fastText_w1,
                                    re.form = NA, newdata = predicted_data)


predicted_data$prob =exp(predicted_data$prediction)/(1+exp(predicted_data$prediction))

predicted_data_uc1c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Clue1Clue2_fastTextz")
colnames(predicted_data_uc1c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_uc1c2$Dtype = "Clue1-Clue2 Distance"

predicted_data_w1c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Word1Clue2_fastTextz")
colnames(predicted_data_w1c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_w1c2$Dtype = "Word1-Clue2 Distance"

predicted_data_w2c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Word2Clue2_fastTextz")
colnames(predicted_data_w2c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_w2c2$Dtype = "Word2-Clue2 Distance"


predicted_data_c1avg = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "ClueAvg_fastTextz")

colnames(predicted_data_c1avg) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_c1avg$Dtype = "Clue1 Average Distance"

final_data = rbind(predicted_data_uc1c2,
                   predicted_data_w1c2,
                   predicted_data_w2c2,
                   predicted_data_c1avg)

final_data %>% 
  ggplot(aes(x = Distance, y = prob, 
             group = Dtype, color = Dtype)) +  
   geom_line(size = 1)+
 theme_few()+
 scale_fill_solarized()+
       xlab("Steps in Undirected Network") + 
  ylab("Accuracy in Second Attempt") + 
  ggtitle("Player 2 Second Attempt Accuracy")  +
   theme(axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))
partmodels = rbind(partmodels, final_data)

```
###### w2 correct

```{r}
## when w1 is correct, clue is closer to w2 
library(optimx)

p2_clue2_acc_model_fastText_w2 = glmer(data = clue2_data_partcorrect_w2_complete, 
                           Player2SecondAnswer.ACC ~ ClueAvg_fastTextz + 
                             Clue1Clue2_fastTextz + Word1Clue2_fastTextz +
                             Word2Clue2_fastTextz + 
                             (1|Subject) + (1|wordpair),
                          family = "binomial",
                          control=glmerControl(optimizer="bobyqa",
          optCtrl=list(maxfun=100000)))
summary(p2_clue2_acc_model_fastText_w2)
car::Anova(p2_clue2_acc_model_fastText_w2)

predicted_data = expand.grid(ClueAvg_fastTextz = seq(-2,2,0.5),
                             Clue1Clue2_fastTextz = seq(-2,2,0.5),
                             Word1Clue2_fastTextz = seq(-2,2,0.5),
                             Word2Clue2_fastTextz = seq(-2,2,0.5))

predicted_data$prediction = predict(p2_clue2_acc_model_fastText_w2,
                                    re.form = NA, newdata = predicted_data)


predicted_data$prob =exp(predicted_data$prediction)/(1+exp(predicted_data$prediction))

predicted_data_uc1c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Clue1Clue2_fastTextz")
colnames(predicted_data_uc1c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_uc1c2$Dtype = "Clue1-Clue2 Distance"

predicted_data_w1c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Word1Clue2_fastTextz")
colnames(predicted_data_w1c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_w1c2$Dtype = "Word1-Clue2 Distance"

predicted_data_w2c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Word2Clue2_fastTextz")
colnames(predicted_data_w2c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_w2c2$Dtype = "Word2-Clue2 Distance"


predicted_data_c1avg = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "ClueAvg_fastTextz")

colnames(predicted_data_c1avg) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_c1avg$Dtype = "Clue1 Average Distance"

final_data = rbind(predicted_data_uc1c2,
                   predicted_data_w1c2,
                   predicted_data_w2c2,
                   predicted_data_c1avg)

final_data %>% 
  ggplot(aes(x = Distance, y = prob, 
             group = Dtype, color = Dtype)) +  
   geom_line(size = 1)+
 theme_few()+
 scale_fill_solarized()+
       xlab("Steps in Undirected Network") + 
  ylab("Accuracy in Second Attempt") + 
  ggtitle("Player 2 Second Attempt Accuracy")  +
   theme(axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))
partmodels = rbind(partmodels, final_data)

```

###### no correct

```{r}
## when w1 is correct, clue is closer to w2 
library(optimx)

p2_clue2_acc_model_fastText_nocorrect = glmer(data = clue2_data_nocorrect_complete, 
                           Player2SecondAnswer.ACC ~ ClueAvg_fastTextz + 
                             Clue1Clue2_fastTextz + Word1Clue2_fastTextz +
                             Word2Clue2_fastTextz + 
                             (1|Subject) + (1|wordpair),
                          family = "binomial",
                          control=glmerControl(optimizer="bobyqa",
          optCtrl=list(maxfun=100000)))

car::Anova(p2_clue2_acc_model_fastText_nocorrect)

predicted_data = expand.grid(ClueAvg_fastTextz = seq(-2,2,0.5),
                             Clue1Clue2_fastTextz = seq(-2,2,0.5),
                             Word1Clue2_fastTextz = seq(-2,2,0.5),
                             Word2Clue2_fastTextz = seq(-2,2,0.5))

predicted_data$prediction = predict(p2_clue2_acc_model_fastText_nocorrect,
                                    re.form = NA, newdata = predicted_data)


predicted_data$prob =exp(predicted_data$prediction)/(1+exp(predicted_data$prediction))

predicted_data_uc1c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Clue1Clue2_fastTextz")
colnames(predicted_data_uc1c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_uc1c2$Dtype = "Clue1-Clue2 Distance"

predicted_data_w1c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Word1Clue2_fastTextz")
colnames(predicted_data_w1c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_w1c2$Dtype = "Word1-Clue2 Distance"

predicted_data_w2c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Word2Clue2_fastTextz")
colnames(predicted_data_w2c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_w2c2$Dtype = "Word2-Clue2 Distance"


predicted_data_c1avg = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "ClueAvg_fastTextz")

colnames(predicted_data_c1avg) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_c1avg$Dtype = "Clue1 Average Distance"

final_data = rbind(predicted_data_uc1c2,
                   predicted_data_w1c2,
                   predicted_data_w2c2,
                   predicted_data_c1avg)

final_data %>% 
  ggplot(aes(x = Distance, y = prob, 
             group = Dtype, color = Dtype)) +  
   geom_line(size = 1)+
 theme_few()+
 scale_fill_solarized()+
       xlab("Steps in Undirected Network") + 
  ylab("Accuracy in Second Attempt") + 
  ggtitle("Player 2 Second Attempt Accuracy")  +
   theme(axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))
partmodels = rbind(partmodels, final_data)

```

### glove

###### w1 correct

```{r}
## when w1 is correct, clue is closer to w2 
library(optimx)

p2_clue2_acc_model_glove_w1 = glmer(data = clue2_data_partcorrect_w1_complete, 
                           Player2SecondAnswer.ACC ~ ClueAvg_glovez + 
                             Clue1Clue2_glovez + 
                             Word1Clue2_glovez +
                             Word2Clue2_glovez + 
                             (1|Subject) + (1|wordpair),
                          family = "binomial",
                          control=glmerControl(optimizer="bobyqa",
          optCtrl=list(maxfun=100000)))
summary(p2_clue2_acc_model_glove_w1)
car::Anova(p2_clue2_acc_model_glove_w1)

predicted_data = expand.grid(ClueAvg_glovez = seq(-2,2,0.5),
                             Clue1Clue2_glovez = seq(-2,2,0.5),
                             Word1Clue2_glovez = seq(-2,2,0.5),
                             Word2Clue2_glovez = seq(-2,2,0.5))

predicted_data$prediction = predict(p2_clue2_acc_model_glove_w1,
                                    re.form = NA, newdata = predicted_data)


predicted_data$prob =exp(predicted_data$prediction)/(1+exp(predicted_data$prediction))

predicted_data_uc1c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Clue1Clue2_glovez")
colnames(predicted_data_uc1c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_uc1c2$Dtype = "Clue1-Clue2 Distance"

predicted_data_w1c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Word1Clue2_glovez")
colnames(predicted_data_w1c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_w1c2$Dtype = "Word1-Clue2 Distance"

predicted_data_w2c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Word2Clue2_glovez")
colnames(predicted_data_w2c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_w2c2$Dtype = "Word2-Clue2 Distance"


predicted_data_c1avg = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "ClueAvg_glovez")

colnames(predicted_data_c1avg) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_c1avg$Dtype = "Clue1 Average Distance"

final_data = rbind(predicted_data_uc1c2,
                   predicted_data_w1c2,
                   predicted_data_w2c2,
                   predicted_data_c1avg)

final_data %>% 
  ggplot(aes(x = Distance, y = prob, 
             group = Dtype, color = Dtype)) +  
   geom_line(size = 1)+
 theme_few()+
 scale_fill_solarized()+
       xlab("Steps in Undirected Network") + 
  ylab("Accuracy in Second Attempt") + 
  ggtitle("Player 2 Second Attempt Accuracy")  +
   theme(axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))
partmodels = rbind(partmodels, final_data)

```

###### w2 correct

```{r}
## when w1 is correct, clue is closer to w2 
library(optimx)

p2_clue2_acc_model_glove_w2 = glmer(data = clue2_data_partcorrect_w2_complete, 
                           Player2SecondAnswer.ACC ~ ClueAvg_glovez + 
                             Clue1Clue2_glovez + 
                             Word1Clue2_glovez +
                             Word2Clue2_glovez + 
                             (1|Subject) + (1|wordpair),
                          family = "binomial",
                          control=glmerControl(optimizer="bobyqa",
          optCtrl=list(maxfun=100000)))
summary(p2_clue2_acc_model_glove_w2)
car::Anova(p2_clue2_acc_model_glove_w2)

predicted_data = expand.grid(ClueAvg_glovez = seq(-2,2,0.5),
                             Clue1Clue2_glovez = seq(-2,2,0.5),
                             Word1Clue2_glovez = seq(-2,2,0.5),
                             Word2Clue2_glovez = seq(-2,2,0.5))

predicted_data$prediction = predict(p2_clue2_acc_model_glove_w2,
                                    re.form = NA, newdata = predicted_data)


predicted_data$prob =exp(predicted_data$prediction)/(1+exp(predicted_data$prediction))

predicted_data_uc1c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Clue1Clue2_glovez")
colnames(predicted_data_uc1c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_uc1c2$Dtype = "Clue1-Clue2 Distance"

predicted_data_w1c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Word1Clue2_glovez")
colnames(predicted_data_w1c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_w1c2$Dtype = "Word1-Clue2 Distance"

predicted_data_w2c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Word2Clue2_glovez")
colnames(predicted_data_w2c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_w2c2$Dtype = "Word2-Clue2 Distance"


predicted_data_c1avg = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "ClueAvg_glovez")

colnames(predicted_data_c1avg) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_c1avg$Dtype = "Clue1 Average Distance"

final_data = rbind(predicted_data_uc1c2,
                   predicted_data_w1c2,
                   predicted_data_w2c2,
                   predicted_data_c1avg)

final_data %>% 
  ggplot(aes(x = Distance, y = prob, 
             group = Dtype, color = Dtype)) +  
   geom_line(size = 1)+
 theme_few()+
 scale_fill_solarized()+
       xlab("Steps in Undirected Network") + 
  ylab("Accuracy in Second Attempt") + 
  ggtitle("Player 2 Second Attempt Accuracy")  +
   theme(axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))
partmodels = rbind(partmodels, final_data)

```

###### no correct

```{r}
## when w1 is correct, clue is closer to w2 
library(optimx)

p2_clue2_acc_model_glove_nocorrect = glmer(data = clue2_data_nocorrect_complete, 
                           Player2SecondAnswer.ACC ~ ClueAvg_glovez + 
                             Clue1Clue2_glovez + Word1Clue2_glovez +
                             Word2Clue2_glovez + 
                             (1|Subject) + (1|wordpair),
                          family = "binomial",
                          control=glmerControl(optimizer="bobyqa",
          optCtrl=list(maxfun=100000)))
summary(p2_clue2_acc_model_glove_nocorrect)
car::Anova(p2_clue2_acc_model_glove_nocorrect)

predicted_data = expand.grid(ClueAvg_glovez = seq(-2,2,0.5),
                             Clue1Clue2_glovez = seq(-2,2,0.5),
                             Word1Clue2_glovez = seq(-2,2,0.5),
                             Word2Clue2_glovez = seq(-2,2,0.5))

predicted_data$prediction = predict(p2_clue2_acc_model_glove_nocorrect,
                                    re.form = NA, newdata = predicted_data)


predicted_data$prob =exp(predicted_data$prediction)/(1+exp(predicted_data$prediction))

predicted_data_uc1c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Clue1Clue2_glovez")
colnames(predicted_data_uc1c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_uc1c2$Dtype = "Clue1-Clue2 Distance"

predicted_data_w1c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Word1Clue2_glovez")
colnames(predicted_data_w1c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_w1c2$Dtype = "Word1-Clue2 Distance"

predicted_data_w2c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Word2Clue2_glovez")
colnames(predicted_data_w2c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_w2c2$Dtype = "Word2-Clue2 Distance"


predicted_data_c1avg = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "ClueAvg_glovez")

colnames(predicted_data_c1avg) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_c1avg$Dtype = "Clue1 Average Distance"

final_data = rbind(predicted_data_uc1c2,
                   predicted_data_w1c2,
                   predicted_data_w2c2,
                   predicted_data_c1avg)

final_data %>% 
  ggplot(aes(x = Distance, y = prob, 
             group = Dtype, color = Dtype)) +  
   geom_line(size = 1)+
 theme_few()+
 scale_fill_solarized()+
       xlab("Steps in Undirected Network") + 
  ylab("Accuracy in Second Attempt") + 
  ggtitle("Player 2 Second Attempt Accuracy")  +
   theme(axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))
partmodels = rbind(partmodels, final_data)

```

### BIC

```{r}
BIC(p2_clue2_acc_model_glove_w1, p2_clue2_acc_model_undirected_w1,
    p2_clue2_acc_model_directed21_w1, p2_clue2_acc_model_word2vec_w1)

BIC(p2_clue2_acc_model_glove_w2, p2_clue2_acc_model_undirected_w2,
    p2_clue2_acc_model_directed21_w2, p2_clue2_acc_model_word2vec_w2)

BIC(p2_clue2_acc_model_glove_nocorrect, p2_clue2_acc_model_undirected_nocorrect,
    p2_clue2_acc_model_directed21_nocorrect, p2_clue2_acc_model_word2vec_nocorrect)
```



### Plot Second Attempt

```{r}

partmodels$Correct = c(rep("W1 Correct", 36), rep("W2 Correct", 36), 
                       rep("No Correct", 36),rep("W1 Correct", 36), rep("W2 Correct", 36), 
                       rep("No Correct", 36),rep("W1 Correct", 36), rep("W2 Correct", 36), 
                       rep("No Correct", 36),rep("W1 Correct", 36), rep("W2 Correct", 36), 
                       rep("No Correct", 36),rep("W1 Correct", 36), rep("W2 Correct", 36), 
                       rep("No Correct", 36),rep("W1 Correct", 36), rep("W2 Correct", 36), 
                       rep("No Correct", 36),rep("W1 Correct", 36), rep("W2 Correct", 36), 
                       rep("No Correct", 36))

partmodels$Model = c(rep("Undirected SDN", 108), rep("Directed 21", 108),
                     rep("Directed 12", 108), rep("ACN", 108), rep("word2vec", 108),
                     rep("fastText", 108), rep("GloVe", 108))


partmodels$DistanceCategory = ifelse(partmodels$Distance < -0.5, "Close", 
                                     ifelse(partmodels$Distance > 0.5, "Far", "Medium"))

partmodels$DistanceCategory = ordered(as.factor(as.character(partmodels$DistanceCategory)), 
                            levels = c("Close", "Medium", "Far"))

## need to exclude one directed model based on predictions
## Directed21 is more sensitive so exclude Directed12

partmodels = partmodels %>% filter(Model != "Directed 12")

partmodels$Model = ifelse(partmodels$Model == "Directed 21", "Directed SDN", 
                          partmodels$Model)

partmodels$Model = ordered(as.factor(partmodels$Model),
                    levels = c("ACN", "Undirected SDN", "Directed SDN",
                               "word2vec", "fastText", "GloVe"))

## E1
collapsed_partmodels = group_by(partmodels, Model, Correct, Dtype, DistanceCategory) %>%
  summarise_at(vars(prob, sd, se, ci),mean)

collapsed_partmodels$Dtype = as.factor(collapsed_partmodels$Dtype)

## only looking at W1C2 and W2C2 
collapsed_partmodels = collapsed_partmodels %>% filter(Dtype %in%
                        c("Word1-Clue2 Distance","Word2-Clue2 Distance"))


collapsed_partmodels_w1 = collapsed_partmodels %>% filter(Correct == "W1 Correct")
collapsed_partmodels_w2 = collapsed_partmodels %>% filter(Correct == "W2 Correct")
collapsed_partmodels_no = collapsed_partmodels %>% filter(Correct == "No Correct")

collapsed_partmodels_w1 %>% filter(Model %in% c("Undirected SDN", 
                            "Directed SDN", "word2vec", "GloVe"))%>%
  ggplot(aes(x = DistanceCategory, y = prob, 
             group = Model , color = Model)) +  
   geom_line(size = 1)+
      geom_ribbon(aes(ymin=prob - ci, ymax=prob + ci), fill = "grey70", color = NA,
                  alpha = 0.3)+
 theme_few()+
 scale_color_solarized()+
  facet_wrap(~Dtype)+
       xlab("Semantic Distance") + 
  ylab("Predicted Accuracy in Second Attempt") + 
  ggtitle("Guessed Word1 Correctly in First Attempt")  +
  theme(axis.text.y = element_text(face = "bold", size = rel(1.2)),
         axis.text.x = element_text(face = "bold", size = rel(1.2)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))

collapsed_partmodels_w2 %>% filter(Model %in% c("Undirected SDN", 
                            "Directed SDN", "word2vec", "GloVe"))%>%
  ggplot(aes(x = DistanceCategory, y = prob, 
             group = Model , color = Model)) +  
   geom_line(size = 1)+
geom_ribbon(aes(ymin=prob - ci, ymax=prob + ci), fill = "grey70", color = NA,
                  alpha = 0.3)+
  theme_few()+
 scale_color_solarized()+
  facet_wrap(~Dtype)+
       xlab("Semantic Distance") + 
  ylab("Predicted Accuracy in Second Attempt") + 
  ggtitle("Guessed Word2 Correctly in First Attempt")  +
  theme(axis.text.y = element_text(face = "bold", size = rel(1.2)),
         axis.text.x = element_text(face = "bold", size = rel(1.2)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))

collapsed_partmodels_no %>% filter(Model %in% c("Undirected SDN", 
                            "Directed SDN", "word2vec", "GloVe"))%>%
  ggplot(aes(x = DistanceCategory, y = prob, 
             group = Model , color = Model)) +  
   geom_line(size = 1)+
geom_ribbon(aes(ymin=prob - ci, ymax=prob + ci), fill = "grey70", color = NA,
                  alpha = 0.3)+
 theme_few()+
 scale_color_solarized()+
  facet_wrap(~Dtype)+
       xlab("Semantic Distance") + 
  ylab("Predicted Accuracy in Second Attempt") + 
  ggtitle("Guessed None Correctly in First Attempt")  +
  theme(axis.text.y = element_text(face = "bold", size = rel(1.2)),
         axis.text.x = element_text(face = "bold", size = rel(1.2)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))
```

## Clue 3

##### P2 Accuracy

```{r}
## does player2's third attempt accuracy depend upon any of these distances, after controlling for clue1 and clue2 distances

clue3_data = clues %>% filter(clues$Clue3 != "")

clue3_data = clues %>% filter(clues$Clue3 %in% nelsonwords$Word)

# clue3_data = clue3_data %>% filter(!is.na(U_c1c3) & !is.na(D1_c1c3) & !is.na(D2_c1c3) &
#                               !is.na(U_c2c3) & !is.na(D1_c2c3) & !is.na(D2_c2c3))

clue3_data$A1PartCorrect = ifelse( (clue3_data$P2A1W1 == 1 & clue3_data$P2A1W2 == 0), 
                                 "Word1Correct", ifelse((clue3_data$P2A1W1 == 0 & clue3_data$P2A1W2 == 1), "Word2Correct", "NoCorrect"))

clue3_data$A2PartCorrect = ifelse( (clue3_data$P2A2W1 == 1 & clue3_data$P2A2W2 == 0), 
                                 "Word1Correct", ifelse((clue3_data$P2A2W1 == 0 & clue3_data$P2A2W2 == 1), "Word2Correct", "NoCorrect"))

#clue3_data = clue3_data %>% filter(!is.na(U_c1c2) & !is.na(D1_c1c2) & !is.na(D2_c1c2))
```

#### Scaling Distances

```{r}
## scaling (1) Clue2-Word1

clue3_data$Word1Clue3_Kenettz = as.numeric(scale(clue3_data$Word1Clue3_Kenett, 
                                                 center = TRUE, scale = TRUE))

clue3_data$Word1Clue3_Undirectedz = as.numeric(scale(clue3_data$Word1Clue3_Undirected, 
                                                 center = TRUE, scale = TRUE))

clue3_data$Word1Clue3_Directed12z = as.numeric(scale(clue3_data$Word1Clue3_Directed12, 
                                                 center = TRUE, scale = TRUE))

clue3_data$Word1Clue3_Directed21z = as.numeric(scale(clue3_data$Word1Clue3_Directed21, 
                                                 center = TRUE, scale = TRUE))
clue3_data$Word1Clue3_w2vwikiz = as.numeric(scale(2-clue3_data$word2vecwikiW1C3, 
                                                 center = TRUE, scale = TRUE))
clue3_data$Word1Clue3_fastTextz = as.numeric(scale(2-clue3_data$fastTextW1C3, 
                                                center = TRUE, scale = TRUE))
clue3_data$Word1Clue3_glovez = as.numeric(scale(2-clue3_data$gloveW1C3, 
                                                 center = TRUE, scale = TRUE))

## scaling (2) Clue2-Word2

clue3_data$Word2Clue3_Kenettz = as.numeric(scale(clue3_data$Word2Clue3_Kenett, 
                                                 center = TRUE, scale = TRUE))

clue3_data$Word2Clue3_Undirectedz = as.numeric(scale(clue3_data$Word2Clue3_Undirected, 
                                                 center = TRUE, scale = TRUE))

clue3_data$Word2Clue3_Directed12z = as.numeric(scale(clue3_data$Word2Clue3_Directed12, 
                                                 center = TRUE, scale = TRUE))

clue3_data$Word2Clue3_Directed21z = as.numeric(scale(clue3_data$Word2Clue3_Directed21, 
                                                 center = TRUE, scale = TRUE))
clue3_data$Word2Clue3_w2vwikiz = as.numeric(scale(2-clue3_data$word2vecwikiW2C3, 
                                                 center = TRUE, scale = TRUE))
clue3_data$Word2Clue3_fastTextz = as.numeric(scale(2-clue3_data$fastTextW2C3, 
                                                 center = TRUE, scale = TRUE))
clue3_data$Word2Clue3_glovez = as.numeric(scale(2-clue3_data$gloveW2C3, 
                                                 center = TRUE, scale = TRUE))


## scaling (3) Clue1-Clue2
clue3_data$Clue1Clue2_Kenettz = as.numeric(scale(clue3_data$K_c1c2, 
                                                 center = TRUE, scale = TRUE))

clue3_data$Clue1Clue2_Undirectedz = as.numeric(scale(clue3_data$U_c1c2, 
                                                 center = TRUE, scale = TRUE))
clue3_data$Clue1Clue2_Directed12z = as.numeric(scale(clue3_data$D1_c1c2, 
                                                 center = TRUE, scale = TRUE))
clue3_data$Clue1Clue2_Directed21z = as.numeric(scale(clue3_data$D2_c1c2, 
                                                 center = TRUE, scale = TRUE))
clue3_data$Clue1Clue2_w2vwikiz = as.numeric(scale(2-clue3_data$word2vecC1C2, 
                                                 center = TRUE, scale = TRUE))
clue3_data$Clue1Clue2_fastTextz = as.numeric(scale(2-clue3_data$fastTextC1C2, 
                                                 center = TRUE, scale = TRUE))
clue3_data$Clue1Clue2_glovez = as.numeric(scale(2-clue3_data$gloveC1C2, 
                                                 center = TRUE, scale = TRUE))

## scaling (4) Clue2-Clue3
clue3_data$Clue3Clue2_Kenettz = as.numeric(scale(clue3_data$K_c2c3, 
                                                 center = TRUE, scale = TRUE))

clue3_data$Clue3Clue2_Undirectedz = as.numeric(scale(clue3_data$U_c2c3, 
                                                 center = TRUE, scale = TRUE))
clue3_data$Clue3Clue2_Directed12z = as.numeric(scale(clue3_data$D1_c2c3, 
                                                 center = TRUE, scale = TRUE))
clue3_data$Clue3Clue2_Directed21z = as.numeric(scale(clue3_data$D2_c2c3, 
                                                 center = TRUE, scale = TRUE))
clue3_data$Clue3Clue2_w2vwikiz = as.numeric(scale(2-clue3_data$word2vecC2C3, 
                                                 center = TRUE, scale = TRUE))
clue3_data$Clue3Clue2_fastTextz = as.numeric(scale(2-clue3_data$fastTextC2C3, 
                                                 center = TRUE, scale = TRUE))
clue3_data$Clue3Clue2_glovez = as.numeric(scale(2-clue3_data$gloveC2C3, 
                                                 center = TRUE, scale = TRUE))

## scaling (3) Clue1-Clue3
clue3_data$Clue1Clue3_Kenettz = as.numeric(scale(clue3_data$K_c1c3, 
                                                 center = TRUE, scale = TRUE))

clue3_data$Clue1Clue3_Undirectedz = as.numeric(scale(clue3_data$U_c1c3, 
                                                 center = TRUE, scale = TRUE))
clue3_data$Clue1Clue3_Directed12z = as.numeric(scale(clue3_data$D1_c1c3, 
                                                 center = TRUE, scale = TRUE))
clue3_data$Clue1Clue3_Directed21z = as.numeric(scale(clue3_data$D2_c1c3, 
                                                 center = TRUE, scale = TRUE))
clue3_data$Clue1Clue3_w2vwikiz = as.numeric(scale(2-clue3_data$word2vecC1C3, 
                                                 center = TRUE, scale = TRUE))
clue3_data$Clue1Clue3_fastTextz = as.numeric(scale(2-clue3_data$fastTextC1C3, 
                                                 center = TRUE, scale = TRUE))
clue3_data$Clue1Clue3_glovez = as.numeric(scale(2-clue3_data$gloveC1C3, 
                                                 center = TRUE, scale = TRUE))

## scaling (4) covariate Clue1Avg
clue3_data$ClueAvg_w2vwiki = ((2-clue3_data$word2vecwikiW1C1) + (2-clue3_data$word2vecwikiW2C1))/2

clue3_data$ClueAvg_glove = ((2-clue3_data$gloveW1C1) + (2-clue3_data$gloveW2C1))/2

clue3_data$ClueAvg_fastText = ((2-clue3_data$fastTextW1C1) + (2-clue3_data$fastTextW2C1))/2

## will be standardizing these so that they can be compared on same scale

clue3_data$ClueAvg_Undirectedz = as.numeric(scale(clue3_data$ClueAvg_Undirected, center = TRUE,
                                   scale = TRUE))
clue3_data$ClueAvg_Directed12z = as.numeric(scale(clue3_data$ClueAvg_Directed12, center = TRUE,
                                   scale = TRUE))

clue3_data$ClueAvg_Directed21z = as.numeric(scale(clue3_data$ClueAvg_Directed21, center = TRUE,
                                   scale = TRUE))

clue3_data$ClueAvg_Kenettz = as.numeric(scale(clue3_data$ClueAvg_Kenett, center = TRUE,
                                   scale = TRUE))

clue3_data$ClueAvg_w2vwikiz = as.numeric(scale(clue3_data$ClueAvg_w2vwiki, center = TRUE,
                                   scale = TRUE))

clue3_data$ClueAvg_fastTextz = as.numeric(scale(clue3_data$ClueAvg_fastText, center = TRUE,
                                   scale = TRUE))

clue3_data$ClueAvg_glovez = as.numeric(scale(clue3_data$ClueAvg_glove, center = TRUE,
                                   scale = TRUE))

## scaling (5) covariate Clue2Avg
clue3_data$Clue2Avg_w2vwiki = ((2-clue3_data$word2vecwikiW1C2) + (2-clue3_data$word2vecwikiW2C2))/2

clue3_data$Clue2Avg_glove = ((2-clue3_data$gloveW1C2) + (2-clue3_data$gloveW2C2))/2

clue3_data$Clue2Avg_fastText = ((2-clue3_data$fastTextW1C2) + (2-clue3_data$fastTextW2C2))/2

clue3_data$Clue2Avg_Undirected = ((clue3_data$Word1Clue2_Undirected) + (clue3_data$Word2Clue2_Undirected))/2

clue3_data$Clue2Avg_Directed = ((clue3_data$Word1Clue2_Directed21) + (clue3_data$Word2Clue2_Directed21))/2

clue3_data$Clue2Avg_Kenett = ((clue3_data$Word1Clue2_Kenett) + (clue3_data$Word2Clue2_Kenett))/2

## will be standardizing these so that they can be compared on same scale

clue3_data$Clue2Avg_Undirectedz = as.numeric(scale(clue3_data$Clue2Avg_Undirected, center = TRUE,
                                   scale = TRUE))
clue3_data$Clue2Avg_Directedz = as.numeric(scale(clue3_data$Clue2Avg_Directed, center = TRUE,
                                   scale = TRUE))
clue3_data$Clue2Avg_Kenettz = as.numeric(scale(clue3_data$Clue2Avg_Kenett, center = TRUE,
                                   scale = TRUE))

clue3_data$Clue2Avg_w2vwikiz = as.numeric(scale(clue3_data$Clue2Avg_w2vwiki, center = TRUE,
                                   scale = TRUE))

clue3_data$Clue2Avg_fastTextz = as.numeric(scale(clue3_data$Clue2Avg_fastText, center = TRUE,
                                   scale = TRUE))

clue3_data$Clue2Avg_glovez = as.numeric(scale(clue3_data$Clue2Avg_glove, center = TRUE,
                                   scale = TRUE))

```

#### Segmenting by Second Attempt
```{r}
clue3_data$wordpair = paste(clue3_data$Word1, "-", clue3_data$Word2)

clue3_data_partcorrect_w1 = clue3_data %>% filter(A2PartCorrect == "Word1Correct")
clue3_data_partcorrect_w2 = clue3_data %>% filter(A2PartCorrect == "Word2Correct")
clue3_data_nocorrect = clue3_data %>% filter(A2PartCorrect == "NoCorrect")


```

#### Undirected

###### w1 correct

```{r}

p2_clue3_acc_model_undirected_w1 = glmer(data = clue3_data_partcorrect_w1, 
                           Player2ThirdAnswer.ACC ~ Clue2Avg_Undirectedz + 
                             Clue3Clue2_Undirectedz + Word1Clue3_Undirectedz +
                             Word2Clue3_Undirectedz + 
                             (1|Subject) + (1|wordpair),
                          family = "binomial",
                          control=glmerControl(optimizer="bobyqa",
          optCtrl=list(maxfun=100000)))
car::Anova(p2_clue3_acc_model_undirected_w1)

predicted_data = expand.grid(Clue2Avg_Undirectedz = seq(-2,2,0.5),
                             Clue3Clue2_Undirectedz = seq(-2,2,0.5),
                             Word1Clue3_Undirectedz = seq(-2,2,0.5),
                             Word2Clue3_Undirectedz = seq(-2,2,0.5))

predicted_data$prediction = predict(p2_clue3_acc_model_undirected_w1,
                                    re.form = NA, newdata = predicted_data)


predicted_data$prob =exp(predicted_data$prediction)/(1+exp(predicted_data$prediction))

predicted_data_uc1c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Clue3Clue2_Undirectedz")
colnames(predicted_data_uc1c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_uc1c2$Dtype = "Clue1-Clue2 Distance"

predicted_data_w1c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Word1Clue3_Undirectedz")
colnames(predicted_data_w1c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_w1c2$Dtype = "Word1-Clue2 Distance"


predicted_data_w2c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Word2Clue3_Undirectedz")

colnames(predicted_data_w2c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_w2c2$Dtype = "Word2-Clue2 Distance"



predicted_data_c1avg = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Clue2Avg_Undirectedz")

colnames(predicted_data_c1avg) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_c1avg$Dtype = "Clue1 Average Distance"

final_data = rbind(predicted_data_c1avg, predicted_data_uc1c2,
                   predicted_data_w1c2, predicted_data_w2c2)



final_data %>% 
  ggplot(aes(x = Distance, y = prob, 
             group = Dtype, color = Dtype)) +  
   geom_line(size = 1)+
 theme_few()+
 scale_fill_solarized()+
       xlab("Steps in Undirected Network") + 
  ylab("Accuracy in Second Attempt") + 
  ggtitle("when w1 is correct")  +
   theme(axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))

partmodelsa3 = final_data

```

###### w2 correct

```{r}

p2_clue3_acc_model_undirected_w2 = glmer(data = clue3_data_partcorrect_w2, 
                           Player2ThirdAnswer.ACC ~ Clue2Avg_Undirectedz + 
                             Clue3Clue2_Undirectedz + Word1Clue3_Undirectedz +
                             Word2Clue3_Undirectedz + 
                             (1|Subject) + (1|wordpair),
                          family = "binomial",
                          control=glmerControl(optimizer="bobyqa",
          optCtrl=list(maxfun=100000)))
car::Anova(p2_clue3_acc_model_undirected_w2)

predicted_data = expand.grid(Clue2Avg_Undirectedz = seq(-2,2,0.5),
                             Clue3Clue2_Undirectedz = seq(-2,2,0.5),
                             Word1Clue3_Undirectedz = seq(-2,2,0.5),
                             Word2Clue3_Undirectedz = seq(-2,2,0.5))

predicted_data$prediction = predict(p2_clue3_acc_model_undirected_w2,
                                    re.form = NA, newdata = predicted_data)


predicted_data$prob =exp(predicted_data$prediction)/(1+exp(predicted_data$prediction))

predicted_data_uc1c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Clue3Clue2_Undirectedz")
colnames(predicted_data_uc1c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_uc1c2$Dtype = "Clue1-Clue2 Distance"

predicted_data_w1c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Word1Clue3_Undirectedz")
colnames(predicted_data_w1c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_w1c2$Dtype = "Word1-Clue2 Distance"


predicted_data_w2c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Word2Clue3_Undirectedz")

colnames(predicted_data_w2c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_w2c2$Dtype = "Word2-Clue2 Distance"



predicted_data_c1avg = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Clue2Avg_Undirectedz")

colnames(predicted_data_c1avg) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_c1avg$Dtype = "Clue1 Average Distance"

final_data = rbind(predicted_data_c1avg, predicted_data_uc1c2,
                   predicted_data_w1c2, predicted_data_w2c2)



final_data %>% 
  ggplot(aes(x = Distance, y = prob, 
             group = Dtype, color = Dtype)) +  
   geom_line(size = 1)+
 theme_few()+
 scale_fill_solarized()+
       xlab("Steps in Undirected Network") + 
  ylab("Accuracy in Second Attempt") + 
  ggtitle("when w1 is correct")  +
   theme(axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))

partmodelsa3 = rbind(partmodelsa3, final_data)

```

##### Directed 21

###### w1 correct

```{r}
## when w1 is correct, clue is closer to w2 
library(optimx)
p2_clue3_acc_model_directed21_w1 = glmer(data = clue3_data_partcorrect_w1, 
                           Player2ThirdAnswer.ACC ~ Clue2Avg_Directedz + 
                             Clue3Clue2_Directed21z + Word1Clue3_Directed21z +
                             Word2Clue3_Directed21z + 
                             (1|Subject) + (1|wordpair),
                          family = "binomial",
                          control = glmerControl(optimizer = "optimx", calc.derivs = FALSE,
     optCtrl = list(method = "nlminb", starttests = FALSE, kkt = FALSE)))

car::Anova(p2_clue3_acc_model_directed21_w1)

predicted_data = expand.grid(Clue2Avg_Directedz = seq(-2,2,0.5),
                             Clue3Clue2_Directed21z = seq(-2,2,0.5),
                             Word1Clue3_Directed21z = seq(-2,2,0.5),
                             Word2Clue3_Directed21z = seq(-2,2,0.5))

predicted_data$prediction = predict(p2_clue3_acc_model_directed21_w1,
                                    re.form = NA, newdata = predicted_data)


predicted_data$prob =exp(predicted_data$prediction)/(1+exp(predicted_data$prediction))

predicted_data_uc1c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Clue3Clue2_Directed21z")
colnames(predicted_data_uc1c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_uc1c2$Dtype = "Clue1-Clue2 Distance"

predicted_data_w1c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Word1Clue3_Directed21z")
colnames(predicted_data_w1c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_w1c2$Dtype = "Word1-Clue2 Distance"

predicted_data_w2c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Word2Clue3_Directed21z")
colnames(predicted_data_w2c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_w2c2$Dtype = "Word2-Clue2 Distance"

predicted_data_c1avg = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Clue2Avg_Directedz")

colnames(predicted_data_c1avg) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_c1avg$Dtype = "Clue1 Average Distance"

final_data = rbind( predicted_data_uc1c2,
                   predicted_data_w1c2,
                   predicted_data_w2c2,
                   predicted_data_c1avg)

final_data %>% 
  ggplot(aes(x = Distance, y = prob, 
             group = Dtype, color = Dtype)) +  
   geom_line(size = 1)+
 theme_few()+
 scale_fill_solarized()+
       xlab("Steps in directed21 Network") + 
  ylab("Accuracy in Second Attempt") + 
  ggtitle("w1 correct")  +
   theme(axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))
partmodelsa3 = rbind(partmodelsa3, final_data)

```

###### w2 correct

```{r}
## when w1 is correct, clue is closer to w2 
library(optimx)
p2_clue3_acc_model_directed21_w2 = glmer(data = clue3_data_partcorrect_w2, 
                           Player2ThirdAnswer.ACC ~ Clue2Avg_Directedz + 
                             Clue3Clue2_Directed21z + Word1Clue3_Directed21z +
                             Word2Clue3_Directed21z + 
                             (1|Subject) + (1|wordpair),
                          family = "binomial",
                          control = glmerControl(optimizer = "optimx", calc.derivs = FALSE,
     optCtrl = list(method = "nlminb", starttests = FALSE, kkt = FALSE)))

car::Anova(p2_clue3_acc_model_directed21_w2)

predicted_data = expand.grid(Clue2Avg_Directedz = seq(-2,2,0.5),
                             Clue3Clue2_Directed21z = seq(-2,2,0.5),
                             Word1Clue3_Directed21z = seq(-2,2,0.5),
                             Word2Clue3_Directed21z = seq(-2,2,0.5))

predicted_data$prediction = predict(p2_clue3_acc_model_directed21_w2,
                                    re.form = NA, newdata = predicted_data)


predicted_data$prob =exp(predicted_data$prediction)/(1+exp(predicted_data$prediction))

predicted_data_uc1c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Clue3Clue2_Directed21z")
colnames(predicted_data_uc1c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_uc1c2$Dtype = "Clue1-Clue2 Distance"

predicted_data_w1c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Word1Clue3_Directed21z")
colnames(predicted_data_w1c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_w1c2$Dtype = "Word1-Clue2 Distance"

predicted_data_w2c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Word2Clue3_Directed21z")
colnames(predicted_data_w2c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_w2c2$Dtype = "Word2-Clue2 Distance"

predicted_data_c1avg = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Clue2Avg_Directedz")

colnames(predicted_data_c1avg) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_c1avg$Dtype = "Clue1 Average Distance"

final_data = rbind( predicted_data_uc1c2,
                   predicted_data_w1c2,
                   predicted_data_w2c2,
                   predicted_data_c1avg)

final_data %>% 
  ggplot(aes(x = Distance, y = prob, 
             group = Dtype, color = Dtype)) +  
   geom_line(size = 1)+
 theme_few()+
 scale_fill_solarized()+
       xlab("Steps in directed21 Network") + 
  ylab("Accuracy in Second Attempt") + 
  ggtitle("w1 correct")  +
   theme(axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))
partmodelsa3 = rbind(partmodelsa3, final_data)

```
##### ACN

###### w1 correct


```{r}
## when w1 is correct, clue is closer to w2 
library(optimx)
p2_clue3_acc_model_acn_w1 = glmer(data = clue3_data_partcorrect_w1, 
                           Player2ThirdAnswer.ACC ~ Clue2Avg_Kenettz + 
                             Clue3Clue2_Kenettz + Word1Clue3_Kenettz +
                             Word2Clue3_Kenettz + 
                             (1|Subject) + (1|wordpair),
                          family = "binomial",
                          control=glmerControl(optimizer="bobyqa",
          optCtrl=list(maxfun=100000)))
car::Anova(p2_clue3_acc_model_acn_w1)

predicted_data = expand.grid(Clue2Avg_Kenettz = seq(-2,2,0.5),
                             Clue3Clue2_Kenettz = seq(-2,2,0.5),
                             Word1Clue3_Kenettz = seq(-2,2,0.5),
                             Word2Clue3_Kenettz = seq(-2,2,0.5))

predicted_data$prediction = predict(p2_clue3_acc_model_acn_w1,
                                    re.form = NA, newdata = predicted_data)


predicted_data$prob =exp(predicted_data$prediction)/(1+exp(predicted_data$prediction))

predicted_data_uc1c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Clue3Clue2_Kenettz")
colnames(predicted_data_uc1c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_uc1c2$Dtype = "Clue1-Clue2 Distance"

predicted_data_w1c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Word1Clue3_Kenettz")
colnames(predicted_data_w1c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_w1c2$Dtype = "Word1-Clue2 Distance"

predicted_data_w2c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Word2Clue3_Kenettz")
colnames(predicted_data_w2c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_w2c2$Dtype = "Word2-Clue2 Distance"

predicted_data_c1avg = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Clue2Avg_Kenettz")

colnames(predicted_data_c1avg) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_c1avg$Dtype = "Clue1 Average Distance"

final_data = rbind( predicted_data_uc1c2,
                   predicted_data_w1c2,
                   predicted_data_w2c2,
                   predicted_data_c1avg)

final_data %>% 
  ggplot(aes(x = Distance, y = prob, 
             group = Dtype, color = Dtype)) +  
   geom_line(size = 1)+
 theme_few()+
 scale_fill_solarized()+
       xlab("Steps in Kenett Network") + 
  ylab("Accuracy in Second Attempt") + 
  ggtitle("Player 2 Second Attempt Accuracy")  +
   theme(axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))

partmodelsa3 = rbind(partmodelsa3, final_data)


```

###### w2 correct


```{r}
## when w1 is correct, clue is closer to w2 
library(optimx)
p2_clue3_acc_model_acn_w2 = glmer(data = clue3_data_partcorrect_w2, 
                           Player2ThirdAnswer.ACC ~ Clue2Avg_Kenettz + 
                             Clue3Clue2_Kenettz + Word1Clue3_Kenettz +
                             Word2Clue3_Kenettz + 
                             (1|Subject) + (1|wordpair),
                          family = "binomial",
                          control=glmerControl(optimizer="bobyqa",
          optCtrl=list(maxfun=100000)))
car::Anova(p2_clue3_acc_model_acn_w2)

predicted_data = expand.grid(Clue2Avg_Kenettz = seq(-2,2,0.5),
                             Clue3Clue2_Kenettz = seq(-2,2,0.5),
                             Word1Clue3_Kenettz = seq(-2,2,0.5),
                             Word2Clue3_Kenettz = seq(-2,2,0.5))

predicted_data$prediction = predict(p2_clue3_acc_model_acn_w2,
                                    re.form = NA, newdata = predicted_data)


predicted_data$prob =exp(predicted_data$prediction)/(1+exp(predicted_data$prediction))

predicted_data_uc1c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Clue3Clue2_Kenettz")
colnames(predicted_data_uc1c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_uc1c2$Dtype = "Clue1-Clue2 Distance"

predicted_data_w1c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Word1Clue3_Kenettz")
colnames(predicted_data_w1c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_w1c2$Dtype = "Word1-Clue2 Distance"

predicted_data_w2c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Word2Clue3_Kenettz")
colnames(predicted_data_w2c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_w2c2$Dtype = "Word2-Clue2 Distance"

predicted_data_c1avg = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Clue2Avg_Kenettz")

colnames(predicted_data_c1avg) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_c1avg$Dtype = "Clue1 Average Distance"

final_data = rbind( predicted_data_uc1c2,
                   predicted_data_w1c2,
                   predicted_data_w2c2,
                   predicted_data_c1avg)

final_data %>% 
  ggplot(aes(x = Distance, y = prob, 
             group = Dtype, color = Dtype)) +  
   geom_line(size = 1)+
 theme_few()+
 scale_fill_solarized()+
       xlab("Steps in Kenett Network") + 
  ylab("Accuracy in Second Attempt") + 
  ggtitle("Player 2 Second Attempt Accuracy")  +
   theme(axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))

partmodelsa3 = rbind(partmodelsa3, final_data)


```

##### word2vec

###### w1 correct

```{r}
## when w1 is correct, clue is closer to w2 
library(optimx)

p2_clue3_acc_model_word2vec_w1 = glmer(data = clue3_data_partcorrect_w1, 
                           Player2ThirdAnswer.ACC ~ Clue2Avg_w2vwikiz + 
                             Clue3Clue2_w2vwikiz + Word1Clue3_w2vwikiz +
                             Word2Clue3_w2vwikiz + 
                             (1|Subject) + (1|wordpair),
                          family = "binomial",
                          control=glmerControl(optimizer="bobyqa",
          optCtrl=list(maxfun=100000)))

car::Anova(p2_clue3_acc_model_word2vec_w1)

predicted_data = expand.grid(Clue2Avg_w2vwikiz = seq(-2,2,0.5),
                             Clue3Clue2_w2vwikiz = seq(-2,2,0.5),
                             Word1Clue3_w2vwikiz = seq(-2,2,0.5),
                             Word2Clue3_w2vwikiz = seq(-2,2,0.5))

predicted_data$prediction = predict(p2_clue3_acc_model_word2vec_w1,
                                    re.form = NA, newdata = predicted_data)


predicted_data$prob =exp(predicted_data$prediction)/(1+exp(predicted_data$prediction))

predicted_data_uc1c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Clue3Clue2_w2vwikiz")
colnames(predicted_data_uc1c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_uc1c2$Dtype = "Clue1-Clue2 Distance"

predicted_data_w1c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Word1Clue3_w2vwikiz")
colnames(predicted_data_w1c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_w1c2$Dtype = "Word1-Clue2 Distance"

predicted_data_w2c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Word2Clue3_w2vwikiz")
colnames(predicted_data_w2c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_w2c2$Dtype = "Word2-Clue2 Distance"


predicted_data_c1avg = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Clue2Avg_w2vwikiz")

colnames(predicted_data_c1avg) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_c1avg$Dtype = "Clue1 Average Distance"

final_data = rbind(predicted_data_uc1c2,
                   predicted_data_w1c2,
                   predicted_data_w2c2,
                   predicted_data_c1avg)

final_data %>% 
  ggplot(aes(x = Distance, y = prob, 
             group = Dtype, color = Dtype)) +  
   geom_line(size = 1)+
 theme_few()+
 scale_fill_solarized()+
       xlab("Steps in Undirected Network") + 
  ylab("Accuracy in Second Attempt") + 
  ggtitle("Player 2 Second Attempt Accuracy")  +
   theme(axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))

partmodelsa3 = rbind(partmodelsa3, final_data)

```

###### w2 correct

```{r}
## when w1 is correct, clue is closer to w2 
library(optimx)

p2_clue3_acc_model_word2vec_w2 = glmer(data = clue3_data_partcorrect_w2, 
                           Player2ThirdAnswer.ACC ~ Clue2Avg_w2vwikiz + 
                             Clue3Clue2_w2vwikiz + Word1Clue3_w2vwikiz +
                             Word2Clue3_w2vwikiz + 
                             (1|Subject) + (1|wordpair),
                          family = "binomial",
                          control=glmerControl(optimizer="bobyqa",
          optCtrl=list(maxfun=100000)))

car::Anova(p2_clue3_acc_model_word2vec_w2)

predicted_data = expand.grid(Clue2Avg_w2vwikiz = seq(-2,2,0.5),
                             Clue3Clue2_w2vwikiz = seq(-2,2,0.5),
                             Word1Clue3_w2vwikiz = seq(-2,2,0.5),
                             Word2Clue3_w2vwikiz = seq(-2,2,0.5))

predicted_data$prediction = predict(p2_clue3_acc_model_word2vec_w2,
                                    re.form = NA, newdata = predicted_data)


predicted_data$prob =exp(predicted_data$prediction)/(1+exp(predicted_data$prediction))

predicted_data_uc1c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Clue3Clue2_w2vwikiz")
colnames(predicted_data_uc1c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_uc1c2$Dtype = "Clue1-Clue2 Distance"

predicted_data_w1c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Word1Clue3_w2vwikiz")
colnames(predicted_data_w1c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_w1c2$Dtype = "Word1-Clue2 Distance"

predicted_data_w2c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Word2Clue3_w2vwikiz")
colnames(predicted_data_w2c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_w2c2$Dtype = "Word2-Clue2 Distance"


predicted_data_c1avg = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Clue2Avg_w2vwikiz")

colnames(predicted_data_c1avg) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_c1avg$Dtype = "Clue1 Average Distance"

final_data = rbind(predicted_data_uc1c2,
                   predicted_data_w1c2,
                   predicted_data_w2c2,
                   predicted_data_c1avg)

final_data %>% 
  ggplot(aes(x = Distance, y = prob, 
             group = Dtype, color = Dtype)) +  
   geom_line(size = 1)+
 theme_few()+
 scale_fill_solarized()+
       xlab("Steps in Undirected Network") + 
  ylab("Accuracy in Second Attempt") + 
  ggtitle("Player 2 Second Attempt Accuracy")  +
   theme(axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))

partmodelsa3 = rbind(partmodelsa3, final_data)

```
##### fastText

###### w1 correct

```{r}
## when w1 is correct, clue is closer to w2 
library(optimx)

p2_clue3_acc_model_fastText_w1 = glmer(data = clue3_data_partcorrect_w1, 
                           Player2ThirdAnswer.ACC ~ Clue2Avg_fastTextz + 
                             Clue3Clue2_fastTextz + Word1Clue3_fastTextz +
                             Word2Clue3_fastTextz + 
                             (1|Subject) + (1|wordpair),
                          family = "binomial",
                          control=glmerControl(optimizer="bobyqa",
          optCtrl=list(maxfun=100000)))

car::Anova(p2_clue3_acc_model_fastText_w1)

predicted_data = expand.grid(Clue2Avg_fastTextz = seq(-2,2,0.5),
                             Clue3Clue2_fastTextz = seq(-2,2,0.5),
                             Word1Clue3_fastTextz = seq(-2,2,0.5),
                             Word2Clue3_fastTextz = seq(-2,2,0.5))

predicted_data$prediction = predict(p2_clue3_acc_model_fastText_w1,
                                    re.form = NA, newdata = predicted_data)


predicted_data$prob =exp(predicted_data$prediction)/(1+exp(predicted_data$prediction))

predicted_data_uc1c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Clue3Clue2_fastTextz")
colnames(predicted_data_uc1c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_uc1c2$Dtype = "Clue1-Clue2 Distance"

predicted_data_w1c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Word1Clue3_fastTextz")
colnames(predicted_data_w1c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_w1c2$Dtype = "Word1-Clue2 Distance"

predicted_data_w2c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Word2Clue3_fastTextz")
colnames(predicted_data_w2c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_w2c2$Dtype = "Word2-Clue2 Distance"


predicted_data_c1avg = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Clue2Avg_fastTextz")

colnames(predicted_data_c1avg) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_c1avg$Dtype = "Clue1 Average Distance"

final_data = rbind(predicted_data_uc1c2,
                   predicted_data_w1c2,
                   predicted_data_w2c2,
                   predicted_data_c1avg)

final_data %>% 
  ggplot(aes(x = Distance, y = prob, 
             group = Dtype, color = Dtype)) +  
   geom_line(size = 1)+
 theme_few()+
 scale_fill_solarized()+
       xlab("Steps in Undirected Network") + 
  ylab("Accuracy in Second Attempt") + 
  ggtitle("Player 2 Second Attempt Accuracy")  +
   theme(axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))
partmodelsa3 = rbind(partmodelsa3, final_data)

```

###### w2 correct

```{r}
## when w1 is correct, clue is closer to w2 
library(optimx)

p2_clue3_acc_model_fastText_w2 = glmer(data = clue3_data_partcorrect_w2, 
                           Player2ThirdAnswer.ACC ~ Clue2Avg_fastTextz + 
                             Clue3Clue2_fastTextz + Word1Clue3_fastTextz +
                             Word2Clue3_fastTextz + 
                             (1|Subject) + (1|wordpair),
                          family = "binomial",
                          control=glmerControl(optimizer="bobyqa",
          optCtrl=list(maxfun=100000)))

car::Anova(p2_clue3_acc_model_fastText_w2)

predicted_data = expand.grid(Clue2Avg_fastTextz = seq(-2,2,0.5),
                             Clue3Clue2_fastTextz = seq(-2,2,0.5),
                             Word1Clue3_fastTextz = seq(-2,2,0.5),
                             Word2Clue3_fastTextz = seq(-2,2,0.5))

predicted_data$prediction = predict(p2_clue3_acc_model_fastText_w2,
                                    re.form = NA, newdata = predicted_data)


predicted_data$prob =exp(predicted_data$prediction)/(1+exp(predicted_data$prediction))

predicted_data_uc1c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Clue3Clue2_fastTextz")
colnames(predicted_data_uc1c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_uc1c2$Dtype = "Clue1-Clue2 Distance"

predicted_data_w1c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Word1Clue3_fastTextz")
colnames(predicted_data_w1c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_w1c2$Dtype = "Word1-Clue2 Distance"

predicted_data_w2c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Word2Clue3_fastTextz")
colnames(predicted_data_w2c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_w2c2$Dtype = "Word2-Clue2 Distance"


predicted_data_c1avg = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Clue2Avg_fastTextz")

colnames(predicted_data_c1avg) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_c1avg$Dtype = "Clue1 Average Distance"

final_data = rbind(predicted_data_uc1c2,
                   predicted_data_w1c2,
                   predicted_data_w2c2,
                   predicted_data_c1avg)

final_data %>% 
  ggplot(aes(x = Distance, y = prob, 
             group = Dtype, color = Dtype)) +  
   geom_line(size = 1)+
 theme_few()+
 scale_fill_solarized()+
       xlab("Steps in Undirected Network") + 
  ylab("Accuracy in Second Attempt") + 
  ggtitle("Player 2 Second Attempt Accuracy")  +
   theme(axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))
partmodelsa3 = rbind(partmodelsa3, final_data)

```
##### glove

###### w1 correct

```{r}
## when w1 is correct, clue is closer to w2 
library(optimx)

p2_clue3_acc_model_glove_w1 = glmer(data = clue3_data_partcorrect_w1, 
                           Player2ThirdAnswer.ACC ~ Clue2Avg_glovez + 
                             Clue3Clue2_glovez + Word1Clue3_glovez +
                             Word2Clue3_glovez + 
                             (1|Subject) + (1|wordpair),
                          family = "binomial",
                          control=glmerControl(optimizer="bobyqa",
          optCtrl=list(maxfun=100000)))

car::Anova(p2_clue3_acc_model_glove_w1)

predicted_data = expand.grid(Clue2Avg_glovez = seq(-2,2,0.5),
                             Clue3Clue2_glovez = seq(-2,2,0.5),
                             Word1Clue3_glovez = seq(-2,2,0.5),
                             Word2Clue3_glovez = seq(-2,2,0.5))

predicted_data$prediction = predict(p2_clue3_acc_model_glove_w1,
                                    re.form = NA, newdata = predicted_data)


predicted_data$prob =exp(predicted_data$prediction)/(1+exp(predicted_data$prediction))

predicted_data_uc1c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Clue3Clue2_glovez")
colnames(predicted_data_uc1c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_uc1c2$Dtype = "Clue1-Clue2 Distance"

predicted_data_w1c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Word1Clue3_glovez")
colnames(predicted_data_w1c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_w1c2$Dtype = "Word1-Clue2 Distance"

predicted_data_w2c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Word2Clue3_glovez")
colnames(predicted_data_w2c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_w2c2$Dtype = "Word2-Clue2 Distance"


predicted_data_c1avg = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Clue2Avg_glovez")

colnames(predicted_data_c1avg) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_c1avg$Dtype = "Clue1 Average Distance"

final_data = rbind(predicted_data_uc1c2,
                   predicted_data_w1c2,
                   predicted_data_w2c2,
                   predicted_data_c1avg)

final_data %>% 
  ggplot(aes(x = Distance, y = prob, 
             group = Dtype, color = Dtype)) +  
   geom_line(size = 1)+
 theme_few()+
 scale_fill_solarized()+
       xlab("Steps in Undirected Network") + 
  ylab("Accuracy in Second Attempt") + 
  ggtitle("Player 2 Second Attempt Accuracy")  +
   theme(axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))
partmodelsa3 = rbind(partmodelsa3, final_data)

```

###### w1 correct

```{r}
## when w1 is correct, clue is closer to w2 
library(optimx)

p2_clue3_acc_model_glove_w2 = glmer(data = clue3_data_partcorrect_w2, 
                           Player2ThirdAnswer.ACC ~ Clue2Avg_glovez + 
                             Clue3Clue2_glovez + Word1Clue3_glovez +
                             Word2Clue3_glovez + 
                             (1|Subject) + (1|wordpair),
                          family = "binomial",
                          control=glmerControl(optimizer="bobyqa",
          optCtrl=list(maxfun=100000)))

car::Anova(p2_clue3_acc_model_glove_w2)

predicted_data = expand.grid(Clue2Avg_glovez = seq(-2,2,0.5),
                             Clue3Clue2_glovez = seq(-2,2,0.5),
                             Word1Clue3_glovez = seq(-2,2,0.5),
                             Word2Clue3_glovez = seq(-2,2,0.5))

predicted_data$prediction = predict(p2_clue3_acc_model_glove_w2,
                                    re.form = NA, newdata = predicted_data)


predicted_data$prob =exp(predicted_data$prediction)/(1+exp(predicted_data$prediction))

predicted_data_uc1c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Clue3Clue2_glovez")
colnames(predicted_data_uc1c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_uc1c2$Dtype = "Clue1-Clue2 Distance"

predicted_data_w1c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Word1Clue3_glovez")
colnames(predicted_data_w1c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_w1c2$Dtype = "Word1-Clue2 Distance"

predicted_data_w2c2 = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Word2Clue3_glovez")
colnames(predicted_data_w2c2) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_w2c2$Dtype = "Word2-Clue2 Distance"


predicted_data_c1avg = Rmisc::summarySE(predicted_data,
                                        measurevar = "prob",
                                        groupvars = "Clue2Avg_glovez")

colnames(predicted_data_c1avg) = c("Distance", "N", "prob", "sd", "se", "ci")
predicted_data_c1avg$Dtype = "Clue1 Average Distance"

final_data = rbind(predicted_data_uc1c2,
                   predicted_data_w1c2,
                   predicted_data_w2c2,
                   predicted_data_c1avg)

final_data %>% 
  ggplot(aes(x = Distance, y = prob, 
             group = Dtype, color = Dtype)) +  
   geom_line(size = 1)+
 theme_few()+
 scale_fill_solarized()+
       xlab("Steps in Undirected Network") + 
  ylab("Accuracy in Second Attempt") + 
  ggtitle("Player 2 Second Attempt Accuracy")  +
   theme(axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))
partmodelsa3 = rbind(partmodelsa3, final_data)

```

#### Plot A2 Part Models

```{r}
#partmodels = read.csv("partcorrect_attempt2models.csv", header = TRUE, sep = ",")

partmodelsa3$Correct = c(rep("W1 Correct", 36), rep("W2 Correct", 36), 
                       rep("W1 Correct", 36), rep("W2 Correct", 36), 
                       rep("W1 Correct", 36), rep("W2 Correct", 36), 
                       rep("W1 Correct", 36), rep("W2 Correct", 36), 
                       rep("W1 Correct", 36), rep("W2 Correct", 36), 
                       rep("W1 Correct", 36), rep("W2 Correct", 36))

partmodelsa3$Model = c(rep("Undirected SDN", 72), rep("Directed SDN", 72),
                      rep("ACN", 72), rep("word2vec", 72),
                     rep("fastText", 72), rep("GloVe", 72))


partmodelsa3$DistanceCategory = ifelse(partmodelsa3$Distance < -0.5, "Close", 
                                     ifelse(partmodelsa3$Distance > 0.5, "Far", "Medium"))

partmodelsa3$DistanceCategory = ordered(as.factor(as.character(partmodelsa3$DistanceCategory)), 
                            levels = c("Close", "Medium", "Far"))

## need to exclude one directed model based on predictions
## Directed21 is more sensitive so exclude Directed12

partmodelsa3$Model = ordered(as.factor(partmodelsa3$Model),
                    levels = c("ACN", "Undirected SDN", "Directed SDN",
                               "word2vec", "fastText", "GloVe"))

## E1
collapsed_partmodelsa3 = group_by(partmodelsa3, Model, Correct, Dtype, DistanceCategory) %>%
  summarise_at(vars(prob, sd, se, ci),mean)

collapsed_partmodelsa3$Dtype = as.factor(collapsed_partmodelsa3$Dtype)

# only looking at W1C2 and W2C2
collapsed_partmodelsa3 = collapsed_partmodelsa3 %>% filter(Dtype %in%
                        c("Word1-Clue2 Distance","Word2-Clue2 Distance"))


a3collapsed_partmodels_w1 = collapsed_partmodelsa3 %>% filter(Correct == "W1 Correct")
a3collapsed_partmodels_w2 = collapsed_partmodelsa3 %>% filter(Correct == "W2 Correct")
a3collapsed_partmodels_no = collapsed_partmodelsa3 %>% filter(Correct == "No Correct")

a3collapsed_partmodels_w1 %>% 
  ggplot(aes(x = DistanceCategory, y = prob, 
             group = Model , color = Model)) +  
   geom_line(size = 1)+
     # geom_ribbon(aes(ymin=prob - ci, ymax=prob + ci), alpha = 0.3)+
 theme_few()+
 scale_color_solarized()+
  facet_wrap(~Dtype)+
       xlab("Semantic Distance") + 
  ylab("Predicted Accuracy in Second Attempt") + 
  ggtitle("Guessed Word1 Correctly in First Attempt")  +
  theme(axis.text.y = element_text(face = "bold", size = rel(1.2)),
         axis.text.x = element_text(face = "bold", size = rel(1.2)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))

a3collapsed_partmodels_w2 %>% 
  ggplot(aes(x = DistanceCategory, y = prob, 
             group = Model , color = Model)) +  
   geom_line(size = 1)+
     # geom_ribbon(aes(ymin=prob - ci, ymax=prob + ci), alpha = 0.3)+
 theme_few()+
 scale_color_solarized()+
  facet_wrap(~Dtype)+
       xlab("Semantic Distance") + 
  ylab("Predicted Accuracy in Second Attempt") + 
  ggtitle("Guessed Word2 Correctly in First Attempt")  +
  theme(axis.text.y = element_text(face = "bold", size = rel(1.2)),
         axis.text.x = element_text(face = "bold", size = rel(1.2)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))
```

# Board Proportions

```{r}
b = read.csv("e1_boarddists.csv", header = TRUE, sep = ",")

b$rev_word2vec = -b$word2vec
b$rev_fastText = -b$fastText
b$rev_glove = -b$glovecosine

b$zword2vec = as.numeric(scale(b$rev_word2vec, center = TRUE, scale = TRUE))
b$zglove = as.numeric(scale(b$rev_glove, center = TRUE, scale = TRUE))
b$zfastText = as.numeric(scale(b$rev_fastText, center = TRUE, scale = TRUE))
b$zUSDN = as.numeric(scale(b$USDN, center = TRUE, scale = TRUE))
b$zDSDN12 = as.numeric(scale(b$DSDN, center = TRUE, scale = TRUE))
b$zDSDN21 = as.numeric(scale(b$DSDN21, center = TRUE, scale = TRUE))
b$zACN = as.numeric(scale(b$ACN, center = TRUE, scale = TRUE))


  
b = b %>% 
  #rowwise will make sure the sum operation will occur on each row
  rowwise() %>% 
  #then a simple sum(..., na.rm=TRUE) is enough to result in what you need
  mutate(sum = sum(zword2vec,zfastText, zglove, zUSDN, zDSDN21, zACN,
                   zDSDN12, na.rm=TRUE))

b$MeanDistance = b$sum/7



b$Board = as.factor(b$Board)
b %>% 
  ggplot(aes(x = MeanDistance, group = Board, fill = Board))+
geom_histogram(binwidth = 0.1)+
 theme_few()+
 # facet_wrap(~Board)+
 #scale_color_solarized()+
       xlab("Semantic Distance") + 
  ylab("Frequency") + 
  ggtitle("Histogram for Standardized Distances in E1")  +
  theme(axis.text.y = element_text(face = "bold", size = rel(1.2)),
         axis.text.x = element_text(face = "bold", size = rel(1.2)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))

 ## we can also split into tertiles now and see proportion of 
## close, med, distant on each board

b$Level = ntile(b$MeanDistance, 3)

b$Distance = ifelse(b$Level == 1, "Close", 
                    ifelse(b$Level == 3, "Distant", "Medium"))


b_boardwise = group_by(b, Board, Level) %>%
  summarise(pairs = n())
b_boardwise$prop = b_boardwise$pairs/190

b_boardwise$Board = as.factor(b_boardwise$Board)
b_boardwise$Level = as.factor(b_boardwise$Level)

b_boardwise %>% 
  mutate(Distance = factor(Level, 
    levels = unique(Level),
                    labels = c("Close","Medium", "Distant")))%>%
  ggplot(aes(x = Board, y = prop, group = Distance, fill = Distance))+
  geom_bar(stat = "identity", position = "dodge", width = 0.7, color= "black")+
 theme_few()+
 #scale_color_solarized()+
       xlab("Board") + 
  ylab("Proportion (of 190 unique combinations)") + 
  ggtitle("E1: Proportion of Close-Medium-Distant Pairs")  +
  theme(axis.text.y = element_text(face = "bold", size = rel(1.2)),
         axis.text.x = element_text(face = "bold", size = rel(1.2)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))



```

# NLP Correlations (E1E2)

```{r}
e1e2_spearman = read.csv("e1e2_spearman.csv", header = TRUE, sep = ",")

e1e2_spearman$w_rank = e1e2_spearman$w_rank - 2
e1e2_spearman$f_rank = e1e2_spearman$f_rank - 2
e1e2_spearman$g_rank = e1e2_spearman$g_rank - 2
## need correlations separately for each word pair

require(plyr)

func_cosines <- function(xx){
  return(expand.grid(COR_glove = cor.test(xx$p_rank,xx$g_rank, method = "kendall")$estimate, 
                     COR_word2vec = cor.test(xx$p_rank,xx$w_rank, method = "kendall")$estimate,
                     COR_fastText = cor.test(xx$p_rank,xx$f_rank, method = "kendall")$estimate))
}

cor_data_e1e2 = ddply(e1e2_spearman, .(Level, wordpair), func_cosines)

mean(cor_data_e1e2$COR_glove)
mean(cor_data_e1e2$COR_word2vec)
mean(cor_data_e1e2$COR_fastText)

cor_data_e1e2_long = gather(cor_data_e1e2, Model, Correlation,
                            COR_glove,COR_word2vec, COR_fastText)

## rmisc

cor_rmisc = Rmisc::summarySE(cor_data_e1e2_long,
                             measurevar = "Correlation",
                             groupvars = "Model")

```

# NLP Freq Correlations

```{r}
e1e2_spearman = read.csv("e1e2_spearman.csv", header = TRUE, sep = ",")

e1e2_spearman$w_rank = e1e2_spearman$w_rank - 2
e1e2_spearman$f_rank = e1e2_spearman$f_rank - 2
e1e2_spearman$g_rank = e1e2_spearman$g_rank - 2
## need correlations separately for each word pair

require(plyr)

## H stands for HAL frequency
## S stands for SUBTLEX frequency
func_cosines_freq <- function(xx){
  return(expand.grid(
    COR_glove = cor.test(xx$p_rank,xx$g_rank, method = "kendall")$estimate, 
    COR_word2vec = cor.test(xx$p_rank,xx$w_rank, method = "kendall")$estimate,
    COR_fastText = cor.test(xx$p_rank,xx$f_rank, method = "kendall")$estimate,
    COR_S_freq_fastText = cor.test(xx$Frequency,xx$f_rank, method = "kendall")$estimate,
  COR_S_freq_glove = cor.test(xx$Frequency,xx$g_rank, method = "kendall")$estimate,
COR_S_freq_word2vec = cor.test(xx$Frequency,xx$w_rank, method = "kendall")$estimate,
COR_S_freq_participant = cor.test(xx$Frequency,xx$p_rank, method = "kendall")$estimate,
COR_H_freq_fastText = cor.test(xx$Log_Freq_HAL,xx$f_rank, method = "kendall")$estimate,
  COR_H_freq_glove = cor.test(xx$Log_Freq_HAL,xx$g_rank, method = "kendall")$estimate,
COR_H_freq_word2vec = cor.test(xx$Log_Freq_HAL,xx$w_rank, method = "kendall")$estimate,
COR_H_freq_participant = cor.test(xx$Log_Freq_HAL,xx$p_rank, method = "kendall")$estimate))
}

cor_freq_data_e1e2 = ddply(e1e2_spearman, .(Level, wordpair), func_cosines_freq)

## getting an average correlation across both sources

cor_freq_data_e1e2$freq_fastText = (cor_freq_data_e1e2$COR_S_freq_fastText + 
  cor_freq_data_e1e2$COR_H_freq_fastText)/2

cor_freq_data_e1e2$freq_glove = (cor_freq_data_e1e2$COR_S_freq_glove + 
  cor_freq_data_e1e2$COR_H_freq_glove)/2

cor_freq_data_e1e2$freq_word2vec = (cor_freq_data_e1e2$COR_S_freq_word2vec + 
  cor_freq_data_e1e2$COR_H_freq_word2vec)/2

cor_freq_data_e1e2$freq_participant = (cor_freq_data_e1e2$COR_S_freq_participant + 
  cor_freq_data_e1e2$COR_H_freq_participant)/2

## getting a difference score
cor_freq_data_e1e2$diff_f_p = cor_freq_data_e1e2$freq_fastText - cor_freq_data_e1e2$freq_participant

cor_freq_data_e1e2$diff_g_p = cor_freq_data_e1e2$freq_glove - cor_freq_data_e1e2$freq_participant

cor_freq_data_e1e2$diff_w_p = cor_freq_data_e1e2$freq_word2vec - cor_freq_data_e1e2$freq_participant

cor_freq_data_e1e2$diff_fastTextrank_participantrank = cor_freq_data_e1e2$COR_fastText - cor_freq_data_e1e2$freq_participant

cor_freq_data_e1e2$diff_gloverank_participantrank = cor_freq_data_e1e2$COR_glove - cor_freq_data_e1e2$freq_participant

cor_freq_data_e1e2$diff_word2vecrank_participantrank = cor_freq_data_e1e2$COR_word2vec - cor_freq_data_e1e2$freq_participant

## mean difference score

mean(cor_freq_data_e1e2$diff_f_p)
mean(cor_freq_data_e1e2$diff_g_p)
mean(cor_freq_data_e1e2$diff_w_p)

t.test(cor_freq_data_e1e2$diff_f_p, cor_freq_data_e1e2$diff_w_p, paired = TRUE)
t.test(cor_freq_data_e1e2$diff_f_p, cor_freq_data_e1e2$diff_g_p, paired = TRUE)
t.test(cor_freq_data_e1e2$diff_g_p, cor_freq_data_e1e2$diff_w_p, paired = TRUE)

cor_freq_data_e1e2_long = gather(cor_freq_data_e1e2, Model, Correlation,
                            COR_S_freq_fastText,COR_S_freq_glove, COR_S_freq_word2vec,
                            COR_S_freq_participant, 
                            COR_H_freq_fastText,COR_H_freq_glove, COR_H_freq_word2vec,
                            COR_H_freq_participant)

cor_freq_data_e1e2_long = cor_freq_data_e1e2_long %>% separate(Model,
                                    into = c("COR", "FreqType", "Freq", "Model"),
                                                               sep = "_") %>%
  select(-COR, -Freq)
## rmisc

cor_freq_rmisc = Rmisc::summarySE(cor_freq_data_e1e2_long,
                             measurevar = "Correlation",
                             groupvars = c("Model"))



```

# NLP SWOW Space
```{r}
## r1 
clues = read.csv("e1_ALLpredictions.csv", header = TRUE, sep = ",")
clues_e2 = read.csv("e2_ALLpredictions.csv", header = TRUE, sep = ",")

r1 = read.csv("R1_main.csv", header = TRUE, sep = ",")
r1_main = as.character(toupper(r1$R1))
clues_main = as.character(unique(clues$Clue1))

## how many of the clues fall within the 10000 limit

sum(clues_main %in% r1_main)/length(clues_main)
clues_main[which(!clues_main %in% r1_main)]

## how many of the board words fall inside the 10000 limit?

e1_word1 = as.character(unique(clues$Word1))
e1_word2 = as.character(unique(clues$Word2))
e2_word1 = as.character(unique(clues_e2$Word1))
e2_word2 = as.character(unique(clues_e2$Word2))

totalwordlist = c(e1_word1, e1_word2, e2_word1, e2_word2)

sum(totalwordlist %in% r1_main)/length(totalwordlist)
totalwordlist[which(!totalwordlist %in% r1_main)]

```

# NLP Top Answer and Distance

```{r}
top = read.csv("e1e2_topanswer.csv", header = TRUE, sep = ",")

top_answer = top[,c(1,4,8,13,18)]
top_answer_long = gather(top_answer, Model, Score, 
                         glove_top_answer_score,word2vec_top_answer_score, 
                         fastText_top_answer_score)

top_answer_rmisc = Rmisc::summarySE(top_answer_long,
                                    measurevar = "Score",
                                    groupvars = "Model")

top$zglove = as.numeric(scale(top$glove_top_dist, center = FALSE, scale = TRUE))
top$zfastText = as.numeric(scale(top$fastText_top_dist, center = FALSE, scale = TRUE))
top$zword2vec = as.numeric(scale(top$word2vec_top_dist, center = FALSE, scale = TRUE))

top_distance = top[,c(1,4,21,22, 23)]
top_distance_long = gather(top_distance, Model, Score, 
                         zglove,zfastText, 
                         zword2vec)

top_distance_rmisc = Rmisc::summarySE(top_distance_long,
                                    measurevar = "Score",
                                    groupvars = "Model")
```

## NLP Guess Score

```{r}

## need to compute average guess score per model
e1_clues = read.csv("e1_ALLpredictions.csv", header = TRUE, sep = ",")
e1_clues$wordpair = paste(e1_clues$Word1, "-", e1_clues$Word2)
e1_score = group_by(e1_clues, wordpair ) %>%
  summarise_at(vars(P2Prediction_w2vwiki,P2Prediction_glove, P2Prediction_fasttext), 
               sum)
e1_score$prop_fastText = e1_score$P2Prediction_fasttext/60
e1_score$prop_w2v = e1_score$P2Prediction_w2vwiki/60
e1_score$prop_glove = e1_score$P2Prediction_glove/60

e1_score_long = gather(e1_score, Model, Score, 
                      prop_fastText, prop_w2v, prop_glove)

e1_score_long$Exp = "E1"
write.csv(e1_score_long, file = "e1_NLP_guess_score.csv", row.names = FALSE)
e1_score_rmisc = Rmisc::summarySE(e1_score_long,
                                    measurevar = "Score",
                                    groupvars = "Model")
```

# NLP Guess Score E1E2

```{r}
e1e2_guess_score = read.csv("e1e2_guess_score.csv", header = TRUE, sep = ",")

e1e2_guess_score_rmisc = Rmisc::summarySE(e1e2_guess_score,
                                    measurevar = "Score",
                                    groupvars = "Model")
```

# NLP Attempt 2 Spearman

```{r}


e1e2_spearman = read.csv("e1_secondclues_spearman.csv", header = TRUE, sep = ",")

e1e2_spearman_w1 = e1e2_spearman %>% filter(A1PartCorrect == "Word1_Incorrect") %>%
  filter(!wordpair %in% c("GIGGLE - ABNORMAL", "HEAVY - FEATHER", "TEA - BEAN"))

e1e2_spearman_w2 = e1e2_spearman %>% filter(A1PartCorrect == "Word2_Incorrect") %>%
    filter(!wordpair %in% c("BIRDS - AIRCRAFT", "EXAM - ALGEBRA", "HOMELESS - APARTMENT",
                            "HUNDRED - ECONOMY", "NEAR - ASTRONAUT"))
e1e2_spearman_w1 = e1e2_spearman_w1[complete.cases(e1e2_spearman_w1),]
e1e2_spearman_w2 = e1e2_spearman_w2[complete.cases(e1e2_spearman_w2),]
## need correlations separately for each word pair

require(plyr)

func_cosines <- function(xx){
  return(expand.grid(COR_glove = cor.test(xx$p_rank,xx$g_rank, method = "kendall")$estimate, 
                     COR_word2vec = cor.test(xx$p_rank,xx$w_rank, method = "kendall")$estimate,
                     COR_fastText = cor.test(xx$p_rank,xx$f_rank, method = "kendall")$estimate))
}

cor_data_W1 = ddply(e1e2_spearman_w1, .(wordpair), func_cosines)
cor_data_W2 = ddply(e1e2_spearman_w2, .(wordpair), func_cosines)


cor_data_e1e2_W1 = gather(cor_data_W1, Model, Correlation,
                            COR_glove,COR_word2vec, COR_fastText)

cor_data_e1e2_W2 = gather(cor_data_W2, Model, Correlation,
                            COR_glove,COR_word2vec, COR_fastText)

## rmisc

cor_rmisc_W1 = Rmisc::summarySE(cor_data_e1e2_W1,
                             measurevar = "Correlation",
                             groupvars = "Model", na.rm = TRUE)

cor_rmisc_W2 = Rmisc::summarySE(cor_data_e1e2_W2,
                             measurevar = "Correlation",
                             groupvars = "Model", na.rm = TRUE)

```

# NLP E1E2 Attempt 2 Spearman

#### Clue 2 Frequency Data

```{r}

# clues = read.csv("e1_ALLpredictions.csv", header = TRUE, sep = ",")
# clue2_data = clues %>% filter(Player2.ACC == 0)
# #clue2_data = clues %>% filter(clues$Clue2 != "")
# clue2_data$A1PartCorrect = ifelse( (clue2_data$P2A1W1 == 1 & clue2_data$P2A1W2 == 0),
#                                  "Word1_Correct", ifelse((clue2_data$P2A1W1 == 0 & clue2_data$P2A1W2 == 1), "Word2_Correct", "NoCorrect"))
# 
# clue2_data$A2PartCorrect = ifelse( (clue2_data$P2A2W1 == 1 & clue2_data$P2A2W2 == 0),
#                                  "Word1_Correct", ifelse((clue2_data$P2A2W1 == 0 & clue2_data$P2A2W2 == 1), "Word2_Correct", "NoCorrect"))
# 
# #clue2_data = clue2_data %>% filter(!is.na(U_c1c2) & !is.na(D1_c1c2) & !is.na(D2_c1c2))
# clue2_data$wordpair = paste(clue2_data$Word1, "-", clue2_data$Word2)
# 
# c_clue2_popularity = group_by(clue2_data, Level, wordpair, A1PartCorrect, Clue2 ) %>%
#   dplyr::summarise(Number = n())
# 
# c_clue2_popularity = c_clue2_popularity%>% arrange(wordpair, A1PartCorrect, desc(Number))
```


```{r}


e1e2_spearman = read.csv("e1e2_secondclues_spearman.csv", header = TRUE, sep = ",")

e1e2_spearman_w1 = e1e2_spearman %>% filter(A1PartCorrect == "Word1_Incorrect") %>%
  filter(!wordpair %in% c("GIGGLE - ABNORMAL", "HEAVY - FEATHER", "TEA - BEAN",
                          "ARMY - DRUM", "GOLD - SILVER", "HAPPY - SAD",
                          "HOLY - KIND", "JUMP - LEAP", 
                          "LION - TIGER", "OLD - NEW", "OLIVE - REAL", 
                          "RUDE - REGRET"))

e1e2_spearman_w2 = e1e2_spearman %>% filter(A1PartCorrect == "Word2_Incorrect") %>%
    filter(!wordpair %in% c("BIRDS - AIRCRAFT", "EXAM - ALGEBRA", "HOMELESS - APARTMENT",
                            "HUNDRED - ECONOMY", "NEAR - ASTRONAUT",
                            "CAVE - KNIGHT", "CRUST - BOOT", "FEET - CHAPEL",
                            "GOLD - SILVER", "HAND - BIRTH", "HAPPY - SAD",
                            "JUMP - LEAP", "TEETH - GUMS", "WEIRD - TRAUMA"))
e1e2_spearman_w1 = e1e2_spearman_w1[complete.cases(e1e2_spearman_w1),]
e1e2_spearman_w2 = e1e2_spearman_w2[complete.cases(e1e2_spearman_w2),]
## need correlations separately for each word pair

require(plyr)

func_cosines <- function(xx){
  return(expand.grid(COR_glove = cor.test(xx$p_rank,xx$g_rank, method = "kendall")$estimate, 
                     COR_word2vec = cor.test(xx$p_rank,xx$w_rank, method = "kendall")$estimate,
                     COR_fastText = cor.test(xx$p_rank,xx$f_rank, method = "kendall")$estimate))
}

cor_data_W1 = ddply(e1e2_spearman_w1, .(wordpair), func_cosines)
cor_data_W2 = ddply(e1e2_spearman_w2, .(wordpair), func_cosines)


cor_data_e1e2_W1 = gather(cor_data_W1, Model, Correlation,
                            COR_glove,COR_word2vec, COR_fastText)

cor_data_e1e2_W2 = gather(cor_data_W2, Model, Correlation,
                            COR_glove,COR_word2vec, COR_fastText)

cor_data_e1e2_comb = rbind(cor_data_e1e2_W2, cor_data_e1e2_W1)
## rmisc

cor_rmisc_W1 = Rmisc::summarySE(cor_data_e1e2_W1,
                             measurevar = "Correlation",
                             groupvars = "Model", na.rm = TRUE)

cor_rmisc_W2 = Rmisc::summarySE(cor_data_e1e2_W2,
                             measurevar = "Correlation",
                             groupvars = "Model", na.rm = TRUE)

cor_rmisc_comb = Rmisc::summarySE(cor_data_e1e2_comb,
                             measurevar = "Correlation",
                             groupvars = "Model", na.rm = TRUE)

```


# NLP E1E2 Attempt 2 Top Answer and Distance

```{r}
top = read.csv("e1e2_secondclue_top_final.csv", header = TRUE, sep = ",")

top_answer = top[,c(3,8, 9,16, 17,24, 25)]
top_answer_long = gather(top_answer, Model, Score, 
                         w1_word2vec_score,w2_word2vec_score, 
                         w1_fastText_score, w2_fastText_score,
                         w1_glove_score, w2_glove_score) %>% arrange(pair) %>%
  separate(Model, into = c("Incorrect", "Model", "ScoreCol"), sep = "_") %>% select(-ScoreCol)

top_answer_rmisc = Rmisc::summarySE(top_answer_long,
                                    measurevar = "Score",
                                    groupvars = c("Incorrect", "Model"))

top_answer_rmisc_comb = Rmisc::summarySE(top_answer_long,
                                    measurevar = "Score",
                                    groupvars = c("Model"))

## scaling all distances

top$zglove_mw1_pw1 = as.numeric(scale(top$mw1_pw1_glove_top_dist, center = FALSE, scale = TRUE))
top$zglove_mw1_pw2 = as.numeric(scale(top$mw1_pw2_glove_top_dist, center = FALSE, scale = TRUE))
top$zglove_mw2_pw1 = as.numeric(scale(top$mw2_pw1_glove_top_dist, center = FALSE, scale = TRUE))
top$zglove_mw2_pw2 = as.numeric(scale(top$mw2_pw2_glove_top_dist, center = FALSE, scale = TRUE))

top$zfastText_mw1_pw1 = as.numeric(scale(top$mw1_pw1_fastText_top_dist, center = FALSE, scale = TRUE))
top$zfastText_mw1_pw2 = as.numeric(scale(top$mw1_pw2_fastText_top_dist, center = FALSE, scale = TRUE))
top$zfastText_mw2_pw1 = as.numeric(scale(top$mw2_pw1_fastText_top_dist, center = FALSE, scale = TRUE))
top$zfastText_mw2_pw2 = as.numeric(scale(top$mw2_pw2_fastText_top_dist, center = FALSE, scale = TRUE))

top$zword2vec_mw1_pw1 = as.numeric(scale(top$mw1_pw1_word2vec_top_dist, center = FALSE, scale = TRUE))
top$zword2vec_mw1_pw2 = as.numeric(scale(top$mw1_pw2_word2vec_top_dist, center = FALSE, scale = TRUE))
top$zword2vec_mw2_pw1 = as.numeric(scale(top$mw2_pw1_word2vec_top_dist, center = FALSE, scale = TRUE))
top$zword2vec_mw2_pw2 = as.numeric(scale(top$mw2_pw2_word2vec_top_dist, center = FALSE, scale = TRUE))



top$zglove_mw1_pw1 = as.numeric(scale(top$zglove_mw1_pw1, center = FALSE, scale = TRUE))
top$zglove_mw1_pw2 = as.numeric(scale(top$zglove_mw1_pw2, center = FALSE, scale = TRUE))
top$zglove_mw2_pw1 = as.numeric(scale(top$zglove_mw2_pw1, center = FALSE, scale = TRUE))
top$zglove_mw2_pw2 = as.numeric(scale(top$zglove_mw2_pw2, center = FALSE, scale = TRUE))

top$zfastText_mw1_pw1 = as.numeric(scale(top$zfastText_mw1_pw1, center = FALSE, scale = TRUE))
top$zfastText_mw1_pw2 = as.numeric(scale(top$zfastText_mw1_pw2, center = FALSE, scale = TRUE))
top$zfastText_mw2_pw1 = as.numeric(scale(top$zfastText_mw2_pw1, center = FALSE, scale = TRUE))
top$zfastText_mw2_pw2 = as.numeric(scale(top$zfastText_mw2_pw2, center = FALSE, scale = TRUE))


top$zword2vec_mw1_pw1 = as.numeric(scale(top$zword2vec_mw1_pw1, center = FALSE, scale = TRUE))
top$zword2vec_mw1_pw2 = as.numeric(scale(top$zword2vec_mw1_pw2, center = FALSE, scale = TRUE))
top$zword2vec_mw2_pw1 = as.numeric(scale(top$zword2vec_mw2_pw1, center = FALSE, scale = TRUE))
top$zword2vec_mw2_pw2 = as.numeric(scale(top$zword2vec_mw2_pw2, center = FALSE, scale = TRUE))

top_distance = top[,c(3,30:41)]
top_distance_long = gather(top_distance, Model, Distance, 
                         zglove_mw1_pw1,zglove_mw1_pw2, 
                         zglove_mw2_pw1, zglove_mw2_pw2,
                         zfastText_mw1_pw1,zfastText_mw1_pw2, 
                         zfastText_mw2_pw1, zfastText_mw2_pw2,
                         zword2vec_mw1_pw1,zword2vec_mw1_pw2, 
                         zword2vec_mw2_pw1, zword2vec_mw2_pw2) %>% 
  separate(Model, into = c("Model", "ModelWord", "ParticipantWord"), sep = "_")

top_distance_rmisc = Rmisc::summarySE(top_distance_long,
                                    measurevar = "Distance",
                                    groupvars = c("Model", "ModelWord", "ParticipantWord"),
                                    na.rm = TRUE)
```

# Old Code

#### Clue 1 z-RT Multiple
```{r}
# does average distance from models predict how long player 1 took to come up with the clue?

p1_clue_lm_RT = lmer(data = new_c_z, 
                        zP1_final ~ w1w2_Undirectedz +w1w2_Directed12z +
                     w1w2_Kenettz + w1w2_w2vwikiz + w1w2_glovez +
                       w1w2_fastTextz+
                           (1|Subject) + (1|wordpair),
                          control=lmerControl(optimizer="bobyqa",
          optCtrl=list(maxfun=10000000), 
          check.conv.singular = .makeCC(action = "message",  tol = 2000000)))
summary(p1_clue_lm_RT)
car::Anova(p1_clue_lm_RT)
CI = as.data.frame(confint(p1_clue_lm_RT))
```
##### Plotting Clue 1 z-rt

```{r}
predict_data = matrix(NA, nrow = 6, ncol = 4)
colnames(predict_data) = c("Representation" , "beta", "lower", "upper")
predict_data = as.data.frame(predict_data)
predict_data$beta = fixef(p1_clue_lm_RT)[2:7]
predict_data$lower = CI[5:10, 1]
predict_data$upper = CI[5:10, 2]
predict_data$Representation = c("Undirected SDN", "Directed SDN", 
                       "ACN", "word2vec", "GloVe", "fastText")


predict_data %>% 
  ggplot(aes(x = Representation , y = beta, 
             group = Representation, fill = Representation)) + 
geom_bar(stat = "identity", position = "dodge", width = 0.7, 
         color= "black")+
 geom_errorbar(aes(ymin=lower, ymax=upper), 
             width=.2, color = "gray26", 
             position = position_dodge(0.7))+ theme_few()+
 scale_fill_solarized()+
 # facet_wrap(~subject)+
    xlab("Semantic Model") + ylab("beta weight") + 
  ggtitle("Multiple Regression Predicting Clue Master's z-RTs to generate Clue 1")  +
   theme(axis.text.x = element_blank(),
         axis.text.x.top = element_blank(),
     axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))
```


## Guesser Prediction Score

### Strict

```{r}

c_valid = new_c_z %>% filter(! is.na(Word1Clue1_Undirected))

## proportion of correct predictions 


mean_pred_score = group_by(c_valid, wordpair) %>% ## decide on wordpair vs. subject here
  summarise_at(vars(P2_USDN_NoPartialScore,
                    P2_DSDN12_NoPartialScore,
                    P2_ACN_NoPartialScore,
                    P2Prediction_w2vwiki,
                    P2Prediction_glove, 
                    P2Prediction_fasttext,
                    word2vec_num_nopartialscore,
                    fastText_num_nopartialscore,
                    glove_num_nopartialscore), sum)

p2_acc_long_strict =mean_pred_score %>%
 gather(Rep, PredictionScore, P2_ACN_NoPartialScore,
                    P2_USDN_NoPartialScore,
                    P2_DSDN12_NoPartialScore,
                    P2Prediction_w2vwiki,
                    P2Prediction_fasttext,
        P2Prediction_glove, word2vec_num_nopartialscore,
                    fastText_num_nopartialscore,
                    glove_num_nopartialscore
)

# 30 word pairs total, times 2 = 60

p2_acc_long_strict$prop = p2_acc_long_strict$PredictionScore/60

p2_acc_long_strict$Rep = ordered(as.factor(as.character(p2_acc_long_strict$Rep)), 
                             levels = c("P2_ACN_NoPartialScore", 
                                        "P2_USDN_NoPartialScore",
                                        "P2_DSDN12_NoPartialScore",
                                        "P2Prediction_w2vwiki",
                                        "P2Prediction_fasttext",
                                        "P2Prediction_glove",
                                        "word2vec_num_nopartialscore",
                    "fastText_num_nopartialscore",
                    "glove_num_nopartialscore"))

p2_acc_long_strict = p2_acc_long_strict %>% 
  mutate(Model = factor(Rep, 
    levels = unique(Rep),
                    labels = c("ACN","Undirected SDN", "Directed SDN",
                                         "word2vec",
                                        "fastText", "GloVe")))

## LME

contrasts(p2_acc_long_strict$Model) = contr.treatment(6, base = 4)

p2_acc_long_lme_strict = lmerTest::lmer(data = p2_acc_long_strict, 
                                 prop ~ Model + (1|Subject))
summary(p2_acc_long_lme_strict)
car::Anova(p2_acc_long_lme_strict)

p2_acc_rmisc_strict = Rmisc::summarySE(p2_acc_long_strict,
                                measurevar = "prop",
                                groupvars = c("Rep"))

p2_acc_rmisc_strict %>% 
  ggplot(aes(x = Model, y = prop, 
             group = Model, fill = Model)) + 
   geom_bar(stat = "identity", position = "dodge", width = 0.7, color= "black")+
 geom_errorbar(aes(ymin=prop - se, ymax=prop + se), 
             width=.1, color = "gray26", 
             position = position_dodge(0.7))+
 theme_few()+
 scale_fill_solarized()+
       xlab("Semantic Model") + ylab("Average Score (Proportion Out of 60)") + 
  ggtitle("Model Accuracy in Predicting Guesser's First Guesses \n based on Clue Master's First Clue")  +
   theme(axis.ticks.x = element_blank(),
     axis.text.x = element_blank(),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))
p2_acc_rmisc_strict$Scoring = "Strict Scoring"
p2_acc_long_strict$Scoring = "Strict Scoring"
```

### Lenient

```{r}

c_valid = new_c_z %>% filter(! is.na(Word1Clue1_Undirected))

## proportion of correct predictions 

mean_pred_score = group_by(c_valid, wordpair) %>%
  summarise_at(vars(P2_USDN_FullCredit,
                    P2_DSDN12_FullCredit,
                    P2_ACN_FullCredit,
                    P2Prediction_w2vwiki,
                    P2Prediction_glove, 
                    P2Prediction_fasttext,
                    word2vec_num_fullcredit,
                    fastText_num_fullcredit,
                    glove_num_fullcredit), sum)

p2_acc_long_lenient =mean_pred_score %>%
 gather(Rep, PredictionScore, P2_ACN_FullCredit,
                    P2_USDN_FullCredit,
                    P2_DSDN12_FullCredit,
                    P2Prediction_w2vwiki,
                    P2Prediction_fasttext,
        P2Prediction_glove, word2vec_num_fullcredit,
                    fastText_num_fullcredit,
                    glove_num_fullcredit
        
)

# 30 word pairs total, times 2 = 60

p2_acc_long_lenient$prop = p2_acc_long_lenient$PredictionScore/60

p2_acc_long_lenient$Rep = ordered(as.factor(as.character(p2_acc_long_lenient$Rep)), 
                             levels = c("P2_ACN_FullCredit", 
                                        "P2_USDN_FullCredit",
                                        "P2_DSDN12_FullCredit",
                                        "P2Prediction_w2vwiki",
                                        "P2Prediction_fasttext",
                                        "P2Prediction_glove"))

p2_acc_long_lenient = p2_acc_long_lenient %>% 
  mutate(Model = factor(Rep, 
    levels = unique(Rep),
                    labels = c("ACN","Undirected SDN", "Directed SDN",
                                         "word2vec",
                                        "fastText", "GloVe")))

## LME

contrasts(p2_acc_long_lenient$Model) = contr.treatment(6, base = 2)

p2_acc_long_lme_lenient = lmerTest::lmer(data = p2_acc_long_lenient, 
                                 prop ~ Model + (1|Subject))
summary(p2_acc_long_lme_lenient)
car::Anova(p2_acc_long_lme_lenient)

p2_acc_rmisc_lenient = Rmisc::summarySE(p2_acc_long_lenient,
                                measurevar = "prop",
                                groupvars = c("Rep"))

p2_acc_rmisc_lenient %>% 
  ggplot(aes(x = Model, y = prop, 
             group = Model, fill = Model)) + 
   geom_bar(stat = "identity", position = "dodge", width = 0.7, color= "black")+
 geom_errorbar(aes(ymin=prop - se, ymax=prop + se), 
             width=.1, color = "gray26", 
             position = position_dodge(0.7))+
 theme_few()+
 scale_fill_solarized()+
       xlab("Semantic Model") + ylab("Average Score (Proportion Out of 60)") + 
  ggtitle("Model Accuracy in Predicting Guesser's First Guesses \n based on Clue Master's First Clue")  +
   theme(axis.ticks.x = element_blank(),
     axis.text.x = element_blank(),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))
p2_acc_rmisc_lenient$Scoring = "Lenient Scoring"
p2_acc_long_lenient$Scoring = "Lenient Scoring"
```

### Moderate

```{r}

c_valid = new_c_z %>% filter(! is.na(Word1Clue1_Undirected))

## proportion of correct predictions 

mean_pred_score = group_by(c_valid, Subject) %>%
  summarise_at(vars(P2_USDN_1.5,
                    P2_DSDN12_1.5,
                    P2_ACN_1.5,
                    # P2Prediction_w2vwiki,
                    # P2Prediction_glove, 
                    # P2Prediction_fasttext,
                    word2vec_num_1.5,
                    fastText_num_1.5,
                    glove_num_1.5), sum)

p2_acc_long_mod =mean_pred_score %>%
 gather(Rep, PredictionScore, P2_ACN_1.5,
                    P2_USDN_1.5,
                    P2_DSDN12_1.5,
        #             P2Prediction_w2vwiki,
        #             P2Prediction_fasttext,
        # P2Prediction_glove,
        word2vec_num_1.5,
                    fastText_num_1.5,
                    glove_num_1.5
)

# 30 word pairs total, times 2 = 60

p2_acc_long_mod$prop = p2_acc_long_mod$PredictionScore/60

p2_acc_long_mod$Rep = ordered(as.factor(as.character(p2_acc_long_mod$Rep)), 
                             levels = c("P2_ACN_1.5", 
                                        "P2_USDN_1.5",
                                        "P2_DSDN12_1.5",
                                        # "P2Prediction_w2vwiki",
                                        # "P2Prediction_fasttext",
                                        # "P2Prediction_glove",
                                        "word2vec_num_1.5",
                    "fastText_num_1.5",
                    "glove_num_1.5"))

p2_acc_long_mod = p2_acc_long_mod %>% 
  mutate(Model = factor(Rep, 
    levels = unique(Rep),
                    labels = c("ACN","Undirected SDN", "Directed SDN",
                                        #  "word2vec_unadjusted",
                                        # "fastText_unadjusted", "GloVe_unadjusted",
                               "word2vec",
                                        "fastText", "GloVe")))

## LME

## only want to examine differences across some models

## remove unadjusted scores

# p2_acc_long_mod = p2_acc_long_mod %>% filter(!Model %in%
#                                                          c( "word2vec_unadjusted",
#                                         "fastText_unadjusted", "GloVe_unadjusted")  )
# 
contrasts(p2_acc_long_mod$Model) = contr.treatment(6, base = 4)

p2_acc_long_lme_mod = lmerTest::lmer(data = p2_acc_long_mod, 
                                 prop ~ Model + (1|Subject))
summary(p2_acc_long_lme_mod)
car::Anova(p2_acc_long_lme_mod)

p2_acc_rmisc_moderate = Rmisc::summarySE(p2_acc_long_mod,
                                measurevar = "prop",
                                groupvars = c("Model"))

p2_acc_rmisc_moderate = p2_acc_rmisc_moderate %>% filter(!Model %in%
                                                         c( "word2vec_unadjusted",
                                        "fastText_unadjusted", "GloVe_unadjusted")  )

p2_acc_rmisc_moderate %>% 
  ggplot(aes(x = Model, y = prop, 
             group = Model, fill = Model)) + 
   geom_bar(stat = "identity", position = "dodge", width = 0.7, color= "black")+
 geom_errorbar(aes(ymin=prop - se, ymax=prop + se), 
             width=.1, color = "gray26", 
             position = position_dodge(0.7))+
 theme_few()+
 scale_fill_solarized()+
       xlab("Semantic Model") + ylab("Average Score (Proportion Out of 60)") + 
  ggtitle("E1: Model Accuracy in Predicting Guesser Responses")  +
   theme(axis.ticks.x = element_blank(),
     axis.text.x = element_blank(),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))
p2_acc_rmisc_moderate$Scoring = "Moderate Scoring"
p2_acc_long_mod$Scoring = "Moderate Scoring"
```

### Plot Together

```{r}
p2_acc_rmisc = rbind(p2_acc_rmisc_strict, p2_acc_rmisc_moderate, p2_acc_rmisc_lenient)

p2_acc_rmisc$Scoring = ordered(as.factor(p2_acc_rmisc$Scoring), 
                               levels = c("Strict Scoring", 
                                          "Moderate Scoring",
                                          "Lenient Scoring"))
p2_acc_rmisc %>% 
  ggplot(aes(x = Model, y = prop, 
             group = Model, fill = Model)) + 
   geom_bar(stat = "identity", position = "dodge", width = 0.7, color= "black")+
 geom_errorbar(aes(ymin=prop - se, ymax=prop + se), 
             width=.1, color = "gray26", 
             position = position_dodge(0.7))+
 theme_few()+
 scale_fill_solarized()+
  facet_wrap(~Scoring)+
       xlab("Semantic Model") + ylab("Average Score (Proportion Out of 60)") + 
  ggtitle("Model Score in Predicting Guesser's First Guesses based on Clue Master's First Clue in Experiment 1")  +
   theme(axis.ticks.x = element_blank(),
     axis.text.x = element_blank(),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))


## LME together

p2_acc_long = rbind(p2_acc_long_strict, p2_acc_long_mod, p2_acc_long_lenient)
p2_acc_long$Scoring = as.factor(p2_acc_long$Scoring)

## LME

contrasts(p2_acc_long$Model) = contr.treatment(6, base = 5)

p2_acc_long_lme = lmerTest::lmer(data = p2_acc_long, 
                                 prop ~ Model*Scoring + (1|Subject))
summary(p2_acc_long_lme)
car::Anova(p2_acc_long_lme)
```

# Player 2 Analysis

### p2 Multiple first attempt 
```{r}

p2_clue_lm_acc = glmer(data = new_c_z, 
                        Player2.ACC ~ ClueAvg_Undirectedz +ClueAvg_Directed12z +
                      ClueAvg_Directed21z + ClueAvg_Kenettz + ClueAvg_w2vwikiz +
                        ClueAvg_fastTextz + ClueAvg_glovez +
                        (1|Subject) + (1|wordpair),
                          family = "binomial",
                          control=glmerControl(optimizer="bobyqa",
          optCtrl=list(maxfun=100000)))
summary(p2_clue_lm_acc)
car::Anova(p2_clue_lm_acc)

CI_p2_acc = as.data.frame(confint(p2_clue_lm_acc))
```

### Multiple Acc Figure

```{r}
predict_data = matrix(NA, nrow = 7, ncol = 4)
colnames(predict_data) = c("Representation" , "beta", "lower", "upper")
predict_data = as.data.frame(predict_data)
predict_data$beta = fixef(p2_clue_lm_acc)[2:8]
predict_data$lower = CI_p2_acc[4:10, 1]
predict_data$upper = CI_p2_acc[4:10, 2]
predict_data$Representation = c("Undirected SDN", "Directed12 SDN", "Directed21", 
                       "ACN", "word2vec", "fastText", "GloVE")


predict_data %>% 
  ggplot(aes(x = Representation , y = beta, 
             group = Representation, fill = Representation)) + 
geom_bar(stat = "identity", position = "dodge", width = 0.7, color= "black")+
 geom_errorbar(aes(ymin=lower, ymax=upper), 
             width=.2, color = "gray26", 
             position = position_dodge(0.7))+ theme_few()+
 scale_fill_solarized()+
 # facet_wrap(~subject)+
    xlab("Semantic Model") + ylab("beta weight") + 
  ggtitle("Multiple Regression Predicting Word Guesser's Accuracy for First Attempt ")  +
   theme(axis.text = element_text(size = rel(1)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))
```

# Efficacy Plots

## W1 Correct

```{r}
# when first attempt was wrong, how close/far was Clue2 to the actual words?


w1correct_clue2_efficacy_w1 = group_by(clue2_data_partcorrect_w1, wordpair) %>%
  summarise_at(vars(Word1Clue2_Undirectedz, Word1Clue2_Directed12z,
                    Word1Clue2_Directed21z, Word1Clue2_Kenettz,
                    Word1Clue2_w2vwikiz, Word1Clue2_fastTextz, Word1Clue2_glovez), mean)

w1correct_clue2_efficacy_w1_long = gather(w1correct_clue2_efficacy_w1, Models, Distance, 
                                Word1Clue2_Undirectedz, Word1Clue2_Directed12z,
                    Word1Clue2_Directed21z, Word1Clue2_Kenettz,
                    Word1Clue2_w2vwikiz, Word1Clue2_fastTextz, Word1Clue2_glovez)

w1correct_clue2_efficacy_w2 = group_by(clue2_data_partcorrect_w1, wordpair) %>%
  summarise_at(vars(Word2Clue2_Undirectedz, Word2Clue2_Directed12z,
                    Word2Clue2_Directed21z, Word2Clue2_Kenettz,
                    Word2Clue2_w2vwikiz, Word2Clue2_fastTextz, Word2Clue2_glovez), mean)

w1correct_clue2_efficacy_w2_long = gather(w1correct_clue2_efficacy_w2, Models, Distance,
                              Word2Clue2_Undirectedz, Word2Clue2_Directed12z,
                    Word2Clue2_Directed21z, Word2Clue2_Kenettz,
                    Word2Clue2_w2vwikiz, Word2Clue2_fastTextz, Word2Clue2_glovez)

t.test(w1correct_clue2_efficacy_w1_long$Distance, 
       w1correct_clue2_efficacy_w2_long$Distance, paired = TRUE)

w1correct_clue2_efficacy_w1dist = Rmisc::summarySE(w1correct_clue2_efficacy_w1_long,
                                                  measurevar = "Distance",
                                                  groupvars = "Models")
w1correct_clue2_efficacy_w1dist$Dtype = "Word1-Clue2"

w1correct_clue2_efficacy_w2dist = Rmisc::summarySE(w1correct_clue2_efficacy_w2_long,
                                                  measurevar = "Distance",
                                                  groupvars = "Models")
w1correct_clue2_efficacy_w2dist$Dtype = "Word2-Clue2"

w1correct_clue2_efficacy = rbind(w1correct_clue2_efficacy_w1dist, 
                                 w1correct_clue2_efficacy_w2dist)
w1correct_clue2_efficacy$Correct = "Word1 Correct"
```


## W2 Correct

```{r}
# when first attempt was wrong, how close/far was Clue2 to the actual words?

w2correct_clue2_efficacy_w1 = group_by(clue2_data_partcorrect_w2, wordpair) %>%
  summarise_at(vars(Word1Clue2_Undirectedz, Word1Clue2_Directed12z,
                    Word1Clue2_Directed21z, Word1Clue2_Kenettz,
                    Word1Clue2_w2vwikiz, Word1Clue2_fastTextz, Word1Clue2_glovez), mean)

w2correct_clue2_efficacy_w1_long = gather(w2correct_clue2_efficacy_w1, Models, Distance, 
                                Word1Clue2_Undirectedz, Word1Clue2_Directed12z,
                    Word1Clue2_Directed21z, Word1Clue2_Kenettz,
                    Word1Clue2_w2vwikiz, Word1Clue2_fastTextz, Word1Clue2_glovez)

w2correct_clue2_efficacy_w2 = group_by(clue2_data_partcorrect_w2, wordpair) %>%
  summarise_at(vars(Word2Clue2_Undirectedz, Word2Clue2_Directed12z,
                    Word2Clue2_Directed21z, Word2Clue2_Kenettz,
                    Word2Clue2_w2vwikiz, Word2Clue2_fastTextz, Word2Clue2_glovez), mean)

w2correct_clue2_efficacy_w2_long = gather(w2correct_clue2_efficacy_w2, Models, Distance,
                              Word2Clue2_Undirectedz, Word2Clue2_Directed12z,
                    Word2Clue2_Directed21z, Word2Clue2_Kenettz,
                    Word2Clue2_w2vwikiz, Word2Clue2_fastTextz, Word2Clue2_glovez)


t.test(w2correct_clue2_efficacy_w1_long$Distance, 
       w2correct_clue2_efficacy_w2_long$Distance, paired = TRUE)

w2correct_clue2_efficacy_w1dist = Rmisc::summarySE(w2correct_clue2_efficacy_w1_long,
                                                  measurevar = "Distance",
                                                  groupvars = "Models")
w2correct_clue2_efficacy_w1dist$Dtype = "Word1-Clue2"

w2correct_clue2_efficacy_w2dist = Rmisc::summarySE(w2correct_clue2_efficacy_w2_long,
                                                  measurevar = "Distance",
                                                  groupvars = "Models")
w2correct_clue2_efficacy_w2dist$Dtype = "Word2-Clue2"

w2correct_clue2_efficacy = rbind(w2correct_clue2_efficacy_w1dist, 
                                 w2correct_clue2_efficacy_w2dist)

w2correct_clue2_efficacy$Correct = "Word2 Correct"

```

## No Correct

```{r}
# when first attempt was wrong, how close/far was Clue2 to the actual words?

nocorrect_clue2_efficacy_w1 = group_by(clue2_data_nocorrect, wordpair) %>%
  summarise_at(vars(Word1Clue2_Undirectedz, Word1Clue2_Directed12z,
                    Word1Clue2_Directed21z, Word1Clue2_Kenettz,
                    Word1Clue2_w2vwikiz, Word1Clue2_fastTextz, Word1Clue2_glovez), mean)

nocorrect_clue2_efficacy_w1_long = gather(nocorrect_clue2_efficacy_w1, Models, Distance, 
                                Word1Clue2_Undirectedz, Word1Clue2_Directed12z,
                    Word1Clue2_Directed21z, Word1Clue2_Kenettz,
                    Word1Clue2_w2vwikiz, Word1Clue2_fastTextz, Word1Clue2_glovez)

nocorrect_clue2_efficacy_w2 = group_by(clue2_data_nocorrect, wordpair) %>%
  summarise_at(vars(Word2Clue2_Undirectedz, Word2Clue2_Directed12z,
                    Word2Clue2_Directed21z, Word2Clue2_Kenettz,
                    Word2Clue2_w2vwikiz, Word2Clue2_fastTextz, Word2Clue2_glovez), mean)

nocorrect_clue2_efficacy_w2_long = gather(nocorrect_clue2_efficacy_w2, Models, Distance,
                              Word2Clue2_Undirectedz, Word2Clue2_Directed12z,
                    Word2Clue2_Directed21z, Word2Clue2_Kenettz,
                    Word2Clue2_w2vwikiz, Word2Clue2_fastTextz, Word2Clue2_glovez)


t.test(nocorrect_clue2_efficacy_w1_long$Distance, 
       nocorrect_clue2_efficacy_w2_long$Distance, paired = TRUE)

nocorrect_clue2_efficacy_w1dist = Rmisc::summarySE(nocorrect_clue2_efficacy_w1_long,
                                                  measurevar = "Distance",
                                                  groupvars = "Models")
nocorrect_clue2_efficacy_w1dist$Dtype = "Word1-Clue2"

nocorrect_clue2_efficacy_w2dist = Rmisc::summarySE(nocorrect_clue2_efficacy_w2_long,
                                                  measurevar = "Distance",
                                                  groupvars = "Models")
nocorrect_clue2_efficacy_w2dist$Dtype = "Word2-Clue2"

nocorrect_clue2_efficacy = rbind(w2correct_clue2_efficacy_w1dist, 
                                 w2correct_clue2_efficacy_w2dist)

nocorrect_clue2_efficacy$Correct = "No Words Correct"

```

## Plot Efficacy

```{r}
clue2_efficacy = rbind(w1correct_clue2_efficacy, w2correct_clue2_efficacy,
                       nocorrect_clue2_efficacy)

clue2_efficacy = clue2_efficacy %>% arrange(Models) %>% 
  filter(!Models %in% c("Word1Clue2_Directed21z", "Word1Clue2_Directed21z",
                        "Word2Clue2_Directed21z", "Word2Clue2_Directed21z") )

clue2_efficacy$Model = c(rep("Directed SDN", 3),rep("fastText", 3),
                          rep("GloVe", 3), rep("ACN", 3), rep("Undirected SDN", 3),
                         rep("word2vec", 3),rep("Directed SDN", 3),rep("fastText", 3),
                          rep("GloVe", 3), rep("ACN", 3), rep("Undirected SDN", 3),
                         rep("word2vec", 3))

clue2_efficacy$Model = ordered(as.factor(clue2_efficacy$Model), 
                               levels = c("ACN", "Undirected SDN", "Directed SDN",
                                          "word2vec", "fastText", "GloVe"))


clue2_efficacy %>% 
  filter(!Correct == "No Words Correct") %>%
  ggplot(aes(x = Dtype, y = Distance, 
             group = Model , fill = Model)) +  
geom_bar(stat = "identity", position = "dodge", width = 0.7, 
           color= "black")+
 geom_errorbar(aes(ymin=Distance - se, ymax=Distance + se), 
             width=.2, color = "gray26", 
             position = position_dodge(0.7))+
 theme_few()+
 scale_fill_solarized()+
  facet_wrap(~Correct)+
       xlab("Semantic Distance") + 
  ylab("Average Standardized Distance") + 
  ggtitle("E1: Efficacy of Clue Master's Second Clue based on First Guess")  +
  theme(axis.text.y = element_text(face = "bold", size = rel(1.2)),
         axis.text.x = element_text(face = "bold", size = rel(1.2)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))
```

# Clues Analysis

## Clue1 Distance from W1 vs W2

```{r}
## is the first clue biased towards w1 or w2?
c = read.csv("e1_ALLpredictions.csv", header = TRUE, sep = ",")

c$wordpair = paste(c$Word2, c$Word1, sep = "-")

clue1_w1w2_dist = group_by(c, wordpair ) %>%
  summarise_at(vars(fastTextW1C1, fastTextW2C1,
                    gloveW1C1, gloveW2C1,
                    word2vecwikiW1C1, word2vecwikiW2C1,
                    Word1Clue1_Undirected, Word2Clue1_Undirected,
                    Word1Clue1_Directed12, Word2Clue1_Directed12,
                    Word1Clue1_Directed21, Word2Clue1_Directed21,
                    Word1Clue1_Kenett, Word2Clue1_Kenett), mean)

t.test(clue1_w1w2_dist$fastTextW1C1, clue1_w1w2_dist$fastTextW2C1, paired = TRUE)
t.test(clue1_w1w2_dist$gloveW1C1, clue1_w1w2_dist$gloveW2C1, paired = TRUE)
t.test(clue1_w1w2_dist$word2vecwikiW1C1, clue1_w1w2_dist$word2vecwikiW2C1, paired = TRUE)
```


## Most Frequent Clue 1
```{r}
clues = read.csv("e1_ALLpredictions.csv", header = TRUE, sep = ",")

clues$wordpair = paste(clues$Word2, clues$Word1, sep = "-")

c_clue_popularity = group_by(clues, Level, wordpair, Clue1 ) %>%
  summarise(Number = n()) %>% arrange(wordpair, desc(Number))

c_clue_popularity = c_clue_popularity[order(c_clue_popularity$wordpair, 
                         c_clue_popularity$Number, decreasing = TRUE),]

c_clue_popularity_1 = c_clue_popularity[1:206,]
c_clue_popularity_1 %>% 
  ggplot(aes(x = wordpair, y = Number)) +
    geom_jitter(aes(color = Clue1, size = Number), 
                width = 0.25, height = 0.5)+
  geom_text(aes(label = Clue1), position=position_jitter(width=0.2,height=0.2))+
 theme_few()+
  guides(color = FALSE, size = FALSE)+
 scale_fill_solarized()+
       xlab("Word Pairs") + ylab("Clue 1 Frequency") + 
  ggtitle("Clue-1 Popularity by Word Pair")  +
   theme(axis.text.x = element_text(size = rel(0.8), face = "bold"),
          axis.title = element_text( size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))

```

### By Level

```{r}
c_clue_popularity_easy = c_clue_popularity %>% filter(Level == "Easy")
c_clue_popularity_medium = c_clue_popularity %>% filter(Level == "Medium")
c_clue_popularity_hard = c_clue_popularity %>% filter(Level == "Hard")
c_clue_popularity_easy_main = c_clue_popularity %>%
  filter(wordpair %in% c("BEAN-TEA", "ALGEBRA-EXAM", "COLLAR-PANTS", 
                         "AIRCRAFT-BIRDS", "ADULTERY-PERJURY"))
c_clue_popularity_easy_main %>% 
  ggplot(aes(x = wordpair, y = Number)) +
  geom_point(shape = 18, aes(size = Number, color = Clue1),
             position=position_jitter(width=0,height=0.7))+
    # geom_jitter(aes(color = "red", size = Number), 
    #             width = 0.25, height = 0.5)+
  geom_text(aes(label = Clue1, fontface = "bold"), position=position_jitter(width=0.25,height=0.5))+
 theme_few()+
  guides(color = FALSE, size = FALSE)+
 scale_fill_solarized()+
       xlab("") + ylab("Clue Frequency") + 
  ggtitle("Frequency of Clues Chosen by Clue Master for Close Word-Pairs")  +
   theme(axis.text.y = element_text(face = "bold", size = rel(1.2)),
         axis.text.x = element_text(face = "bold", size = rel(1.2)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5, size = rel(1.4)),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))

c_clue_popularity_medium_main = c_clue_popularity_medium %>%
  filter(wordpair %in% c("CIGARETTE-ONION", "HEAVY-FEATHER", "CALORIE-FAMINE", 
                         "ALMOND-LUNCH", "ACTRESS-BAD"))

c_clue_popularity_medium_main %>% 
  ggplot(aes(x = wordpair, y = Number)) +
   geom_point(shape = 18, aes(size = Number, color = Clue1),
             position=position_jitter(width=0,height=0.7))+
    # geom_jitter(aes(color = "red", size = Number), 
    #             width = 0.25, height = 0.5)+
  geom_text(aes(label = Clue1, fontface = "bold"), position=position_jitter(width=0.25,height=0.5))+
 theme_few()+
  guides(color = FALSE, size = FALSE)+
 scale_fill_solarized()+
       xlab("") + ylab("Clue Frequency") + 
  ggtitle("Frequency of Clues Chosen by Clue Master for Medium Word-Pairs")  +
   theme(axis.text.y = element_text(face = "bold", size = rel(1.2)),
         axis.text.x = element_text(face = "bold", size = rel(1.2)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5, size = rel(1.4)),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))

c_clue_popularity_hard_main = c_clue_popularity_hard %>%
  filter(wordpair %in% c("ASTRONAUT-NEAR", "ECONOMY-HUNDRED", "ASSIST-DEFINITION", 
                         "COOKING-COMMUNICATE", "DUSK-PENDULUM"))


c_clue_popularity_hard_main %>% 
  ggplot(aes(x = wordpair, y = Number)) +
    geom_point(shape = 18, aes(size = Number, color = Clue1),
             position=position_jitter(width=0,height=0.7))+
    # geom_jitter(aes(color = "red", size = Number), 
    #             width = 0.25, height = 0.5)+
  geom_text(aes(label = Clue1, fontface = "bold"), position=position_jitter(width=0.25,height=0.5))+
 theme_few()+
  guides(color = FALSE, size = FALSE)+
 scale_fill_solarized()+
       xlab("") + ylab("Clue Frequency") + 
  ggtitle("Frequency of Clues Chosen by Clue Master for Distant Word-Pairs")  +
   theme(axis.text.y = element_text(face = "bold", size = rel(1.2)),
         axis.text.x = element_text(face = "bold", size = rel(1.2)),
          axis.title = element_text(face = "bold", size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5, size = rel(1.4)),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))

```


## Most Frequent Clue 2
```{r}

## trying to sample the same word pairs that had clue 1 displayed above

c_clue2_popularity = group_by(clues, Level, wordpair, Clue2 ) %>%
  summarise(Number = n())

c_clue2_popularity = c_clue2_popularity %>% filter(Clue2 != "" )

c_clue2_popularity = c_clue2_popularity[order(c_clue2_popularity$wordpair, 
                         c_clue2_popularity$Number, decreasing = TRUE),]

```

### By Level

```{r}
c_clue2_popularity_easy = c_clue2_popularity %>% filter(Level == "Easy")
c_clue2_popularity_medium = c_clue2_popularity %>% filter(Level == "Medium")
c_clue2_popularity_hard = c_clue2_popularity %>% filter(Level == "Hard")

c_clue2_popularity_easy %>% 
  ggplot(aes(x = wordpair, y = Number)) +
    geom_jitter(aes(color = Clue2, size = Number), 
                width = 0.25, height = 0.5)+
  geom_text(aes(label = Clue2), position=position_jitter(width=0.2,height=0.2))+
 theme_few()+
  guides(color = FALSE, size = FALSE)+
 scale_fill_solarized()+
       xlab("Word Pairs") + ylab("Clue 2 Frequency") + 
  ggtitle("Clue-2 Popularity for Easy Word Pairs")  +
   theme(axis.text.x = element_text(size = rel(0.8), face = "bold"),
          axis.title = element_text( size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))

c_clue2_popularity_medium %>% 
  ggplot(aes(x = wordpair, y = Number)) +
    geom_jitter(aes(color = Clue2, size = Number), 
                width = 0.25, height = 0.5)+
  geom_text(aes(label = Clue2), position=position_jitter(width=0.2,height=0.2))+
 theme_few()+
  guides(color = FALSE, size = FALSE)+
 scale_fill_solarized()+
       xlab("Word Pairs") + ylab("Clue 2 Frequency") + 
  ggtitle("Clue-2 Popularity for Medium Word Pairs")  +
   theme(axis.text.x = element_text(size = rel(0.8), face = "bold"),
          axis.title = element_text( size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))

c_clue2_popularity_hard %>% 
  ggplot(aes(x = wordpair, y = Number)) +
    geom_jitter(aes(color = Clue2, size = Number), 
                width = 0.25, height = 0.5)+
  geom_text(aes(label = Clue2), position=position_jitter(width=0.2,height=0.2))+
 theme_few()+
  guides(color = FALSE, size = FALSE)+
 scale_fill_solarized()+
       xlab("Word Pairs") + ylab("Clue 2 Frequency") + 
  ggtitle("Clue-2 Popularity for Hard Word Pairs")  +
   theme(axis.text.x = element_text(size = rel(0.8), face = "bold"),
          axis.title = element_text( size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))


```

## Most Frequent Clue 3
```{r}

## trying to sample the same word pairs that had clue 1 displayed above

c_clue3_popularity = group_by(clues, Level, wordpair, Clue3 ) %>%
  summarise(Number = n())

c_clue3_popularity = c_clue3_popularity %>% filter(Clue3 != "" )

c_clue3_popularity = c_clue3_popularity[order(c_clue3_popularity$wordpair, 
                         c_clue3_popularity$Number, decreasing = TRUE),]
```

### By Level

```{r}
c_clue3_popularity_easy = c_clue3_popularity %>% filter(Level == "Easy")
c_clue3_popularity_medium = c_clue3_popularity %>% filter(Level == "Medium")
c_clue3_popularity_hard = c_clue3_popularity %>% filter(Level == "Hard")

c_clue3_popularity_easy %>% 
  ggplot(aes(x = wordpair, y = Number)) +
    geom_jitter(aes(color = Clue3, size = Number), 
                width = 0.25, height = 0.5)+
  geom_text(aes(label = Clue3), position=position_jitter(width=0.2,height=0.2))+
 theme_few()+
  guides(color = FALSE, size = FALSE)+
 scale_fill_solarized()+
       xlab("Word Pairs") + ylab("Clue 3 Frequency") + 
  ggtitle("Clue-3 Popularity for Easy Word Pairs")  +
   theme(axis.text.x = element_text(size = rel(0.8), face = "bold"),
          axis.title = element_text( size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))

c_clue3_popularity_medium %>% 
  ggplot(aes(x = wordpair, y = Number)) +
    geom_jitter(aes(color = Clue3, size = Number), 
                width = 0.25, height = 0.5)+
  geom_text(aes(label = Clue3), position=position_jitter(width=0.2,height=0.2))+
 theme_few()+
  guides(color = FALSE, size = FALSE)+
 scale_fill_solarized()+
       xlab("Word Pairs") + ylab("Clue 3 Frequency") + 
  ggtitle("Clue-3 Popularity for Medium Word Pairs")  +
   theme(axis.text.x = element_text(size = rel(0.8), face = "bold"),
          axis.title = element_text( size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))

c_clue3_popularity_hard %>% 
  ggplot(aes(x = wordpair, y = Number)) +
    geom_jitter(aes(color = Clue3, size = Number), 
                width = 0.25, height = 0.5)+
  geom_text(aes(label = Clue3), position=position_jitter(width=0.2,height=0.2))+
 theme_few()+
  guides(color = FALSE, size = FALSE)+
 scale_fill_solarized()+
       xlab("Word Pairs") + ylab("Clue 3 Frequency") + 
  ggtitle("Clue-3 Popularity for Hard Word Pairs")  +
   theme(axis.text.x = element_text(size = rel(0.8), face = "bold"),
          axis.title = element_text( size = rel(1)),
          legend.title = element_text(face = "bold", size = rel(1)),
         plot.title = element_text(hjust = .5),
         strip.text.x = element_text(face = "bold", size = rel(1.4)))


```















